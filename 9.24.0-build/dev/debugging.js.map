{"version":3,"file":"debugging.js","mappings":"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","sources":["webpack://prebid.js/./modules/debugging/bidInterceptor.js","webpack://prebid.js/./modules/debugging/debugging.js","webpack://prebid.js/./modules/debugging/index.js","webpack://prebid.js/./modules/debugging/legacy.js","webpack://prebid.js/./modules/debugging/pbsInterceptor.js"],"sourcesContent":["import {\n  deepAccess,\n  deepClone,\n  delayExecution,\n  mergeDeep,\n  hasNonSerializableProperty\n} from '../../src/utils.js';\n\n/**\n * @typedef {Number|String|boolean|null|undefined} Scalar\n */\n\nexport function BidInterceptor(opts = {}) {\n  ({setTimeout: this.setTimeout = window.setTimeout.bind(window)} = opts);\n  this.logger = opts.logger;\n  this.rules = [];\n}\n\nObject.assign(BidInterceptor.prototype, {\n  DEFAULT_RULE_OPTIONS: {\n    delay: 0\n  },\n  serializeConfig(ruleDefs) {\n    const isSerializable = (ruleDef, i) => {\n      const serializable = !hasNonSerializableProperty(ruleDef);\n      if (!serializable && !deepAccess(ruleDef, 'options.suppressWarnings')) {\n        this.logger.logWarn(`Bid interceptor rule definition #${i + 1} contains non-serializable properties and will be lost after a refresh. Rule definition: `, ruleDef);\n      }\n      return serializable;\n    }\n    return ruleDefs.filter(isSerializable);\n  },\n  updateConfig(config) {\n    this.rules = (config.intercept || []).map((ruleDef, i) => this.rule(ruleDef, i + 1))\n  },\n  /**\n   * @typedef {Object} RuleOptions\n   * @property {Number} [delay=0] delay between bid interception and mocking of response (to simulate network delay)\n   * @property {boolean} [suppressWarnings=false] if enabled, do not warn about unserializable rules\n   *\n   * @typedef {Object} Rule\n   * @property {Number} no rule number (used only as an identifier for logging)\n   * @property {function({}, {}): boolean} match a predicate function that tests a bid against this rule\n   * @property {ReplacerFn} replacer generator function for mock bid responses\n   * @property {RuleOptions} options\n   */\n\n  /**\n   * @param {{}} ruleDef\n   * @param {Number} ruleNo\n   * @returns {Rule}\n   */\n  rule(ruleDef, ruleNo) {\n    return {\n      no: ruleNo,\n      match: this.matcher(ruleDef.when, ruleNo),\n      replace: this.replacer(ruleDef.then, ruleNo),\n      options: Object.assign({}, this.DEFAULT_RULE_OPTIONS, ruleDef.options),\n      paapi: this.paapiReplacer(ruleDef.paapi || [], ruleNo)\n    }\n  },\n  /**\n   * @typedef {Function} MatchPredicate\n   * @param {*} candidate a bid to match, or a portion of it if used inside an ObjectMather.\n   * e.g. matcher((bid, bidRequest) => ....) or matcher({property: (property, bidRequest) => ...})\n   * @param {BidRequest} bidRequest the request `candidate` belongs to\n   * @returns {boolean}\n   *\n   * @typedef {{[key]: Scalar|RegExp|MatchPredicate|ObjectMatcher}} ObjectMatcher\n   */\n\n  /**\n   * @param {MatchPredicate|ObjectMatcher} matchDef matcher definition\n   * @param {Number} ruleNo\n   * @returns {MatchPredicate} a predicate function that matches a bid against the given `matchDef`\n   */\n  matcher(matchDef, ruleNo) {\n    if (typeof matchDef === 'function') {\n      return matchDef;\n    }\n    if (typeof matchDef !== 'object') {\n      this.logger.logError(`Invalid 'when' definition for debug bid interceptor (in rule #${ruleNo})`);\n      return () => false;\n    }\n    function matches(candidate, {ref = matchDef, args = []}) {\n      return Object.entries(ref).map(([key, val]) => {\n        const cVal = candidate[key];\n        if (val instanceof RegExp) {\n          return val.exec(cVal) != null;\n        }\n        if (typeof val === 'function') {\n          return !!val(cVal, ...args);\n        }\n        if (typeof val === 'object') {\n          return matches(cVal, {ref: val, args});\n        }\n        return cVal === val;\n      }).every((i) => i);\n    }\n    return (candidate, ...args) => matches(candidate, {args});\n  },\n  /**\n   * @typedef {Function} ReplacerFn\n   * @param {*} bid a bid that was intercepted\n   * @param {BidRequest} bidRequest the request `bid` belongs to\n   * @returns {*} the response to mock for `bid`, or a portion of it if used inside an ObjectReplacer.\n   * e.g. replacer((bid, bidRequest) => mockResponse) or replacer({property: (bid, bidRequest) => mockProperty})\n   *\n   * @typedef {{[key]: ReplacerFn|ObjectReplacer|*}} ObjectReplacer\n   */\n\n  /**\n   * @param {ReplacerFn|ObjectReplacer} replDef replacer definition\n   * @param ruleNo\n   * @return {ReplacerFn}\n   */\n  replacer(replDef, ruleNo) {\n    if (replDef === null) {\n      return () => null\n    }\n    replDef = replDef || {};\n    let replFn;\n    if (typeof replDef === 'function') {\n      replFn = ({args}) => replDef(...args);\n    } else if (typeof replDef !== 'object') {\n      this.logger.logError(`Invalid 'then' definition for debug bid interceptor (in rule #${ruleNo})`);\n      replFn = () => ({});\n    } else {\n      replFn = ({args, ref = replDef}) => {\n        const result = Array.isArray(ref) ? [] : {};\n        Object.entries(ref).forEach(([key, val]) => {\n          if (typeof val === 'function') {\n            result[key] = val(...args);\n          } else if (val != null && typeof val === 'object') {\n            result[key] = replFn({args, ref: val})\n          } else {\n            result[key] = val;\n          }\n        });\n        return result;\n      }\n    }\n    return (bid, ...args) => {\n      const response = this.responseDefaults(bid);\n      mergeDeep(response, replFn({args: [bid, ...args]}));\n      if (!response.hasOwnProperty('ad') && !response.hasOwnProperty('adUrl')) {\n        response.ad = this.defaultAd(bid, response);\n      }\n      response.isDebug = true;\n      return response;\n    }\n  },\n\n  paapiReplacer(paapiDef, ruleNo) {\n    function wrap(configs = []) {\n      return configs.map(config => {\n        return Object.keys(config).some(k => !['config', 'igb'].includes(k))\n          ? {config}\n          : config\n      });\n    }\n    if (Array.isArray(paapiDef)) {\n      return () => wrap(paapiDef);\n    } else if (typeof paapiDef === 'function') {\n      return (...args) => wrap(paapiDef(...args))\n    } else {\n      this.logger.logError(`Invalid 'paapi' definition for debug bid interceptor (in rule #${ruleNo})`);\n    }\n  },\n\n  responseDefaults(bid) {\n    return {\n      requestId: bid.bidId,\n      cpm: 3.5764,\n      currency: 'EUR',\n      width: 300,\n      height: 250,\n      ttl: 360,\n      creativeId: 'mock-creative-id',\n      netRevenue: false,\n      meta: {}\n    };\n  },\n  defaultAd(bid, bidResponse) {\n    return `<html><head><style>#ad {width: ${bidResponse.width}px;height: ${bidResponse.height}px;background-color: #f6f6ae;color: #85144b;padding: 5px;text-align: center;display: flex;flex-direction: column;align-items: center;justify-content: center;}#bidder {font-family: monospace;font-weight: normal;}#title {font-size: x-large;font-weight: bold;margin-bottom: 5px;}#body {font-size: large;margin-top: 5px;}</style></head><body><div id=\"ad\"><div id=\"title\">Mock ad: <span id=\"bidder\">${bid.bidder}</span></div><div id=\"body\">${bidResponse.width}x${bidResponse.height}</div></div></body></html>`;\n  },\n  /**\n   * Match a candidate bid against all registered rules.\n   *\n   * @param {{}} candidate\n   * @param args\n   * @returns {Rule|undefined} the first matching rule, or undefined if no match was found.\n   */\n  match(candidate, ...args) {\n    return this.rules.find((rule) => rule.match(candidate, ...args));\n  },\n  /**\n   * Match a set of bids against all registered rules.\n   *\n   * @param bids\n   * @param bidRequest\n   * @returns {[{bid: *, rule: Rule}[], *[]]} a 2-tuple for matching bids (decorated with the matching rule) and\n   * non-matching bids.\n   */\n  matchAll(bids, bidRequest) {\n    const [matches, remainder] = [[], []];\n    bids.forEach((bid) => {\n      const rule = this.match(bid, bidRequest);\n      if (rule != null) {\n        matches.push({rule: rule, bid: bid});\n      } else {\n        remainder.push(bid);\n      }\n    })\n    return [matches, remainder];\n  },\n  /**\n   * Run a set of bids against all registered rules, filter out those that match,\n   * and generate mock responses for them.\n   *\n   * @param {{}[]} bids?\n   * @param {BidRequest} bidRequest\n   * @param {function(*)} addBid called once for each mock response\n   * @param addPaapiConfig called once for each mock PAAPI config\n   * @param {function()} done called once after all mock responses have been run through `addBid`\n   * @returns {{bids: {}[], bidRequest: {}} remaining bids that did not match any rule (this applies also to\n   * bidRequest.bids)\n   */\n  intercept({bids, bidRequest, addBid, addPaapiConfig, done}) {\n    if (bids == null) {\n      bids = bidRequest.bids;\n    }\n    const [matches, remainder] = this.matchAll(bids, bidRequest);\n    if (matches.length > 0) {\n      const callDone = delayExecution(done, matches.length);\n      matches.forEach((match) => {\n        const mockResponse = match.rule.replace(match.bid, bidRequest);\n        const mockPaapi = match.rule.paapi(match.bid, bidRequest);\n        const delay = match.rule.options.delay;\n        this.logger.logMessage(`Intercepted bid request (matching rule #${match.rule.no}), mocking response in ${delay}ms. Request, response, PAAPI configs:`, match.bid, mockResponse, mockPaapi)\n        this.setTimeout(() => {\n          mockResponse && addBid(mockResponse, match.bid);\n          mockPaapi.forEach(cfg => addPaapiConfig(cfg, match.bid, bidRequest));\n          callDone();\n        }, delay)\n      });\n      bidRequest = deepClone(bidRequest);\n      bids = bidRequest.bids = remainder;\n    } else {\n      this.setTimeout(done, 0);\n    }\n    return {bids, bidRequest};\n  }\n});\n","import {deepClone, delayExecution} from '../../src/utils.js';\nimport {BidInterceptor} from './bidInterceptor.js';\nimport {makePbsInterceptor} from './pbsInterceptor.js';\nimport {addHooks, removeHooks} from './legacy.js';\n\nconst interceptorHooks = [];\nlet bidInterceptor;\nlet enabled = false;\n\nfunction enableDebugging(debugConfig, {fromSession = false, config, hook, logger}) {\n  config.setConfig({debug: true});\n  bidInterceptor.updateConfig(debugConfig);\n  resetHooks(true);\n  // also enable \"legacy\" overrides\n  removeHooks({hook});\n  addHooks(debugConfig, {hook, logger});\n  if (!enabled) {\n    enabled = true;\n    logger.logMessage(`Debug overrides enabled${fromSession ? ' from session' : ''}`);\n  }\n}\n\nexport function disableDebugging({hook, logger}) {\n  bidInterceptor.updateConfig(({}));\n  resetHooks(false);\n  // also disable \"legacy\" overrides\n  removeHooks({hook});\n  if (enabled) {\n    enabled = false;\n    logger.logMessage('Debug overrides disabled');\n  }\n}\n\n// eslint-disable-next-line prebid/no-global\nfunction saveDebuggingConfig(debugConfig, {sessionStorage = window.sessionStorage, DEBUG_KEY} = {}) {\n  if (!debugConfig.enabled) {\n    try {\n      sessionStorage.removeItem(DEBUG_KEY);\n    } catch (e) {\n    }\n  } else {\n    if (debugConfig.intercept) {\n      debugConfig = deepClone(debugConfig);\n      debugConfig.intercept = bidInterceptor.serializeConfig(debugConfig.intercept);\n    }\n    try {\n      sessionStorage.setItem(DEBUG_KEY, JSON.stringify(debugConfig));\n    } catch (e) {\n    }\n  }\n}\n\n// eslint-disable-next-line prebid/no-global\nexport function getConfig(debugging, {getStorage = () => window.sessionStorage, DEBUG_KEY, config, hook, logger} = {}) {\n  if (debugging == null) return;\n  let sessionStorage;\n  try {\n    sessionStorage = getStorage();\n  } catch (e) {\n    logger.logError(`sessionStorage is not available: debugging configuration will not persist on page reload`, e);\n  }\n  if (sessionStorage != null) {\n    saveDebuggingConfig(debugging, {sessionStorage, DEBUG_KEY});\n  }\n  if (!debugging.enabled) {\n    disableDebugging({hook, logger});\n  } else {\n    enableDebugging(debugging, {config, hook, logger});\n  }\n}\n\nexport function sessionLoader({DEBUG_KEY, storage, config, hook, logger}) {\n  let overrides;\n  try {\n    // eslint-disable-next-line prebid/no-global\n    storage = storage || window.sessionStorage;\n    overrides = JSON.parse(storage.getItem(DEBUG_KEY));\n  } catch (e) {\n  }\n  if (overrides) {\n    enableDebugging(overrides, {fromSession: true, config, hook, logger});\n  }\n}\n\nfunction resetHooks(enable) {\n  interceptorHooks.forEach(([getHookFn, interceptor]) => {\n    getHookFn().getHooks({hook: interceptor}).remove();\n  });\n  if (enable) {\n    interceptorHooks.forEach(([getHookFn, interceptor]) => {\n      getHookFn().before(interceptor);\n    });\n  }\n}\n\nfunction registerBidInterceptor(getHookFn, interceptor) {\n  const interceptBids = (...args) => bidInterceptor.intercept(...args);\n  interceptorHooks.push([getHookFn, function (next, ...args) {\n    interceptor(next, interceptBids, ...args);\n  }]);\n}\n\nexport function bidderBidInterceptor(next, interceptBids, spec, bids, bidRequest, ajax, wrapCallback, cbs) {\n  const done = delayExecution(cbs.onCompletion, 2);\n  ({bids, bidRequest} = interceptBids({\n    bids,\n    bidRequest,\n    addBid: wrapCallback(cbs.onBid),\n    addPaapiConfig: wrapCallback((config, bidRequest) => cbs.onPaapi({bidId: bidRequest.bidId, ...config})),\n    done\n  }));\n  if (bids.length === 0) {\n    // eslint-disable-next-line no-unused-expressions\n    cbs.onResponse?.({}); // trigger onResponse so that the bidder may be marked as \"timely\" if necessary\n    done();\n  } else {\n    next(spec, bids, bidRequest, ajax, wrapCallback, {...cbs, onCompletion: done});\n  }\n}\n\nexport function install({DEBUG_KEY, config, hook, createBid, logger}) {\n  bidInterceptor = new BidInterceptor({logger});\n  const pbsBidInterceptor = makePbsInterceptor({createBid});\n  registerBidInterceptor(() => hook.get('processBidderRequests'), bidderBidInterceptor);\n  registerBidInterceptor(() => hook.get('processPBSRequest'), pbsBidInterceptor);\n  sessionLoader({DEBUG_KEY, config, hook, logger});\n  config.getConfig('debugging', ({debugging}) => getConfig(debugging, {DEBUG_KEY, config, hook, logger}), {init: true});\n}\n","import {config} from '../../src/config.js';\nimport {hook} from '../../src/hook.js';\nimport {install} from './debugging.js';\nimport {prefixLog} from '../../src/utils.js';\nimport {createBid} from '../../src/bidfactory.js';\nimport {DEBUG_KEY} from '../../src/debugging.js';\n\ninstall({DEBUG_KEY, config, hook, createBid, logger: prefixLog('DEBUG:')});\n","export let addBidResponseBound;\nexport let addBidderRequestsBound;\n\nexport function addHooks(overrides, {hook, logger}) {\n  addBidResponseBound = addBidResponseHook.bind({overrides, logger});\n  hook.get('addBidResponse').before(addBidResponseBound, 5);\n\n  addBidderRequestsBound = addBidderRequestsHook.bind({overrides, logger});\n  hook.get('addBidderRequests').before(addBidderRequestsBound, 5);\n}\n\nexport function removeHooks({hook}) {\n  hook.get('addBidResponse').getHooks({hook: addBidResponseBound}).remove();\n  hook.get('addBidderRequests').getHooks({hook: addBidderRequestsBound}).remove();\n}\n\n/**\n * @param {{bidder:string, adUnitCode:string}} overrideObj\n * @param {string} bidderCode\n * @param {string} adUnitCode\n * @returns {boolean}\n */\nexport function bidExcluded(overrideObj, bidderCode, adUnitCode) {\n  if (overrideObj.bidder && overrideObj.bidder !== bidderCode) {\n    return true;\n  }\n  if (overrideObj.adUnitCode && overrideObj.adUnitCode !== adUnitCode) {\n    return true;\n  }\n  return false;\n}\n\n/**\n * @param {string[]} bidders\n * @param {string} bidderCode\n * @returns {boolean}\n */\nexport function bidderExcluded(bidders, bidderCode) {\n  return (Array.isArray(bidders) && bidders.indexOf(bidderCode) === -1);\n}\n\n/**\n * @param {Object} overrideObj\n * @param {Object} bidObj\n * @param {Object} bidType\n * @returns {Object} bidObj with overridden properties\n */\nexport function applyBidOverrides(overrideObj, bidObj, bidType, logger) {\n  return Object.keys(overrideObj).filter(key => (['adUnitCode', 'bidder'].indexOf(key) === -1)).reduce(function(result, key) {\n    logger.logMessage(`bidder overrides changed '${result.adUnitCode}/${result.bidderCode}' ${bidType}.${key} from '${result[key]}.js' to '${overrideObj[key]}'`);\n    result[key] = overrideObj[key];\n    result.isDebug = true;\n    return result;\n  }, bidObj);\n}\n\nexport function addBidResponseHook(next, adUnitCode, bid, reject) {\n  const {overrides, logger} = this;\n\n  if (bidderExcluded(overrides.bidders, bid.bidderCode)) {\n    logger.logWarn(`bidder '${bid.bidderCode}' excluded from auction by bidder overrides`);\n    return;\n  }\n\n  if (Array.isArray(overrides.bids)) {\n    overrides.bids.forEach(function(overrideBid) {\n      if (!bidExcluded(overrideBid, bid.bidderCode, adUnitCode)) {\n        applyBidOverrides(overrideBid, bid, 'bidder', logger);\n      }\n    });\n  }\n\n  next(adUnitCode, bid, reject);\n}\n\nexport function addBidderRequestsHook(next, bidderRequests) {\n  const {overrides, logger} = this;\n\n  const includedBidderRequests = bidderRequests.filter(function (bidderRequest) {\n    if (bidderExcluded(overrides.bidders, bidderRequest.bidderCode)) {\n      logger.logWarn(`bidRequest '${bidderRequest.bidderCode}' excluded from auction by bidder overrides`);\n      return false;\n    }\n    return true;\n  });\n\n  if (Array.isArray(overrides.bidRequests)) {\n    includedBidderRequests.forEach(function(bidderRequest) {\n      overrides.bidRequests.forEach(function(overrideBid) {\n        bidderRequest.bids.forEach(function(bid) {\n          if (!bidExcluded(overrideBid, bidderRequest.bidderCode, bid.adUnitCode)) {\n            applyBidOverrides(overrideBid, bid, 'bidRequest', logger);\n          }\n        });\n      });\n    });\n  }\n\n  next(includedBidderRequests);\n}\n","import {deepClone, delayExecution} from '../../src/utils.js';\nimport { STATUS } from '../../src/constants.js';\n\nexport function makePbsInterceptor({createBid}) {\n  return function pbsBidInterceptor(next, interceptBids, s2sBidRequest, bidRequests, ajax, {\n    onResponse,\n    onError,\n    onBid,\n    onFledge,\n  }) {\n    let responseArgs;\n    const done = delayExecution(() => onResponse(...responseArgs), bidRequests.length + 1)\n    function signalResponse(...args) {\n      responseArgs = args;\n      done();\n    }\n    function addBid(bid, bidRequest) {\n      onBid({\n        adUnit: bidRequest.adUnitCode,\n        bid: Object.assign(createBid(STATUS.GOOD, bidRequest), bid)\n      })\n    }\n    bidRequests = bidRequests\n      .map((req) => interceptBids({\n        bidRequest: req,\n        addBid,\n        addPaapiConfig(config, bidRequest, bidderRequest) {\n          onFledge({\n            adUnitCode: bidRequest.adUnitCode,\n            ortb2: bidderRequest.ortb2,\n            ortb2Imp: bidRequest.ortb2Imp,\n            ...config\n          })\n        },\n        done\n      }).bidRequest)\n      .filter((req) => req.bids.length > 0)\n\n    if (bidRequests.length > 0) {\n      const bidIds = new Set();\n      bidRequests.forEach((req) => req.bids.forEach((bid) => bidIds.add(bid.bidId)));\n      s2sBidRequest = deepClone(s2sBidRequest);\n      s2sBidRequest.ad_units.forEach((unit) => {\n        unit.bids = unit.bids.filter((bid) => bidIds.has(bid.bid_id));\n      })\n      s2sBidRequest.ad_units = s2sBidRequest.ad_units.filter((unit) => unit.bids.length > 0);\n      next(s2sBidRequest, bidRequests, ajax, {onResponse: signalResponse, onError, onBid});\n    } else {\n      signalResponse(true, []);\n    }\n  }\n}\n"],"names":["deepAccess","deepClone","delayExecution","mergeDeep","hasNonSerializableProperty","BidInterceptor","opts","arguments","length","undefined","setTimeout","window","bind","logger","rules","Object","assign","prototype","DEFAULT_RULE_OPTIONS","delay","serializeConfig","ruleDefs","isSerializable","ruleDef","i","serializable","logWarn","filter","updateConfig","config","intercept","map","rule","ruleNo","no","match","matcher","when","replace","replacer","then","options","paapi","paapiReplacer","matchDef","logError","matches","candidate","_ref","ref","args","entries","_ref2","key","val","cVal","RegExp","exec","every","_len","Array","_key","replDef","_this","replFn","_ref3","_ref4","result","isArray","forEach","_ref5","bid","response","responseDefaults","_len2","_key2","hasOwnProperty","ad","defaultAd","isDebug","paapiDef","wrap","configs","keys","some","k","includes","requestId","bidId","cpm","currency","width","height","ttl","creativeId","netRevenue","meta","bidResponse","bidder","_len3","_key3","find","matchAll","bids","bidRequest","remainder","push","_ref6","addBid","addPaapiConfig","done","callDone","mockResponse","mockPaapi","logMessage","cfg","makePbsInterceptor","addHooks","removeHooks","interceptorHooks","bidInterceptor","enabled","enableDebugging","debugConfig","fromSession","hook","setConfig","debug","resetHooks","disableDebugging","saveDebuggingConfig","sessionStorage","DEBUG_KEY","removeItem","e","setItem","JSON","stringify","getConfig","debugging","getStorage","sessionLoader","storage","overrides","parse","getItem","enable","getHookFn","interceptor","getHooks","remove","before","registerBidInterceptor","interceptBids","next","bidderBidInterceptor","spec","ajax","wrapCallback","cbs","onCompletion","onBid","onPaapi","onResponse","install","createBid","pbsBidInterceptor","get","_ref7","init","registerModule","__r0","prefixLog","addBidResponseBound","addBidderRequestsBound","addBidResponseHook","addBidderRequestsHook","bidExcluded","overrideObj","bidderCode","adUnitCode","bidderExcluded","bidders","indexOf","applyBidOverrides","bidObj","bidType","reduce","reject","overrideBid","bidderRequests","includedBidderRequests","bidderRequest","bidRequests","STATUS","s2sBidRequest","onError","onFledge","responseArgs","signalResponse","adUnit","GOOD","req","ortb2","ortb2Imp","bidIds","Set","add","ad_units","unit","has","bid_id"],"sourceRoot":""}