{"version":3,"file":"chunk-core.js","mappings":"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;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM6d,wBAAwB,GAAG,CAAC,KAAK,EAAE,KAAK,EAAE,YAAY,EAAE,YAAY,EAAE,UAAU,CAAC;AACvF,MAAMC,IAAI,GAAG,CAAC,WAAW,EAAE,eAAe,CAAC;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,cAAcA,CAAC9C,IAAI,EAAE;EACnC,MAAMhc,UAAU,GAAGmF,KAAK,CAACoN,OAAO,CAACyJ,IAAI,CAACd,mBAAmB,CAAC,GACtD;IAAEA,mBAAmB,EAAEc,IAAI,CAACd;EAAoB,CAAC,GACjDhX,SAAS;EACb,SAAS6a,SAASA,CAAC/C,IAAI,EAAE;IACvB,MAAM1Q,MAAM,GAAG0H,SAAS,CAACgJ,IAAI,CAAC;IAC9Bjb,0DAAc,CAACqa,kBAAkB,CAAC9P,MAAM,EAAE0Q,IAAI,CAACpc,IAAI,EAAEI,UAAU,CAAC;EAClE;EAEA+e,SAAS,CAAC/C,IAAI,CAAC;EACf,IAAI7W,KAAK,CAACoN,OAAO,CAACyJ,IAAI,CAACgD,OAAO,CAAC,EAAE;IAC/BhD,IAAI,CAACgD,OAAO,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","sources":["webpack://prebid.js/./src/Renderer.js","webpack://prebid.js/./src/activities/activities.js","webpack://prebid.js/./src/activities/activityParams.js","webpack://prebid.js/./src/activities/modules.js","webpack://prebid.js/./src/activities/params.js","webpack://prebid.js/./src/activities/redactor.js","webpack://prebid.js/./src/activities/rules.js","webpack://prebid.js/./src/adRendering.js","webpack://prebid.js/./src/adUnits.js","webpack://prebid.js/./src/adapter.js","webpack://prebid.js/./src/adapterManager.js","webpack://prebid.js/./src/adapters/bidderFactory.js","webpack://prebid.js/./src/adloader.js","webpack://prebid.js/./src/ajax.js","webpack://prebid.js/./src/auction.js","webpack://prebid.js/./src/auctionIndex.js","webpack://prebid.js/./src/auctionManager.js","webpack://prebid.js/./src/banner.js","webpack://prebid.js/./src/bidTTL.js","webpack://prebid.js/./src/bidderSettings.js","webpack://prebid.js/./src/bidfactory.js","webpack://prebid.js/./src/config.js","webpack://prebid.js/./src/consentHandler.js","webpack://prebid.js/./src/constants.js","webpack://prebid.js/./src/cpmBucketManager.js","webpack://prebid.js/./src/creativeRenderers.js","webpack://prebid.js/./src/debugging.js","webpack://prebid.js/./src/events.js","webpack://prebid.js/./src/fpd/enrichment.js","webpack://prebid.js/./src/fpd/oneClient.js","webpack://prebid.js/./src/fpd/rootDomain.js","webpack://prebid.js/./src/fpd/sua.js","webpack://prebid.js/./src/hook.js","webpack://prebid.js/./src/mediaTypes.js","webpack://prebid.js/./src/native.js","webpack://prebid.js/./src/pbjsORTB.js","webpack://prebid.js/./src/polyfill.js","webpack://prebid.js/./src/prebid.js","webpack://prebid.js/./src/prebidGlobal.js","webpack://prebid.js/./src/refererDetection.js","webpack://prebid.js/./src/secureCreatives.js","webpack://prebid.js/./src/storageManager.js","webpack://prebid.js/./src/targeting.js","webpack://prebid.js/./src/userSync.js","webpack://prebid.js/./src/utils.js","webpack://prebid.js/./src/utils/cpm.js","webpack://prebid.js/./src/utils/focusTimeout.js","webpack://prebid.js/./src/utils/ipUtils.js","webpack://prebid.js/./src/utils/perfMetrics.js","webpack://prebid.js/./src/utils/promise.js","webpack://prebid.js/./src/utils/reducers.js","webpack://prebid.js/./src/utils/ttlCollection.js","webpack://prebid.js/./src/video.js","webpack://prebid.js/./src/videoCache.js"],"sourcesContent":["import { loadExternalScript } from './adloader.js';\nimport {\n  logError, logWarn, logMessage\n} from './utils.js';\nimport {find} from './polyfill.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport { MODULE_TYPE_PREBID } from './activities/modules.js';\n\nconst pbjsInstance = getGlobal();\nconst moduleCode = 'outstream';\n\n/**\n * @typedef {object} Renderer\n *\n * A Renderer stores some functions which are used to render a particular Bid.\n * These are used in Outstream Video Bids, returned on the Bid by the adapter, and will\n * be used to render that bid unless the Publisher overrides them.\n */\n\nexport function Renderer(options) {\n  const { url, config, id, callback, loaded, adUnitCode, renderNow } = options;\n  this.url = url;\n  this.config = config;\n  this.handlers = {};\n  this.id = id;\n  this.renderNow = renderNow;\n\n  // a renderer may push to the command queue to delay rendering until the\n  // render function is loaded by loadExternalScript, at which point the the command\n  // queue will be processed\n  this.loaded = loaded;\n  this.cmd = [];\n  this.push = func => {\n    if (typeof func !== 'function') {\n      logError('Commands given to Renderer.push must be wrapped in a function');\n      return;\n    }\n    this.loaded ? func.call() : this.cmd.push(func);\n  };\n\n  // bidders may override this with the `callback` property given to `install`\n  this.callback = callback || (() => {\n    this.loaded = true;\n    this.process();\n  });\n\n  // use a function, not an arrow, in order to be able to pass \"arguments\" through\n  this.render = function () {\n    const renderArgs = arguments\n    const runRender = () => {\n      if (this._render) {\n        this._render.apply(this, renderArgs)\n      } else {\n        logWarn(`No render function was provided, please use .setRender on the renderer`);\n      }\n    }\n\n    if (isRendererPreferredFromAdUnit(adUnitCode)) {\n      logWarn(`External Js not loaded by Renderer since renderer url and callback is already defined on adUnit ${adUnitCode}`);\n      runRender();\n    } else if (renderNow) {\n      runRender();\n    } else {\n      // we expect to load a renderer url once only so cache the request to load script\n      this.cmd.unshift(runRender) // should render run first ?\n      loadExternalScript(url, MODULE_TYPE_PREBID, moduleCode, this.callback, this.documentContext);\n    }\n  }.bind(this); // bind the function to this object to avoid 'this' errors\n}\n\nRenderer.install = function({ url, config, id, callback, loaded, adUnitCode, renderNow }) {\n  return new Renderer({ url, config, id, callback, loaded, adUnitCode, renderNow });\n};\n\nRenderer.prototype.getConfig = function() {\n  return this.config;\n};\n\nRenderer.prototype.setRender = function(fn) {\n  this._render = fn;\n};\n\nRenderer.prototype.setEventHandlers = function(handlers) {\n  this.handlers = handlers;\n};\n\nRenderer.prototype.handleVideoEvent = function({ id, eventName }) {\n  if (typeof this.handlers[eventName] === 'function') {\n    this.handlers[eventName]();\n  }\n\n  logMessage(`Prebid Renderer event for id ${id} type ${eventName}`);\n};\n\n/*\n * Calls functions that were pushed to the command queue before the\n * renderer was loaded by `loadExternalScript`\n */\nRenderer.prototype.process = function() {\n  while (this.cmd.length > 0) {\n    try {\n      this.cmd.shift().call();\n    } catch (error) {\n      logError('Error processing Renderer command: ', error);\n    }\n  }\n};\n\n/**\n * Checks whether creative rendering should be done by Renderer or not.\n * @param {Object} renderer Renderer object installed by adapter\n * @returns {Boolean}\n */\nexport function isRendererRequired(renderer) {\n  return !!(renderer && (renderer.url || renderer.renderNow));\n}\n\n/**\n * Render the bid returned by the adapter\n * @param {Object} renderer Renderer object installed by adapter\n * @param {Object} bid Bid response\n * @param {Document} doc context document of bid\n */\nexport function executeRenderer(renderer, bid, doc) {\n  let docContext = null;\n  if (renderer.config && renderer.config.documentResolver) {\n    docContext = renderer.config.documentResolver(bid, document, doc);// a user provided callback, which should return a Document, and expect the parameters; bid, sourceDocument, renderDocument\n  }\n  if (!docContext) {\n    docContext = document;\n  }\n  renderer.documentContext = docContext;\n  renderer.render(bid, renderer.documentContext);\n}\n\nfunction isRendererPreferredFromAdUnit(adUnitCode) {\n  const adUnits = pbjsInstance.adUnits;\n  const adUnit = find(adUnits, adUnit => {\n    return adUnit.code === adUnitCode;\n  });\n\n  if (!adUnit) {\n    return false\n  }\n\n  // renderer defined at adUnit level\n  const adUnitRenderer = adUnit?.renderer;\n  const hasValidAdUnitRenderer = !!(adUnitRenderer && adUnitRenderer.url && adUnitRenderer.render);\n\n  // renderer defined at adUnit.mediaTypes level\n  const mediaTypeRenderer = adUnit?.mediaTypes?.video?.renderer;\n  const hasValidMediaTypeRenderer = !!(mediaTypeRenderer && mediaTypeRenderer.url && mediaTypeRenderer.render)\n\n  return !!(\n    (hasValidAdUnitRenderer && !(adUnitRenderer.backupOnly === true)) ||\n    (hasValidMediaTypeRenderer && !(mediaTypeRenderer.backupOnly === true))\n  );\n}\n","/**\n * Activity (that are relevant for privacy) definitions\n *\n * ref. https://docs.google.com/document/d/1dRxFUFmhh2jGanzGZvfkK_6jtHPpHXWD7Qsi6KEugeE\n * & https://github.com/prebid/Prebid.js/issues/9546\n */\n\n/**\n * accessDevice: some component wants to read or write to localStorage or cookies.\n */\nexport const ACTIVITY_ACCESS_DEVICE = 'accessDevice';\n/**\n * syncUser: A bid adapter wants to run a user sync.\n */\nexport const ACTIVITY_SYNC_USER = 'syncUser';\n/**\n * enrichUfpd: some component wants to add user first-party data to bid requests.\n */\nexport const ACTIVITY_ENRICH_UFPD = 'enrichUfpd';\n/**\n * enrichEids: some component wants to add user IDs to bid requests.\n */\nexport const ACTIVITY_ENRICH_EIDS = 'enrichEids';\n/**\n * fetchBid: a bidder wants to bid.\n */\nexport const ACTIVITY_FETCH_BIDS = 'fetchBids';\n\n/**\n * reportAnalytics: some component wants to phone home with analytics data.\n */\nexport const ACTIVITY_REPORT_ANALYTICS = 'reportAnalytics';\n\n/**\n * some component wants access to (and send along) user IDs\n */\nexport const ACTIVITY_TRANSMIT_EIDS = 'transmitEids'\n\n/**\n * transmitUfpd: some component wants access to (and send along) user FPD\n */\nexport const ACTIVITY_TRANSMIT_UFPD = 'transmitUfpd';\n\n/**\n * transmitPreciseGeo: some component wants access to (and send along) geolocation info\n */\nexport const ACTIVITY_TRANSMIT_PRECISE_GEO = 'transmitPreciseGeo';\n\n/**\n * transmit TID: some component wants access ot (and send along) transaction IDs\n */\nexport const ACTIVITY_TRANSMIT_TID = 'transmitTid';\n\n/**\n * loadExternalScript: adLoader.js is allowed to load external script\n */\nexport const LOAD_EXTERNAL_SCRIPT = 'loadExternalScript';\n","import adapterManager from '../adapterManager.js';\nimport {activityParamsBuilder} from './params.js';\n\n/**\n * Utility function for building common activity parameters - broken out to its own\n * file to avoid circular imports.\n */\nexport const activityParams = activityParamsBuilder((alias) => adapterManager.resolveAlias(alias));\n","export const MODULE_TYPE_PREBID = 'prebid';\nexport const MODULE_TYPE_BIDDER = 'bidder';\nexport const MODULE_TYPE_UID = 'userId';\nexport const MODULE_TYPE_RTD = 'rtd';\nexport const MODULE_TYPE_ANALYTICS = 'analytics';\n","import {MODULE_TYPE_BIDDER} from './modules.js';\nimport {hook} from '../hook.js';\n\n/**\n * Component ID - who is trying to perform the activity?\n * Relevant for all activities.\n */\nexport const ACTIVITY_PARAM_COMPONENT = 'component';\nexport const ACTIVITY_PARAM_COMPONENT_TYPE = ACTIVITY_PARAM_COMPONENT + 'Type';\nexport const ACTIVITY_PARAM_COMPONENT_NAME = ACTIVITY_PARAM_COMPONENT + 'Name';\n\n/**\n * Code of the bid adapter that `componentName` is an alias of.\n * May be the same as the component name.\n *\n * relevant for all activities, but only when componentType is 'bidder'.\n */\nexport const ACTIVITY_PARAM_ADAPTER_CODE = 'adapterCode';\n\n/**\n * Storage type - either 'html5' or 'cookie'.\n * Relevant for: accessDevice\n */\nexport const ACTIVITY_PARAM_STORAGE_TYPE = 'storageType';\n\n/**\n * s2sConfig[].configName, used to identify a particular s2s instance\n * relevant for: fetchBids, but only when component is 'prebid.pbsBidAdapter'\n */\nexport const ACTIVITY_PARAM_S2S_NAME = 'configName';\n/**\n * user sync type - 'iframe' or 'pixel'\n * relevant for: syncUser\n */\nexport const ACTIVITY_PARAM_SYNC_TYPE = 'syncType'\n/**\n * user sync URL\n * relevant for: syncUser\n */\nexport const ACTIVITY_PARAM_SYNC_URL = 'syncUrl';\n/**\n * @private\n * Configuration options for analytics adapter - the argument passed to `enableAnalytics`.\n * Relevant for: reportAnalytics.\n * @constant\n * @type {string}\n */\nexport const ACTIVITY_PARAM_ANL_CONFIG = '_config';\n\nexport function activityParamsBuilder(resolveAlias) {\n  return function activityParams(moduleType, moduleName, params) {\n    const defaults = {\n      [ACTIVITY_PARAM_COMPONENT_TYPE]: moduleType,\n      [ACTIVITY_PARAM_COMPONENT_NAME]: moduleName,\n      [ACTIVITY_PARAM_COMPONENT]: `${moduleType}.${moduleName}`\n    };\n    if (moduleType === MODULE_TYPE_BIDDER) {\n      defaults[ACTIVITY_PARAM_ADAPTER_CODE] = resolveAlias(moduleName);\n    }\n    return buildActivityParams(Object.assign(defaults, params));\n  }\n}\n\nexport const buildActivityParams = hook('sync', params => params);\n","import {deepAccess} from '../utils.js';\nimport {config} from '../config.js';\nimport {isActivityAllowed, registerActivityControl} from './rules.js';\nimport {\n  ACTIVITY_TRANSMIT_EIDS,\n  ACTIVITY_TRANSMIT_PRECISE_GEO,\n  ACTIVITY_TRANSMIT_TID,\n  ACTIVITY_TRANSMIT_UFPD\n} from './activities.js';\nimport { scrubIPv4, scrubIPv6 } from '../utils/ipUtils.js';\n\nexport const ORTB_UFPD_PATHS = [\n  'data',\n  'ext.data',\n  'yob',\n  'gender',\n  'keywords',\n  'kwarray',\n  'id',\n  'buyeruid',\n  'customdata'\n].map(f => `user.${f}`).concat('device.ext.cdep');\nexport const ORTB_EIDS_PATHS = ['user.eids', 'user.ext.eids'];\nexport const ORTB_GEO_PATHS = ['user.geo.lat', 'user.geo.lon', 'device.geo.lat', 'device.geo.lon'];\nexport const ORTB_IPV4_PATHS = ['device.ip']\nexport const ORTB_IPV6_PATHS = ['device.ipv6']\n\n/**\n * @typedef TransformationRuleDef\n * @property {name}\n * @property {Array[string]} paths dot-separated list of paths that this rule applies to.\n * @property {function(*): boolean} applies a predicate that should return true if this rule applies\n * (and the transformation defined herein should be applied). The arguments are those passed to the transformation function.\n * @property {name} a name for the rule; used to debounce calls to `applies` (and avoid excessive logging):\n * if a rule with the same name was already found to apply (or not), this one will (or won't) as well.\n */\n\n/**\n * @typedef RedactRuleDef A rule that removes, or replaces, values from an object (modifications are done in-place).\n * @augments TransformationRuleDef\n * @property {function(*): *} get? substitution functions for values that should be redacted;\n *  takes in the original (unredacted) value as an input, and returns a substitute to use in the redacted\n *  version. If it returns undefined, or this option is omitted, protected paths will be removed\n *  from the redacted object.\n */\n\n/**\n * @param {RedactRuleDef} ruleDef\n * @return {TransformationRule}\n */\nexport function redactRule(ruleDef) {\n  return Object.assign({\n    get() {},\n    run(root, path, object, property, applies) {\n      const val = object && object[property];\n      if (isData(val) && applies()) {\n        const repl = this.get(val);\n        if (repl === undefined) {\n          delete object[property];\n        } else {\n          object[property] = repl;\n        }\n      }\n    }\n  }, ruleDef)\n}\n\n/**\n * @typedef TransformationRule\n * @augments TransformationRuleDef\n * @property {function} run rule logic - see `redactRule` for an example.\n */\n\n/**\n * @typedef {Function} TransformationFunction\n * @param object object to transform\n * @param ...args arguments to pass down to rule's `apply` methods.\n */\n\n/**\n * Return a transformation function that will apply the given rules to an object.\n *\n * @param {Array[TransformationRule]} rules\n * @return {TransformationFunction}\n */\nexport function objectTransformer(rules) {\n  rules.forEach(rule => {\n    rule.paths = rule.paths.map((path) => {\n      const parts = path.split('.');\n      const tail = parts.pop();\n      return [parts.length > 0 ? parts.join('.') : null, tail]\n    })\n  })\n  return function applyTransform(session, obj, ...args) {\n    const result = [];\n    const applies = sessionedApplies(session, ...args);\n    rules.forEach(rule => {\n      if (session[rule.name] === false) return;\n      for (const [head, tail] of rule.paths) {\n        const parent = head == null ? obj : deepAccess(obj, head);\n        result.push(rule.run(obj, head, parent, tail, applies.bind(null, rule)));\n        if (session[rule.name] === false) return;\n      }\n    })\n    return result.filter(el => el != null);\n  }\n}\n\nexport function sessionedApplies(session, ...args) {\n  return function applies(rule) {\n    if (!session.hasOwnProperty(rule.name)) {\n      session[rule.name] = !!rule.applies(...args);\n    }\n    return session[rule.name];\n  }\n}\n\nexport function isData(val) {\n  return val != null && (typeof val !== 'object' || Object.keys(val).length > 0)\n}\n\nexport function appliesWhenActivityDenied(activity, isAllowed = isActivityAllowed) {\n  return function applies(params) {\n    return !isAllowed(activity, params);\n  };\n}\n\nfunction bidRequestTransmitRules(isAllowed = isActivityAllowed) {\n  return [\n    {\n      name: ACTIVITY_TRANSMIT_EIDS,\n      paths: ['userId', 'userIdAsEids'],\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_EIDS, isAllowed),\n    },\n    {\n      name: ACTIVITY_TRANSMIT_TID,\n      paths: ['ortb2Imp.ext.tid'],\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_TID, isAllowed)\n    }\n  ].map(redactRule)\n}\n\nexport function ortb2TransmitRules(isAllowed = isActivityAllowed) {\n  return [\n    {\n      name: ACTIVITY_TRANSMIT_UFPD,\n      paths: ORTB_UFPD_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_UFPD, isAllowed),\n    },\n    {\n      name: ACTIVITY_TRANSMIT_EIDS,\n      paths: ORTB_EIDS_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_EIDS, isAllowed),\n    },\n    {\n      name: ACTIVITY_TRANSMIT_PRECISE_GEO,\n      paths: ORTB_GEO_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_PRECISE_GEO, isAllowed),\n      get(val) {\n        return Math.round((val + Number.EPSILON) * 100) / 100;\n      }\n    },\n    {\n      name: ACTIVITY_TRANSMIT_PRECISE_GEO,\n      paths: ORTB_IPV4_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_PRECISE_GEO, isAllowed),\n      get(val) {\n        return scrubIPv4(val);\n      }\n    },\n    {\n      name: ACTIVITY_TRANSMIT_PRECISE_GEO,\n      paths: ORTB_IPV6_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_PRECISE_GEO, isAllowed),\n      get(val) {\n        return scrubIPv6(val);\n      }\n    },\n    {\n      name: ACTIVITY_TRANSMIT_TID,\n      paths: ['source.tid'],\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_TID, isAllowed),\n    }\n  ].map(redactRule);\n}\n\nexport function redactorFactory(isAllowed = isActivityAllowed) {\n  const redactOrtb2 = objectTransformer(ortb2TransmitRules(isAllowed));\n  const redactBidRequest = objectTransformer(bidRequestTransmitRules(isAllowed));\n  return function redactor(params) {\n    const session = {};\n    return {\n      ortb2(obj) { redactOrtb2(session, obj, params); return obj },\n      bidRequest(obj) { redactBidRequest(session, obj, params); return obj }\n    }\n  }\n}\n\n/**\n * Returns an object that can redact other privacy-sensitive objects according\n * to activity rules.\n *\n * @param {{}} params activity parameters to use for activity checks\n * @return {{ortb2: function({}): {}, bidRequest: function({}): {}}} methods\n *  that can redact disallowed data from ORTB2 and/or bid request objects.\n */\nexport const redactor = redactorFactory();\n\n// by default, TIDs are off since version 8\nregisterActivityControl(ACTIVITY_TRANSMIT_TID, 'enableTIDs config', () => {\n  if (!config.getConfig('enableTIDs')) {\n    return {allow: false, reason: 'TIDs are disabled'}\n  }\n});\n","import {prefixLog} from '../utils.js';\nimport {ACTIVITY_PARAM_COMPONENT} from './params.js';\n\nexport function ruleRegistry(logger = prefixLog('Activity control:')) {\n  const registry = {};\n\n  function getRules(activity) {\n    return registry[activity] = registry[activity] || [];\n  }\n\n  function runRule(activity, name, rule, params) {\n    let res;\n    try {\n      res = rule(params);\n    } catch (e) {\n      logger.logError(`Exception in rule ${name} for '${activity}'`, e);\n      res = {allow: false, reason: e};\n    }\n    return res && Object.assign({activity, name, component: params[ACTIVITY_PARAM_COMPONENT]}, res);\n  }\n\n  const dupes = {};\n  const DEDUPE_INTERVAL = 1000;\n\n  function logResult({activity, name, allow, reason, component}) {\n    const msg = `${name} ${allow ? 'allowed' : 'denied'} '${activity}' for '${component}'${reason ? ':' : ''}`;\n    const deduping = dupes.hasOwnProperty(msg);\n    if (deduping) {\n      clearTimeout(dupes[msg]);\n    }\n    dupes[msg] = setTimeout(() => delete dupes[msg], DEDUPE_INTERVAL);\n    if (!deduping) {\n      const parts = [msg];\n      reason && parts.push(reason);\n      (allow ? logger.logInfo : logger.logWarn).apply(logger, parts);\n    }\n  }\n\n  return [\n    /**\n     * Register an activity control rule.\n     *\n     * @param {string} activity - Activity name, as defined in `activities.js`.\n     * @param {string} ruleName - A name for this rule, used for logging.\n     * @param {function(Object): {allow: boolean, reason?: string}} rule - Rule definition function. Takes in activity\n     *        parameters as a single map; MAY return an object {allow, reason}, where allow is true/false,\n     *        and reason is an optional message used for logging.\n     *\n     *        {allow: true} will allow this activity AS LONG AS no other rules with the same or higher priority return {allow: false};\n     *        {allow: false} will deny this activity AS LONG AS no other rules with higher priority return {allow: true};\n     *        Returning null/undefined has no effect - the decision is left to other rules.\n     *        If no rule returns an allow value, the default is to allow the activity.\n     *\n     * @param {number} [priority=10] - Rule priority; lower number means higher priority.\n     * @returns {function(): void} - A function that unregisters the rule when called.\n     */\n    function registerActivityControl(activity, ruleName, rule, priority = 10) {\n      const rules = getRules(activity);\n      const pos = rules.findIndex(([itemPriority]) => priority < itemPriority);\n      const entry = [priority, ruleName, rule];\n      rules.splice(pos < 0 ? rules.length : pos, 0, entry);\n      return function () {\n        const idx = rules.indexOf(entry);\n        if (idx >= 0) rules.splice(idx, 1);\n      }\n    },\n    /**\n     * Test whether an activity is allowed.\n     *\n     * @param {string} activity activity name\n     * @param {{}} params activity parameters; should be generated through the `activityParams` utility.\n     * @return {boolean} true for allow, false for deny.\n     */\n    function isActivityAllowed(activity, params) {\n      let lastPriority, foundAllow;\n      for (const [priority, name, rule] of getRules(activity)) {\n        if (lastPriority !== priority && foundAllow) break;\n        lastPriority = priority;\n        const ruleResult = runRule(activity, name, rule, params);\n        if (ruleResult) {\n          if (!ruleResult.allow) {\n            logResult(ruleResult);\n            return false;\n          } else {\n            foundAllow = ruleResult;\n          }\n        }\n      }\n      foundAllow && logResult(foundAllow);\n      return true;\n    }\n  ];\n}\n\nexport const [registerActivityControl, isActivityAllowed] = ruleRegistry();\n","import {\n  createIframe,\n  createInvisibleIframe,\n  inIframe,\n  insertElement,\n  logError,\n  logWarn,\n  replaceMacros\n} from './utils.js';\nimport * as events from './events.js';\nimport {AD_RENDER_FAILED_REASON, BID_STATUS, EVENTS, MESSAGES, PB_LOCATOR} from './constants.js';\nimport {config} from './config.js';\nimport {executeRenderer, isRendererRequired} from './Renderer.js';\nimport {VIDEO} from './mediaTypes.js';\nimport {auctionManager} from './auctionManager.js';\nimport {getCreativeRenderer} from './creativeRenderers.js';\nimport {hook} from './hook.js';\nimport {fireNativeTrackers} from './native.js';\nimport {GreedyPromise} from './utils/promise.js';\nimport adapterManager from './adapterManager.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {filters} from './targeting.js';\n\nconst { AD_RENDER_FAILED, AD_RENDER_SUCCEEDED, STALE_RENDER, BID_WON, EXPIRED_RENDER } = EVENTS;\nconst { EXCEPTION } = AD_RENDER_FAILED_REASON;\n\nexport const getBidToRender = hook('sync', function (adId, forRender = true, override = GreedyPromise.resolve()) {\n  return override\n    .then(bid => bid ?? auctionManager.findBidByAdId(adId))\n    .catch(() => {})\n})\n\nexport const markWinningBid = hook('sync', function (bid) {\n  events.emit(BID_WON, bid);\n  auctionManager.addWinningBid(bid);\n})\n\n/**\n * Emit the AD_RENDER_FAILED event.\n *\n * @param {Object} data\n * @param data.reason one of the values in AD_RENDER_FAILED_REASON\n * @param data.message failure description\n * @param [data.bid] bid response object that failed to render\n * @param [data.id] adId that failed to render\n */\nexport function emitAdRenderFail({ reason, message, bid, id }) {\n  const data = { reason, message };\n  if (bid) {\n    data.bid = bid;\n    data.adId = bid.adId;\n  }\n  if (id) data.adId = id;\n\n  logError(`Error rendering ad (id: ${id}): ${message}`);\n  events.emit(AD_RENDER_FAILED, data);\n}\n\n/**\n * Emit the AD_RENDER_SUCCEEDED event.\n * (Note: Invocation of this function indicates that the render function did not generate an error, it does not guarantee that tracking for this event has occurred yet.)\n * @param {Object} data\n * @param data.doc document object that was used to `.write` the ad. Should be `null` if unavailable (e.g. for documents in\n * a cross-origin frame).\n * @param [data.bid] bid response object for the ad that was rendered\n * @param [data.id] adId that was rendered.\n */\nexport function emitAdRenderSucceeded({ doc, bid, id }) {\n  const data = { doc };\n  if (bid) data.bid = bid;\n  if (id) data.adId = id;\n\n  adapterManager.callAdRenderSucceededBidder(bid.adapterCode || bid.bidder, bid);\n\n  events.emit(AD_RENDER_SUCCEEDED, data);\n}\n\nexport function handleCreativeEvent(data, bidResponse) {\n  switch (data.event) {\n    case EVENTS.AD_RENDER_FAILED:\n      emitAdRenderFail({\n        bid: bidResponse,\n        id: bidResponse.adId,\n        reason: data.info.reason,\n        message: data.info.message\n      });\n      break;\n    case EVENTS.AD_RENDER_SUCCEEDED:\n      emitAdRenderSucceeded({\n        doc: null,\n        bid: bidResponse,\n        id: bidResponse.adId\n      });\n      break;\n    default:\n      logError(`Received event request for unsupported event: '${data.event}' (adId: '${bidResponse.adId}')`);\n  }\n}\n\nexport function handleNativeMessage(data, bidResponse, {resizeFn, fireTrackers = fireNativeTrackers}) {\n  switch (data.action) {\n    case 'resizeNativeHeight':\n      resizeFn(data.width, data.height);\n      break;\n    default:\n      fireTrackers(data, bidResponse);\n  }\n}\n\nconst HANDLERS = {\n  [MESSAGES.EVENT]: handleCreativeEvent\n}\n\nif (FEATURES.NATIVE) {\n  HANDLERS[MESSAGES.NATIVE] = handleNativeMessage;\n}\n\nfunction creativeMessageHandler(deps) {\n  return function (type, data, bidResponse) {\n    if (HANDLERS.hasOwnProperty(type)) {\n      HANDLERS[type](data, bidResponse, deps);\n    }\n  }\n}\n\nexport const getRenderingData = hook('sync', function (bidResponse, options) {\n  const {ad, adUrl, cpm, originalCpm, width, height} = bidResponse\n  const repl = {\n    AUCTION_PRICE: originalCpm || cpm,\n    CLICKTHROUGH: options?.clickUrl || ''\n  }\n  return {\n    ad: replaceMacros(ad, repl),\n    adUrl: replaceMacros(adUrl, repl),\n    width,\n    height\n  };\n})\n\nexport const doRender = hook('sync', function({renderFn, resizeFn, bidResponse, options, doc, isMainDocument = doc === document && !inIframe()}) {\n  const videoBid = (FEATURES.VIDEO && bidResponse.mediaType === VIDEO)\n  if (isMainDocument || videoBid) {\n    emitAdRenderFail({\n      reason: AD_RENDER_FAILED_REASON.PREVENT_WRITING_ON_MAIN_DOCUMENT,\n      message: videoBid ? 'Cannot render video ad without a renderer' : `renderAd was prevented from writing to the main document.`,\n      bid: bidResponse,\n      id: bidResponse.adId\n    });\n    return;\n  }\n  const data = getRenderingData(bidResponse, options);\n  renderFn(Object.assign({adId: bidResponse.adId}, data));\n  const {width, height} = data;\n  if ((width ?? height) != null) {\n    resizeFn(width, height);\n  }\n});\n\ndoRender.before(function (next, args) {\n  // run renderers from a high priority hook to allow the video module to insert itself between this and \"normal\" rendering.\n  const {bidResponse, doc} = args;\n  if (isRendererRequired(bidResponse.renderer)) {\n    executeRenderer(bidResponse.renderer, bidResponse, doc);\n    emitAdRenderSucceeded({doc, bid: bidResponse, id: bidResponse.adId})\n    next.bail();\n  } else {\n    next(args);\n  }\n}, 100)\n\nexport function handleRender({renderFn, resizeFn, adId, options, bidResponse, doc}) {\n  deferRendering(bidResponse, () => {\n    if (bidResponse == null) {\n      emitAdRenderFail({\n        reason: AD_RENDER_FAILED_REASON.CANNOT_FIND_AD,\n        message: `Cannot find ad '${adId}'`,\n        id: adId\n      });\n      return;\n    }\n    if (bidResponse.status === BID_STATUS.RENDERED) {\n      logWarn(`Ad id ${adId} has been rendered before`);\n      events.emit(STALE_RENDER, bidResponse);\n      if (config.getConfig('auctionOptions')?.suppressStaleRender) {\n        return;\n      }\n    }\n    if (!filters.isBidNotExpired(bidResponse)) {\n      logWarn(`Ad id ${adId} has been expired`);\n      events.emit(EXPIRED_RENDER, bidResponse);\n      if (config.getConfig('auctionOptions')?.suppressExpiredRender) {\n        return;\n      }\n    }\n\n    try {\n      doRender({renderFn, resizeFn, bidResponse, options, doc});\n    } catch (e) {\n      emitAdRenderFail({\n        reason: AD_RENDER_FAILED_REASON.EXCEPTION,\n        message: e.message,\n        id: adId,\n        bid: bidResponse\n      });\n    }\n  })\n}\n\nexport function markBidAsRendered(bidResponse) {\n  const metrics = useMetrics(bidResponse.metrics);\n  metrics.checkpoint('bidRender');\n  metrics.timeBetween('bidWon', 'bidRender', 'render.deferred');\n  metrics.timeBetween('auctionEnd', 'bidRender', 'render.pending');\n  metrics.timeBetween('requestBids', 'bidRender', 'render.e2e');\n  bidResponse.status = BID_STATUS.RENDERED;\n}\n\nconst DEFERRED_RENDER = new WeakMap();\nconst WINNERS = new WeakSet();\n\nexport function deferRendering(bidResponse, renderFn) {\n  if (bidResponse == null) {\n    // if the bid is missing, let renderFn deal with it now\n    renderFn();\n    return;\n  }\n  DEFERRED_RENDER.set(bidResponse, renderFn);\n  if (!bidResponse.deferRendering) {\n    renderIfDeferred(bidResponse);\n  }\n  markWinner(bidResponse);\n}\n\nexport function markWinner(bidResponse) {\n  if (!WINNERS.has(bidResponse)) {\n    WINNERS.add(bidResponse);\n    markWinningBid(bidResponse);\n  }\n}\n\nexport function renderIfDeferred(bidResponse) {\n  const renderFn = DEFERRED_RENDER.get(bidResponse);\n  if (renderFn) {\n    renderFn();\n    markBidAsRendered(bidResponse);\n    DEFERRED_RENDER.delete(bidResponse);\n  }\n}\n\nexport function renderAdDirect(doc, adId, options) {\n  let bid;\n  function fail(reason, message) {\n    emitAdRenderFail(Object.assign({id: adId, bid}, {reason, message}));\n  }\n  function resizeFn(width, height) {\n    if (doc.defaultView && doc.defaultView.frameElement) {\n      width && (doc.defaultView.frameElement.width = width);\n      height && (doc.defaultView.frameElement.height = height);\n    }\n  }\n  const messageHandler = creativeMessageHandler({resizeFn});\n  function renderFn(adData) {\n    if (adData.ad) {\n      doc.write(adData.ad);\n      doc.close();\n      emitAdRenderSucceeded({doc, bid, id: bid.adId});\n    } else {\n      getCreativeRenderer(bid)\n        .then(render => render(adData, {\n          sendMessage: (type, data) => messageHandler(type, data, bid),\n          mkFrame: createIframe,\n        }, doc.defaultView))\n        .then(\n          () => emitAdRenderSucceeded({doc, bid, id: bid.adId}),\n          (e) => {\n            fail(e?.reason || AD_RENDER_FAILED_REASON.EXCEPTION, e?.message)\n            e?.stack && logError(e);\n          }\n        );\n    }\n    // TODO: this is almost certainly the wrong way to do this\n    const creativeComment = document.createComment(`Creative ${bid.creativeId} served by ${bid.bidder} Prebid.js Header Bidding`);\n    insertElement(creativeComment, doc, 'html');\n  }\n  try {\n    if (!adId || !doc) {\n      fail(AD_RENDER_FAILED_REASON.MISSING_DOC_OR_ADID, `missing ${adId ? 'doc' : 'adId'}`);\n    } else {\n      getBidToRender(adId).then(bidResponse => {\n        bid = bidResponse;\n        handleRender({renderFn, resizeFn, adId, options: {clickUrl: options?.clickThrough}, bidResponse, doc});\n      });\n    }\n  } catch (e) {\n    fail(EXCEPTION, e.message);\n  }\n}\n\n/**\n * Insert an invisible, named iframe that can be used by creatives to locate the window Prebid is running in\n * (by looking for one that has `.frames[PB_LOCATOR]` defined).\n * This is necessary because in some situations creatives may be rendered inside nested iframes - Prebid is not necessarily\n * in the immediate parent window.\n */\nexport function insertLocatorFrame() {\n  if (!window.frames[PB_LOCATOR]) {\n    if (!document.body) {\n      window.requestAnimationFrame(insertLocatorFrame);\n    } else {\n      const frame = createInvisibleIframe();\n      frame.name = PB_LOCATOR;\n      document.body.appendChild(frame);\n    }\n  }\n}\n","let adUnits = {};\nexport function reset() {\n  adUnits = {}\n}\n\nfunction ensureAdUnit(adunit, bidderCode) {\n  let adUnit = adUnits[adunit] = adUnits[adunit] || { bidders: {} };\n  if (bidderCode) {\n    return adUnit.bidders[bidderCode] = adUnit.bidders[bidderCode] || {}\n  }\n  return adUnit;\n}\n\nfunction incrementAdUnitCount(adunit, counter, bidderCode) {\n  let adUnit = ensureAdUnit(adunit, bidderCode);\n  adUnit[counter] = (adUnit[counter] || 0) + 1;\n  return adUnit[counter];\n}\n\n/**\n * Increments and returns current Adunit counter\n * @param {string} adunit id\n * @returns {number} current adunit count\n */\nexport function incrementRequestsCounter(adunit) {\n  return incrementAdUnitCount(adunit, 'requestsCounter');\n}\n\n/**\n * Increments and returns current Adunit requests counter for a bidder\n * @param {string} adunit id\n * @param {string} bidderCode code\n * @returns {number} current adunit bidder requests count\n */\nexport function incrementBidderRequestsCounter(adunit, bidderCode) {\n  return incrementAdUnitCount(adunit, 'requestsCounter', bidderCode);\n}\n\n/**\n * Increments and returns current Adunit wins counter for a bidder\n * @param {string} adunit id\n * @param {string} bidderCode code\n * @returns {number} current adunit bidder requests count\n */\nexport function incrementBidderWinsCounter(adunit, bidderCode) {\n  return incrementAdUnitCount(adunit, 'winsCounter', bidderCode);\n}\n\n/**\n * Increments and returns current Adunit auctions counter\n * @param {string} adunit id\n * @returns {number} current adunit auctions count\n */\nexport function incrementAuctionsCounter(adunit) {\n  return incrementAdUnitCount(adunit, 'auctionsCounter');\n}\n\n/**\n * Returns current Adunit counter\n * @param {string} adunit id\n * @returns {number} current adunit count\n */\nexport function getRequestsCounter(adunit) {\n  return adUnits?.[adunit]?.requestsCounter || 0;\n}\n\n/**\n * Returns current Adunit requests counter for a specific bidder code\n * @param {string} adunit id\n * @param {string} bidder code\n * @returns {number} current adunit bidder requests count\n */\nexport function getBidderRequestsCounter(adunit, bidder) {\n  return adUnits?.[adunit]?.bidders?.[bidder]?.requestsCounter || 0;\n}\n\n/**\n * Returns current Adunit requests counter for a specific bidder code\n * @param {string} adunit id\n * @param {string} bidder code\n * @returns {number} current adunit bidder requests count\n */\nexport function getBidderWinsCounter(adunit, bidder) {\n  return adUnits?.[adunit]?.bidders?.[bidder]?.winsCounter || 0;\n}\n\n/**\n * Returns current Adunit auctions counter\n * @param {string} adunit id\n * @returns {number} current adunit auctions count\n */\nexport function getAuctionsCounter(adunit) {\n  return adUnits?.[adunit]?.auctionsCounter || 0;\n}\n","export default function Adapter(code) {\n  var bidderCode = code;\n\n  function setBidderCode(code) {\n    bidderCode = code;\n  }\n\n  function getBidderCode() {\n    return bidderCode;\n  }\n\n  function callBids() {\n  }\n\n  return {\n    callBids: callBids,\n    setBidderCode: setBidderCode,\n    getBidderCode: getBidderCode\n  };\n}\n","/** @module adaptermanger */\n\nimport {\n  deepClone,\n  flatten,\n  generateUUID,\n  getBidderCodes,\n  getDefinedParams,\n  getUniqueIdentifierStr,\n  getUserConfiguredParams,\n  groupBy,\n  internal,\n  isArray,\n  isPlainObject,\n  isValidMediaTypes,\n  logError,\n  logInfo,\n  logMessage,\n  logWarn,\n  mergeDeep,\n  shuffle,\n  timestamp,\n  uniques,\n} from './utils.js';\nimport {decorateAdUnitsWithNativeParams, nativeAdapters} from './native.js';\nimport {newBidder} from './adapters/bidderFactory.js';\nimport {ajaxBuilder} from './ajax.js';\nimport {config, RANDOM} from './config.js';\nimport {hook} from './hook.js';\nimport {find, includes} from './polyfill.js';\nimport {\n  getAuctionsCounter,\n  getBidderRequestsCounter,\n  getBidderWinsCounter,\n  getRequestsCounter,\n  incrementAuctionsCounter,\n  incrementBidderRequestsCounter,\n  incrementBidderWinsCounter,\n  incrementRequestsCounter\n} from './adUnits.js';\nimport {getRefererInfo} from './refererDetection.js';\nimport {GDPR_GVLIDS, gdprDataHandler, gppDataHandler, uspDataHandler, } from './consentHandler.js';\nimport * as events from './events.js';\nimport {EVENTS, S2S} from './constants.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {auctionManager} from './auctionManager.js';\nimport {MODULE_TYPE_ANALYTICS, MODULE_TYPE_BIDDER, MODULE_TYPE_PREBID} from './activities/modules.js';\nimport {isActivityAllowed} from './activities/rules.js';\nimport {ACTIVITY_FETCH_BIDS, ACTIVITY_REPORT_ANALYTICS} from './activities/activities.js';\nimport {ACTIVITY_PARAM_ANL_CONFIG, ACTIVITY_PARAM_S2S_NAME, activityParamsBuilder} from './activities/params.js';\nimport {redactor} from './activities/redactor.js';\n\nexport {gdprDataHandler, gppDataHandler, uspDataHandler, coppaDataHandler} from './consentHandler.js';\n\nexport const PBS_ADAPTER_NAME = 'pbsBidAdapter';\nexport const PARTITIONS = {\n  CLIENT: 'client',\n  SERVER: 'server'\n}\n\nexport const dep = {\n  isAllowed: isActivityAllowed,\n  redact: redactor\n}\n\nlet adapterManager = {};\n\nlet _bidderRegistry = adapterManager.bidderRegistry = {};\nlet _aliasRegistry = adapterManager.aliasRegistry = {};\n\nlet _s2sConfigs = [];\nconfig.getConfig('s2sConfig', config => {\n  if (config && config.s2sConfig) {\n    _s2sConfigs = isArray(config.s2sConfig) ? config.s2sConfig : [config.s2sConfig];\n  }\n});\n\nvar _analyticsRegistry = {};\n\nconst activityParams = activityParamsBuilder((alias) => adapterManager.resolveAlias(alias));\n\nexport function s2sActivityParams(s2sConfig) {\n  return activityParams(MODULE_TYPE_PREBID, PBS_ADAPTER_NAME, {\n    [ACTIVITY_PARAM_S2S_NAME]: s2sConfig.configName\n  });\n}\n\n/**\n * @typedef {object} LabelDescriptor\n * @property {boolean} labelAll describes whether or not this object expects all labels to match, or any label to match\n * @property {Array<string>} labels the labels listed on the bidder or adUnit\n * @property {Array<string>} activeLabels the labels specified as being active by requestBids\n */\n\nfunction getBids({bidderCode, auctionId, bidderRequestId, adUnits, src, metrics}) {\n  return adUnits.reduce((result, adUnit) => {\n    const bids = adUnit.bids.filter(bid => bid.bidder === bidderCode);\n    if (bidderCode == null && bids.length === 0 && adUnit.s2sBid != null) {\n      bids.push({bidder: null});\n    }\n    result.push(\n      bids.reduce((bids, bid) => {\n        bid = Object.assign({}, bid,\n          {ortb2Imp: mergeDeep({}, adUnit.ortb2Imp, bid.ortb2Imp)},\n          getDefinedParams(adUnit, [\n            'nativeParams',\n            'nativeOrtbRequest',\n            'mediaType',\n            'renderer'\n          ])\n        );\n\n        const mediaTypes = bid.mediaTypes == null ? adUnit.mediaTypes : bid.mediaTypes\n\n        if (isValidMediaTypes(mediaTypes)) {\n          bid = Object.assign({}, bid, {\n            mediaTypes\n          });\n        } else {\n          logError(\n            `mediaTypes is not correctly configured for adunit ${adUnit.code}`\n          );\n        }\n\n        if (src === 'client') {\n          incrementBidderRequestsCounter(adUnit.code, bidderCode);\n        }\n\n        bids.push(Object.assign({}, bid, {\n          adUnitCode: adUnit.code,\n          transactionId: adUnit.transactionId,\n          adUnitId: adUnit.adUnitId,\n          sizes: mediaTypes?.banner?.sizes || mediaTypes?.video?.playerSize || [],\n          bidId: bid.bid_id || getUniqueIdentifierStr(),\n          bidderRequestId,\n          auctionId,\n          src,\n          metrics,\n          auctionsCount: getAuctionsCounter(adUnit.code),\n          bidRequestsCount: getRequestsCounter(adUnit.code),\n          bidderRequestsCount: getBidderRequestsCounter(adUnit.code, bid.bidder),\n          bidderWinsCount: getBidderWinsCounter(adUnit.code, bid.bidder),\n          deferBilling: !!adUnit.deferBilling\n        }));\n        return bids;\n      }, [])\n    );\n    return result;\n  }, []).reduce(flatten, []).filter(val => val !== '');\n}\n\nconst hookedGetBids = hook('sync', getBids, 'getBids');\n\n/**\n * Filter an adUnit's  bids for building client and/or server requests\n *\n * @param bids an array of bids as defined in an adUnit\n * @param s2sConfig null if the adUnit is being routed to a client adapter; otherwise the s2s adapter's config\n * @returns the subset of `bids` that are pertinent for the given `s2sConfig`\n */\nexport function _filterBidsForAdUnit(bids, s2sConfig, {getS2SBidders = getS2SBidderSet} = {}) {\n  if (s2sConfig == null) {\n    return bids;\n  } else {\n    const serverBidders = getS2SBidders(s2sConfig);\n    return bids.filter((bid) => serverBidders.has(bid.bidder))\n  }\n}\nexport const filterBidsForAdUnit = hook('sync', _filterBidsForAdUnit, 'filterBidsForAdUnit');\n\nfunction getAdUnitCopyForPrebidServer(adUnits, s2sConfig) {\n  let adUnitsCopy = deepClone(adUnits);\n  let hasModuleBids = false;\n\n  adUnitsCopy.forEach((adUnit) => {\n    // filter out client side bids\n    const s2sBids = adUnit.bids.filter((b) => b.module === PBS_ADAPTER_NAME && b.params?.configName === s2sConfig.configName);\n    if (s2sBids.length === 1) {\n      adUnit.s2sBid = s2sBids[0];\n      hasModuleBids = true;\n      adUnit.ortb2Imp = mergeDeep({}, adUnit.s2sBid.ortb2Imp, adUnit.ortb2Imp);\n    } else if (s2sBids.length > 1) {\n      logWarn('Multiple \"module\" bids for the same s2s configuration; all will be ignored', s2sBids);\n    }\n    adUnit.bids = filterBidsForAdUnit(adUnit.bids, s2sConfig)\n      .map((bid) => {\n        bid.bid_id = getUniqueIdentifierStr();\n        return bid;\n      });\n  });\n\n  // don't send empty requests\n  adUnitsCopy = adUnitsCopy.filter(adUnit => {\n    return adUnit.bids.length !== 0 || adUnit.s2sBid != null;\n  });\n  return {adUnits: adUnitsCopy, hasModuleBids};\n}\n\nfunction getAdUnitCopyForClientAdapters(adUnits) {\n  let adUnitsClientCopy = deepClone(adUnits);\n  adUnitsClientCopy.forEach((adUnit) => {\n    adUnit.bids = filterBidsForAdUnit(adUnit.bids, null);\n  });\n\n  // don't send empty requests\n  adUnitsClientCopy = adUnitsClientCopy.filter(adUnit => {\n    return adUnit.bids.length !== 0;\n  });\n\n  return adUnitsClientCopy;\n}\n\n/**\n * Filter and/or modify media types for ad units based on the given labels.\n *\n * This should return adUnits that are active for the given labels, modified to have their `mediaTypes`\n * conform to size mapping configuration. If different bids for the same adUnit should use different `mediaTypes`,\n * they should be exposed under `adUnit.bids[].mediaTypes`.\n */\nexport const setupAdUnitMediaTypes = hook('sync', (adUnits, labels) => {\n  return adUnits;\n}, 'setupAdUnitMediaTypes')\n\n/**\n * @param {{}|Array<{}>} s2sConfigs\n * @returns {Set<String>} a set of all the bidder codes that should be routed through the S2S adapter(s)\n *                        as defined in `s2sConfigs`\n */\nexport function getS2SBidderSet(s2sConfigs) {\n  if (!isArray(s2sConfigs)) s2sConfigs = [s2sConfigs];\n  // `null` represents the \"no bid bidder\" - when an ad unit is meant only for S2S adapters, like stored impressions\n  const serverBidders = new Set([null]);\n  s2sConfigs.filter((s2s) => s2s && s2s.enabled)\n    .flatMap((s2s) => s2s.bidders)\n    .forEach((bidder) => serverBidders.add(bidder));\n  return serverBidders;\n}\n\n/**\n * @param {Array} adUnits - The ad units to be processed.\n * @param {Object} s2sConfigs - The server-to-server configurations.\n * @returns {Object} - An object containing arrays of bidder codes for client and server.\n * @returns {Object} return.client - Array of bidder codes that should be routed to client adapters.\n * @returns {Object} return.server - Array of bidder codes that should be routed to server adapters.\n */\nexport function _partitionBidders (adUnits, s2sConfigs, {getS2SBidders = getS2SBidderSet} = {}) {\n  const serverBidders = getS2SBidders(s2sConfigs);\n  return getBidderCodes(adUnits).reduce((memo, bidder) => {\n    const partition = serverBidders.has(bidder) ? PARTITIONS.SERVER : PARTITIONS.CLIENT;\n    memo[partition].push(bidder);\n    return memo;\n  }, {[PARTITIONS.CLIENT]: [], [PARTITIONS.SERVER]: []})\n}\n\nexport const partitionBidders = hook('sync', _partitionBidders, 'partitionBidders');\n\nadapterManager.makeBidRequests = hook('sync', function (adUnits, auctionStart, auctionId, cbTimeout, labels, ortb2Fragments = {}, auctionMetrics) {\n  auctionMetrics = useMetrics(auctionMetrics);\n  /**\n   * emit and pass adunits for external modification\n   * @see {@link https://github.com/prebid/Prebid.js/issues/4149|Issue}\n   */\n  events.emit(EVENTS.BEFORE_REQUEST_BIDS, adUnits);\n  if (FEATURES.NATIVE) {\n    decorateAdUnitsWithNativeParams(adUnits);\n  }\n  adUnits\n    .map(adUnit => adUnit.code)\n    .filter(uniques)\n    .forEach(incrementAuctionsCounter);\n\n  adUnits.forEach(au => {\n    if (!isPlainObject(au.mediaTypes)) {\n      au.mediaTypes = {};\n    }\n    // filter out bidders that cannot participate in the auction\n    au.bids = au.bids.filter((bid) => !bid.bidder || dep.isAllowed(ACTIVITY_FETCH_BIDS, activityParams(MODULE_TYPE_BIDDER, bid.bidder)))\n    incrementRequestsCounter(au.code);\n  });\n\n  adUnits = setupAdUnitMediaTypes(adUnits, labels);\n\n  let {[PARTITIONS.CLIENT]: clientBidders, [PARTITIONS.SERVER]: serverBidders} = partitionBidders(adUnits, _s2sConfigs);\n\n  if (config.getConfig('bidderSequence') === RANDOM) {\n    clientBidders = shuffle(clientBidders);\n  }\n  const refererInfo = getRefererInfo();\n\n  let bidRequests = [];\n\n  const ortb2 = ortb2Fragments.global || {};\n  const bidderOrtb2 = ortb2Fragments.bidder || {};\n\n  function addOrtb2(bidderRequest, s2sActivityParams) {\n    const redact = dep.redact(\n      s2sActivityParams != null\n        ? s2sActivityParams\n        : activityParams(MODULE_TYPE_BIDDER, bidderRequest.bidderCode)\n    );\n    const fpd = Object.freeze(redact.ortb2(mergeDeep({source: {tid: auctionId}}, ortb2, bidderOrtb2[bidderRequest.bidderCode])));\n    bidderRequest.ortb2 = fpd;\n    bidderRequest.bids = bidderRequest.bids.map((bid) => {\n      bid.ortb2 = fpd;\n      return redact.bidRequest(bid);\n    })\n    return bidderRequest;\n  }\n\n  _s2sConfigs.forEach(s2sConfig => {\n    const s2sParams = s2sActivityParams(s2sConfig);\n    if (s2sConfig && s2sConfig.enabled && dep.isAllowed(ACTIVITY_FETCH_BIDS, s2sParams)) {\n      let {adUnits: adUnitsS2SCopy, hasModuleBids} = getAdUnitCopyForPrebidServer(adUnits, s2sConfig);\n\n      // uniquePbsTid is so we know which server to send which bids to during the callBids function\n      let uniquePbsTid = generateUUID();\n\n      (serverBidders.length === 0 && hasModuleBids ? [null] : serverBidders).forEach(bidderCode => {\n        const bidderRequestId = getUniqueIdentifierStr();\n        const metrics = auctionMetrics.fork();\n        const bidderRequest = addOrtb2({\n          bidderCode,\n          auctionId,\n          bidderRequestId,\n          uniquePbsTid,\n          bids: hookedGetBids({ bidderCode, auctionId, bidderRequestId, 'adUnits': deepClone(adUnitsS2SCopy), src: S2S.SRC, metrics }),\n          auctionStart: auctionStart,\n          timeout: s2sConfig.timeout,\n          src: S2S.SRC,\n          refererInfo,\n          metrics,\n        }, s2sParams);\n        if (bidderRequest.bids.length !== 0) {\n          bidRequests.push(bidderRequest);\n        }\n      });\n\n      // update the s2sAdUnits object and remove all bids that didn't pass sizeConfig/label checks from getBids()\n      // this is to keep consistency and only allow bids/adunits that passed the checks to go to pbs\n      adUnitsS2SCopy.forEach((adUnitCopy) => {\n        let validBids = adUnitCopy.bids.filter((adUnitBid) =>\n          find(bidRequests, request =>\n            find(request.bids, (reqBid) => reqBid.bidId === adUnitBid.bid_id)));\n        adUnitCopy.bids = validBids;\n      });\n\n      bidRequests.forEach(request => {\n        if (request.adUnitsS2SCopy === undefined) {\n          request.adUnitsS2SCopy = adUnitsS2SCopy.filter(au => au.bids.length > 0 || au.s2sBid != null);\n        }\n      });\n    }\n  });\n\n  // client adapters\n  let adUnitsClientCopy = getAdUnitCopyForClientAdapters(adUnits);\n  clientBidders.forEach(bidderCode => {\n    const bidderRequestId = getUniqueIdentifierStr();\n    const metrics = auctionMetrics.fork();\n    const bidderRequest = addOrtb2({\n      bidderCode,\n      auctionId,\n      bidderRequestId,\n      bids: hookedGetBids({bidderCode, auctionId, bidderRequestId, 'adUnits': deepClone(adUnitsClientCopy), labels, src: 'client', metrics}),\n      auctionStart: auctionStart,\n      timeout: cbTimeout,\n      refererInfo,\n      metrics,\n    });\n    const adapter = _bidderRegistry[bidderCode];\n    if (!adapter) {\n      logError(`Trying to make a request for bidder that does not exist: ${bidderCode}`);\n    }\n\n    if (adapter && bidderRequest.bids && bidderRequest.bids.length !== 0) {\n      bidRequests.push(bidderRequest);\n    }\n  });\n\n  bidRequests.forEach(bidRequest => {\n    if (gdprDataHandler.getConsentData()) {\n      bidRequest['gdprConsent'] = gdprDataHandler.getConsentData();\n    }\n    if (uspDataHandler.getConsentData()) {\n      bidRequest['uspConsent'] = uspDataHandler.getConsentData();\n    }\n    if (gppDataHandler.getConsentData()) {\n      bidRequest['gppConsent'] = gppDataHandler.getConsentData();\n    }\n  });\n  return bidRequests;\n}, 'makeBidRequests');\n\nadapterManager.callBids = (adUnits, bidRequests, addBidResponse, doneCb, requestCallbacks, requestBidsTimeout, onTimelyResponse, ortb2Fragments = {}) => {\n  if (!bidRequests.length) {\n    logWarn('callBids executed with no bidRequests.  Were they filtered by labels or sizing?');\n    return;\n  }\n\n  let [clientBidderRequests, serverBidderRequests] = bidRequests.reduce((partitions, bidRequest) => {\n    partitions[Number(typeof bidRequest.src !== 'undefined' && bidRequest.src === S2S.SRC)].push(bidRequest);\n    return partitions;\n  }, [[], []]);\n\n  var uniqueServerBidRequests = [];\n  serverBidderRequests.forEach(serverBidRequest => {\n    var index = -1;\n    for (var i = 0; i < uniqueServerBidRequests.length; ++i) {\n      if (serverBidRequest.uniquePbsTid === uniqueServerBidRequests[i].uniquePbsTid) {\n        index = i;\n        break;\n      }\n    }\n    if (index <= -1) {\n      uniqueServerBidRequests.push(serverBidRequest);\n    }\n  });\n\n  let counter = 0;\n\n  _s2sConfigs.forEach((s2sConfig) => {\n    if (s2sConfig && uniqueServerBidRequests[counter] && getS2SBidderSet(s2sConfig).has(uniqueServerBidRequests[counter].bidderCode)) {\n      // s2s should get the same client side timeout as other client side requests.\n      const s2sAjax = ajaxBuilder(requestBidsTimeout, requestCallbacks ? {\n        request: requestCallbacks.request.bind(null, 's2s'),\n        done: requestCallbacks.done\n      } : undefined);\n      let adaptersServerSide = s2sConfig.bidders;\n      const s2sAdapter = _bidderRegistry[s2sConfig.adapter];\n      let uniquePbsTid = uniqueServerBidRequests[counter].uniquePbsTid;\n      let adUnitsS2SCopy = uniqueServerBidRequests[counter].adUnitsS2SCopy;\n\n      let uniqueServerRequests = serverBidderRequests.filter(serverBidRequest => serverBidRequest.uniquePbsTid === uniquePbsTid);\n\n      if (s2sAdapter) {\n        let s2sBidRequest = {'ad_units': adUnitsS2SCopy, s2sConfig, ortb2Fragments, requestBidsTimeout};\n        if (s2sBidRequest.ad_units.length) {\n          let doneCbs = uniqueServerRequests.map(bidRequest => {\n            bidRequest.start = timestamp();\n            return function (timedOut) {\n              if (!timedOut) {\n                onTimelyResponse(bidRequest.bidderRequestId);\n              }\n              doneCb.apply(bidRequest, arguments);\n            }\n          });\n\n          const bidders = getBidderCodes(s2sBidRequest.ad_units).filter((bidder) => adaptersServerSide.includes(bidder));\n          logMessage(`CALLING S2S HEADER BIDDERS ==== ${bidders.length > 0 ? bidders.join(', ') : 'No bidder specified, using \"ortb2Imp\" definition(s) only'}`);\n\n          // fire BID_REQUESTED event for each s2s bidRequest\n          uniqueServerRequests.forEach(bidRequest => {\n            // add the new sourceTid\n            events.emit(EVENTS.BID_REQUESTED, { ...bidRequest, tid: bidRequest.auctionId });\n          });\n\n          // make bid requests\n          s2sAdapter.callBids(\n            s2sBidRequest,\n            serverBidderRequests,\n            addBidResponse,\n            (timedOut) => doneCbs.forEach(done => done(timedOut)),\n            s2sAjax\n          );\n        }\n      } else {\n        logError('missing ' + s2sConfig.adapter);\n      }\n      counter++;\n    }\n  });\n\n  // handle client adapter requests\n  clientBidderRequests.forEach(bidderRequest => {\n    bidderRequest.start = timestamp();\n    // TODO : Do we check for bid in pool from here and skip calling adapter again ?\n    const adapter = _bidderRegistry[bidderRequest.bidderCode];\n    config.runWithBidder(bidderRequest.bidderCode, () => {\n      logMessage(`CALLING BIDDER`);\n      events.emit(EVENTS.BID_REQUESTED, bidderRequest);\n    });\n    let ajax = ajaxBuilder(requestBidsTimeout, requestCallbacks ? {\n      request: requestCallbacks.request.bind(null, bidderRequest.bidderCode),\n      done: requestCallbacks.done\n    } : undefined);\n    const adapterDone = doneCb.bind(bidderRequest);\n    try {\n      config.runWithBidder(\n        bidderRequest.bidderCode,\n        adapter.callBids.bind(\n          adapter,\n          bidderRequest,\n          addBidResponse,\n          adapterDone,\n          ajax,\n          () => onTimelyResponse(bidderRequest.bidderRequestId),\n          config.callbackWithBidder(bidderRequest.bidderCode)\n        )\n      );\n    } catch (e) {\n      logError(`${bidderRequest.bidderCode} Bid Adapter emitted an uncaught error when parsing their bidRequest`, {e, bidRequest: bidderRequest});\n      adapterDone();\n    }\n  });\n};\n\nfunction getSupportedMediaTypes(bidderCode) {\n  let supportedMediaTypes = [];\n  if (FEATURES.VIDEO && includes(adapterManager.videoAdapters, bidderCode)) supportedMediaTypes.push('video');\n  if (FEATURES.NATIVE && includes(nativeAdapters, bidderCode)) supportedMediaTypes.push('native');\n  return supportedMediaTypes;\n}\n\nadapterManager.videoAdapters = []; // added by adapterLoader for now\n\nadapterManager.registerBidAdapter = function (bidAdapter, bidderCode, {supportedMediaTypes = []} = {}) {\n  if (bidAdapter && bidderCode) {\n    if (typeof bidAdapter.callBids === 'function') {\n      _bidderRegistry[bidderCode] = bidAdapter;\n      GDPR_GVLIDS.register(MODULE_TYPE_BIDDER, bidderCode, bidAdapter.getSpec?.().gvlid);\n\n      if (FEATURES.VIDEO && includes(supportedMediaTypes, 'video')) {\n        adapterManager.videoAdapters.push(bidderCode);\n      }\n      if (FEATURES.NATIVE && includes(supportedMediaTypes, 'native')) {\n        nativeAdapters.push(bidderCode);\n      }\n    } else {\n      logError('Bidder adaptor error for bidder code: ' + bidderCode + 'bidder must implement a callBids() function');\n    }\n  } else {\n    logError('bidAdapter or bidderCode not specified');\n  }\n};\n\nadapterManager.aliasBidAdapter = function (bidderCode, alias, options) {\n  let existingAlias = _bidderRegistry[alias];\n\n  if (typeof existingAlias === 'undefined') {\n    let bidAdapter = _bidderRegistry[bidderCode];\n    if (typeof bidAdapter === 'undefined') {\n      // check if alias is part of s2sConfig and allow them to register if so (as base bidder may be s2s-only)\n      const nonS2SAlias = [];\n      _s2sConfigs.forEach(s2sConfig => {\n        if (s2sConfig.bidders && s2sConfig.bidders.length) {\n          const s2sBidders = s2sConfig && s2sConfig.bidders;\n          if (!(s2sConfig && includes(s2sBidders, alias))) {\n            nonS2SAlias.push(bidderCode);\n          } else {\n            _aliasRegistry[alias] = bidderCode;\n          }\n        }\n      });\n      nonS2SAlias.forEach(bidderCode => {\n        logError('bidderCode \"' + bidderCode + '\" is not an existing bidder.', 'adapterManager.aliasBidAdapter');\n      });\n    } else {\n      try {\n        let newAdapter;\n        let supportedMediaTypes = getSupportedMediaTypes(bidderCode);\n        // Have kept old code to support backward compatibilitiy.\n        // Remove this if loop when all adapters are supporting bidderFactory. i.e When Prebid.js is 1.0\n        if (bidAdapter.constructor.prototype != Object.prototype) {\n          newAdapter = new bidAdapter.constructor();\n          newAdapter.setBidderCode(alias);\n        } else {\n          const { useBaseGvlid = false } = options || {};\n          let spec = bidAdapter.getSpec();\n          const gvlid = useBaseGvlid ? spec.gvlid : options?.gvlid;\n          if (gvlid == null && spec.gvlid != null) {\n            logWarn(`Alias '${alias}' will NOT re-use the GVL ID of the original adapter ('${spec.code}', gvlid: ${spec.gvlid}). Functionality that requires TCF consent may not work as expected.`)\n          }\n\n          let skipPbsAliasing = options && options.skipPbsAliasing;\n          newAdapter = newBidder(Object.assign({}, spec, { code: alias, gvlid, skipPbsAliasing }));\n          _aliasRegistry[alias] = bidderCode;\n        }\n        adapterManager.registerBidAdapter(newAdapter, alias, {\n          supportedMediaTypes\n        });\n      } catch (e) {\n        logError(bidderCode + ' bidder does not currently support aliasing.', 'adapterManager.aliasBidAdapter');\n      }\n    }\n  } else {\n    logMessage('alias name \"' + alias + '\" has been already specified.');\n  }\n};\n\nadapterManager.resolveAlias = function (alias) {\n  let code = alias;\n  let visited;\n  while (_aliasRegistry[code] && (!visited || !visited.has(code))) {\n    code = _aliasRegistry[code];\n    (visited = visited || new Set()).add(code);\n  }\n  return code;\n}\n\nadapterManager.registerAnalyticsAdapter = function ({adapter, code, gvlid}) {\n  if (adapter && code) {\n    if (typeof adapter.enableAnalytics === 'function') {\n      adapter.code = code;\n      _analyticsRegistry[code] = { adapter, gvlid };\n      GDPR_GVLIDS.register(MODULE_TYPE_ANALYTICS, code, gvlid);\n    } else {\n      logError(`Prebid Error: Analytics adaptor error for analytics \"${code}\"\n        analytics adapter must implement an enableAnalytics() function`);\n    }\n  } else {\n    logError('Prebid Error: analyticsAdapter or analyticsCode not specified');\n  }\n};\n\nadapterManager.enableAnalytics = function (config) {\n  if (!isArray(config)) {\n    config = [config];\n  }\n\n  config.forEach(adapterConfig => {\n    const entry = _analyticsRegistry[adapterConfig.provider];\n    if (entry && entry.adapter) {\n      if (dep.isAllowed(ACTIVITY_REPORT_ANALYTICS, activityParams(MODULE_TYPE_ANALYTICS, adapterConfig.provider, {[ACTIVITY_PARAM_ANL_CONFIG]: adapterConfig}))) {\n        entry.adapter.enableAnalytics(adapterConfig);\n      }\n    } else {\n      logError(`Prebid Error: no analytics adapter found in registry for '${adapterConfig.provider}'.`);\n    }\n  });\n}\n\nadapterManager.getBidAdapter = function(bidder) {\n  return _bidderRegistry[bidder];\n};\n\nadapterManager.getAnalyticsAdapter = function(code) {\n  return _analyticsRegistry[code];\n}\n\nfunction getBidderMethod(bidder, method) {\n  const adapter = _bidderRegistry[bidder];\n  const spec = adapter?.getSpec && adapter.getSpec();\n  if (spec && spec[method] && typeof spec[method] === 'function') {\n    return [spec, spec[method]]\n  }\n}\n\nfunction invokeBidderMethod(bidder, method, spec, fn, ...params) {\n  try {\n    logInfo(`Invoking ${bidder}.${method}`);\n    config.runWithBidder(bidder, fn.bind(spec, ...params));\n  } catch (e) {\n    logWarn(`Error calling ${method} of ${bidder}`);\n  }\n}\n\nfunction tryCallBidderMethod(bidder, method, param) {\n  if (param?.source !== S2S.SRC) {\n    const target = getBidderMethod(bidder, method);\n    if (target != null) {\n      invokeBidderMethod(bidder, method, ...target, param);\n    }\n  }\n}\n\nadapterManager.callTimedOutBidders = function(adUnits, timedOutBidders, cbTimeout) {\n  timedOutBidders = timedOutBidders.map((timedOutBidder) => {\n    // Adding user configured params & timeout to timeout event data\n    timedOutBidder.params = getUserConfiguredParams(adUnits, timedOutBidder.adUnitCode, timedOutBidder.bidder);\n    timedOutBidder.timeout = cbTimeout;\n    return timedOutBidder;\n  });\n  timedOutBidders = groupBy(timedOutBidders, 'bidder');\n\n  Object.keys(timedOutBidders).forEach((bidder) => {\n    tryCallBidderMethod(bidder, 'onTimeout', timedOutBidders[bidder]);\n  });\n}\n\nadapterManager.callBidWonBidder = function(bidder, bid, adUnits) {\n  // Adding user configured params to bidWon event data\n  bid.params = getUserConfiguredParams(adUnits, bid.adUnitCode, bid.bidder);\n  incrementBidderWinsCounter(bid.adUnitCode, bid.bidder);\n  tryCallBidderMethod(bidder, 'onBidWon', bid);\n};\n\nadapterManager.triggerBilling = (() => {\n  const BILLED = new WeakSet();\n  return (bid) => {\n    if (!BILLED.has(bid)) {\n      BILLED.add(bid);\n      if (bid.source === S2S.SRC && bid.burl) {\n        internal.triggerPixel(bid.burl);\n      }\n      tryCallBidderMethod(bid.bidder, 'onBidBillable', bid);\n    }\n  }\n})();\n\nadapterManager.callSetTargetingBidder = function(bidder, bid) {\n  tryCallBidderMethod(bidder, 'onSetTargeting', bid);\n};\n\nadapterManager.callBidViewableBidder = function(bidder, bid) {\n  tryCallBidderMethod(bidder, 'onBidViewable', bid);\n};\n\nadapterManager.callBidderError = function(bidder, error, bidderRequest) {\n  const param = { error, bidderRequest };\n  tryCallBidderMethod(bidder, 'onBidderError', param);\n};\n\nadapterManager.callAdRenderSucceededBidder = function (bidder, bid) {\n  tryCallBidderMethod(bidder, 'onAdRenderSucceeded', bid);\n}\n\nfunction resolveAlias(alias) {\n  const seen = new Set();\n  while (_aliasRegistry.hasOwnProperty(alias) && !seen.has(alias)) {\n    seen.add(alias);\n    alias = _aliasRegistry[alias];\n  }\n  return alias;\n}\n/**\n * Ask every adapter to delete PII.\n * See https://github.com/prebid/Prebid.js/issues/9081\n */\nadapterManager.callDataDeletionRequest = hook('sync', function (...args) {\n  const method = 'onDataDeletionRequest';\n  Object.keys(_bidderRegistry)\n    .filter((bidder) => !_aliasRegistry.hasOwnProperty(bidder))\n    .forEach(bidder => {\n      const target = getBidderMethod(bidder, method);\n      if (target != null) {\n        const bidderRequests = auctionManager.getBidsRequested().filter((br) =>\n          resolveAlias(br.bidderCode) === bidder\n        );\n        invokeBidderMethod(bidder, method, ...target, bidderRequests, ...args);\n      }\n    });\n  Object.entries(_analyticsRegistry).forEach(([name, entry]) => {\n    const fn = entry?.adapter?.[method];\n    if (typeof fn === 'function') {\n      try {\n        fn.apply(entry.adapter, args);\n      } catch (e) {\n        logError(`error calling ${method} of ${name}`, e);\n      }\n    }\n  });\n});\n\nexport default adapterManager;\n","import Adapter from '../adapter.js';\nimport adapterManager from '../adapterManager.js';\nimport {config} from '../config.js';\nimport {createBid} from '../bidfactory.js';\nimport {userSync} from '../userSync.js';\nimport {nativeBidIsValid} from '../native.js';\nimport {isValidVideoBid} from '../video.js';\nimport { EVENTS, STATUS, REJECTION_REASON } from '../constants.js';\nimport * as events from '../events.js';\nimport {includes} from '../polyfill.js';\nimport {\n  delayExecution,\n  isArray,\n  isPlainObject,\n  logError,\n  logWarn, memoize,\n  parseQueryStringParameters,\n  parseSizesInput, pick,\n  uniques\n} from '../utils.js';\nimport {hook} from '../hook.js';\nimport {auctionManager} from '../auctionManager.js';\nimport {bidderSettings} from '../bidderSettings.js';\nimport {useMetrics} from '../utils/perfMetrics.js';\nimport {isActivityAllowed} from '../activities/rules.js';\nimport {activityParams} from '../activities/activityParams.js';\nimport {MODULE_TYPE_BIDDER} from '../activities/modules.js';\nimport {ACTIVITY_TRANSMIT_TID, ACTIVITY_TRANSMIT_UFPD} from '../activities/activities.js';\n\n/**\n * @typedef {import('../mediaTypes.js').MediaType} MediaType\n * @typedef {import('../Renderer.js').Renderer} Renderer\n */\n\n/**\n * This file aims to support Adapters during the Prebid 0.x -> 1.x transition.\n *\n * Prebid 1.x and Prebid 0.x will be in separate branches--perhaps for a long time.\n * This function defines an API for adapter construction which is compatible with both versions.\n * Adapters which use it can maintain their code in master, and only this file will need to change\n * in the 1.x branch.\n *\n * Typical usage looks something like:\n *\n * const adapter = registerBidder({\n *   code: 'myBidderCode',\n *   aliases: ['alias1', 'alias2'],\n *   supportedMediaTypes: ['video', 'native'],\n *   isBidRequestValid: function(paramsObject) { return true/false },\n *   buildRequests: function(bidRequests, bidderRequest) { return some ServerRequest(s) },\n *   interpretResponse: function(oneServerResponse) { return some Bids, or throw an error. }\n * });\n *\n * @see BidderSpec for the full API and more thorough descriptions.\n *\n */\n\n/**\n * @typedef {object} BidderSpec An object containing the adapter-specific functions needed to\n * make a Bidder.\n *\n * @property {string} code A code which will be used to uniquely identify this bidder. This should be the same\n *   one as is used in the call to registerBidAdapter\n * @property {string[]} [aliases] A list of aliases which should also resolve to this bidder.\n * @property {MediaType[]} [supportedMediaTypes] A list of Media Types which the adapter supports.\n * @property {function(object): boolean} isBidRequestValid Determines whether or not the given bid has all the params\n *   needed to make a valid request.\n * @property {function(BidRequest[], bidderRequest): ServerRequest|ServerRequest[]} buildRequests Build the request to the Server\n *   which requests Bids for the given array of Requests. Each BidRequest in the argument array is guaranteed to have\n *   passed the isBidRequestValid() test.\n * @property {function(ServerResponse, BidRequest): Bid[]} interpretResponse Given a successful response from the Server,\n *   interpret it and return the Bid objects. This function will be run inside a try/catch.\n *   If it throws any errors, your bids will be discarded.\n * @property {function(SyncOptions, ServerResponse[]): UserSync[]} [getUserSyncs] Given an array of all the responses\n *   from the server, determine which user syncs should occur. The argument array will contain every element\n *   which has been sent through to interpretResponse. The order of syncs in this array matters. The most\n *   important ones should come first, since publishers may limit how many are dropped on their page.\n * @property {function(object): object} transformBidParams Updates bid params before creating bid request\n }}\n */\n\n/**\n * @typedef {object} BidRequest\n *\n * @property {string} bidId A string which uniquely identifies this BidRequest in the current Auction.\n * @property {object} params Any bidder-specific params which the publisher used in their bid request.\n */\n\n/**\n * @typedef {object} BidderAuctionResponse An object encapsulating an adapter response for current Auction\n *\n * @property {Array<Bid>} bids? Contextual bids returned by this adapter, if any\n * @property {Array<{bidId: String, config: {}}>} paapiAuctionConfigs? Array of paapi auction configs, each scoped to a particular bidId\n */\n\n/**\n * @typedef {object} ServerRequest\n *\n * @property {('GET'|'POST')} method The type of request which this is.\n * @property {string} url The endpoint for the request. For example, \"//bids.example.com\".\n * @property {string|object} data Data to be sent in the request.\n * @property {object} options Content-Type set in the header of the bid request, overrides default 'text/plain'.\n *   If this is a GET request, they'll become query params. If it's a POST request, they'll be added to the body.\n *   Strings will be added as-is. Objects will be unpacked into query params based on key/value mappings, or\n *   JSON-serialized into the Request body.\n */\n\n/**\n * @typedef {object} ServerResponse\n *\n * @property {*} body The response body. If this is legal JSON, then it will be parsed. Otherwise it'll be a\n *   string with the body's content.\n * @property {{get: function(string): string}} headers The response headers.\n *   Call this like `ServerResponse.headers.get(\"Content-Type\")`\n */\n\n/**\n * @typedef {object} Bid\n *\n * @property {string} requestId The specific BidRequest which this bid is aimed at.\n *   This should match the BidRequest.bidId which this Bid targets.\n * @property {string} ad A URL which can be used to load this ad, if it's chosen by the publisher.\n * @property {string} currency The currency code for the cpm value\n * @property {number} cpm The bid price, in US cents per thousand impressions.\n * @property {number} ttl Time-to-live - how long (in seconds) Prebid can use this bid.\n * @property {boolean} netRevenue Boolean defining whether the bid is Net or Gross.  The default is true (Net).\n * @property {number} height The height of the ad, in pixels.\n * @property {number} width The width of the ad, in pixels.\n *\n * @property {object} [native] Object for storing native creative assets\n * @property {object} [video] Object for storing video response data\n * @property {object} [meta] Object for storing bid meta data\n * @property {string} [meta.primaryCatId] The IAB primary category ID\n * @property {Renderer} renderer A Renderer which can be used as a default for this bid,\n *   if the publisher doesn't override it. This is only relevant for Outstream Video bids.\n */\n\n/**\n * @typedef {Object} SyncOptions\n *\n * An object containing information about usersyncs which the adapter should obey.\n *\n * @property {boolean} iframeEnabled True if iframe usersyncs are allowed, and false otherwise\n * @property {boolean} pixelEnabled True if image usersyncs are allowed, and false otherwise\n */\n\n/**\n * TODO: Move this to the UserSync module after that PR is merged.\n *\n * @typedef {object} UserSync\n *\n * @property {('image'|'iframe')} type The type of user sync to be done.\n * @property {string} url The URL which makes the sync happen.\n */\n\n// common params for all mediaTypes\nconst COMMON_BID_RESPONSE_KEYS = ['cpm', 'ttl', 'creativeId', 'netRevenue', 'currency'];\nconst TIDS = ['auctionId', 'transactionId'];\n\n/**\n * Register a bidder with prebid, using the given spec.\n *\n * If possible, Adapter modules should use this function instead of adapterManager.registerBidAdapter().\n *\n * @param {BidderSpec} spec An object containing the bare-bones functions we need to make a Bidder.\n */\nexport function registerBidder(spec) {\n  const mediaTypes = Array.isArray(spec.supportedMediaTypes)\n    ? { supportedMediaTypes: spec.supportedMediaTypes }\n    : undefined;\n  function putBidder(spec) {\n    const bidder = newBidder(spec);\n    adapterManager.registerBidAdapter(bidder, spec.code, mediaTypes);\n  }\n\n  putBidder(spec);\n  if (Array.isArray(spec.aliases)) {\n    spec.aliases.forEach(alias => {\n      let aliasCode = alias;\n      let gvlid;\n      let skipPbsAliasing;\n      if (isPlainObject(alias)) {\n        aliasCode = alias.code;\n        gvlid = alias.gvlid;\n        skipPbsAliasing = alias.skipPbsAliasing\n      }\n      adapterManager.aliasRegistry[aliasCode] = spec.code;\n      putBidder(Object.assign({}, spec, { code: aliasCode, gvlid, skipPbsAliasing }));\n    });\n  }\n}\n\nexport const guardTids = memoize(({bidderCode}) => {\n  if (isActivityAllowed(ACTIVITY_TRANSMIT_TID, activityParams(MODULE_TYPE_BIDDER, bidderCode))) {\n    return {\n      bidRequest: (br) => br,\n      bidderRequest: (br) => br\n    };\n  }\n  function get(target, prop, receiver) {\n    if (TIDS.includes(prop)) {\n      return null;\n    }\n    return Reflect.get(target, prop, receiver);\n  }\n  function privateAccessProxy(target, handler) {\n    const proxy = new Proxy(target, handler);\n    // always allow methods (such as getFloor) private access to TIDs\n    Object.entries(target)\n      .filter(([_, v]) => typeof v === 'function')\n      .forEach(([prop, fn]) => proxy[prop] = fn.bind(target));\n    return proxy;\n  }\n  const bidRequest = memoize((br) => privateAccessProxy(br, {get}), (arg) => arg.bidId);\n  /**\n   * Return a view on bidd(er) requests where auctionId/transactionId are nulled if the bidder is not allowed `transmitTid`.\n   *\n   * Because both auctionId and transactionId are used for Prebid's own internal bookkeeping, we cannot simply erase them\n   * from request objects; and because request objects are quite complex and not easily cloneable, we hide the IDs\n   * with a proxy instead. This should be used only around the adapter logic.\n   */\n  return {\n    bidRequest,\n    bidderRequest: (br) => privateAccessProxy(br, {\n      get(target, prop, receiver) {\n        if (prop === 'bids') return br.bids.map(bidRequest);\n        return get(target, prop, receiver);\n      }\n    })\n  }\n});\n\n/**\n * Make a new bidder from the given spec. This is exported mainly for testing.\n * Adapters will probably find it more convenient to use registerBidder instead.\n *\n * @param {BidderSpec} spec\n */\nexport function newBidder(spec) {\n  return Object.assign(new Adapter(spec.code), {\n    getSpec: function() {\n      return Object.freeze(Object.assign({}, spec));\n    },\n    registerSyncs,\n    callBids: function(bidderRequest, addBidResponse, done, ajax, onTimelyResponse, configEnabledCallback) {\n      if (!Array.isArray(bidderRequest.bids)) {\n        return;\n      }\n      const tidGuard = guardTids(bidderRequest);\n\n      const adUnitCodesHandled = {};\n      function addBidWithCode(adUnitCode, bid) {\n        const metrics = useMetrics(bid.metrics);\n        metrics.checkpoint('addBidResponse');\n        adUnitCodesHandled[adUnitCode] = true;\n        if (metrics.measureTime('addBidResponse.validate', () => isValid(adUnitCode, bid))) {\n          addBidResponse(adUnitCode, bid);\n        } else {\n          addBidResponse.reject(adUnitCode, bid, REJECTION_REASON.INVALID)\n        }\n      }\n\n      // After all the responses have come back, call done() and\n      // register any required usersync pixels.\n      const responses = [];\n      function afterAllResponses() {\n        done();\n        config.runWithBidder(spec.code, () => {\n          events.emit(EVENTS.BIDDER_DONE, bidderRequest);\n          registerSyncs(responses, bidderRequest.gdprConsent, bidderRequest.uspConsent, bidderRequest.gppConsent);\n        });\n      }\n\n      const validBidRequests = adapterMetrics(bidderRequest)\n        .measureTime('validate', () => bidderRequest.bids.filter((br) => filterAndWarn(tidGuard.bidRequest(br))));\n\n      if (validBidRequests.length === 0) {\n        afterAllResponses();\n        return;\n      }\n      const bidRequestMap = {};\n      validBidRequests.forEach(bid => {\n        bidRequestMap[bid.bidId] = bid;\n        // Delete this once we are 1.0\n        if (!bid.adUnitCode) {\n          bid.adUnitCode = bid.placementCode\n        }\n      });\n\n      processBidderRequests(spec, validBidRequests, bidderRequest, ajax, configEnabledCallback, {\n        onRequest: requestObject => events.emit(EVENTS.BEFORE_BIDDER_HTTP, bidderRequest, requestObject),\n        onResponse: (resp) => {\n          onTimelyResponse(spec.code);\n          responses.push(resp)\n        },\n        onPaapi: (paapiConfig) => {\n          const bidRequest = bidRequestMap[paapiConfig.bidId];\n          if (bidRequest) {\n            addPaapiConfig(bidRequest, paapiConfig);\n          } else {\n            logWarn('Received fledge auction configuration for an unknown bidId', paapiConfig);\n          }\n        },\n        // If the server responds with an error, there's not much we can do beside logging.\n        onError: (errorMessage, error) => {\n          if (!error.timedOut) {\n            onTimelyResponse(spec.code);\n          }\n          adapterManager.callBidderError(spec.code, error, bidderRequest)\n          events.emit(EVENTS.BIDDER_ERROR, { error, bidderRequest });\n          logError(`Server call for ${spec.code} failed: ${errorMessage} ${error.status}. Continuing without bids.`);\n        },\n        onBid: (bid) => {\n          const bidRequest = bidRequestMap[bid.requestId];\n          if (bidRequest) {\n            bid.adapterCode = bidRequest.bidder;\n            if (isInvalidAlternateBidder(bid.bidderCode, bidRequest.bidder)) {\n              logWarn(`${bid.bidderCode} is not a registered partner or known bidder of ${bidRequest.bidder}, hence continuing without bid. If you wish to support this bidder, please mark allowAlternateBidderCodes as true in bidderSettings.`);\n              addBidResponse.reject(bidRequest.adUnitCode, bid, REJECTION_REASON.BIDDER_DISALLOWED)\n              return;\n            }\n            // creating a copy of original values as cpm and currency are modified later\n            bid.originalCpm = bid.cpm;\n            bid.originalCurrency = bid.currency;\n            bid.meta = bid.meta || Object.assign({}, bid[bidRequest.bidder]);\n            bid.deferBilling = bidRequest.deferBilling;\n            bid.deferRendering = bid.deferBilling && (bid.deferRendering ?? typeof spec.onBidBillable !== 'function');\n            const prebidBid = Object.assign(createBid(STATUS.GOOD, bidRequest), bid, pick(bidRequest, TIDS));\n            addBidWithCode(bidRequest.adUnitCode, prebidBid);\n          } else {\n            logWarn(`Bidder ${spec.code} made bid for unknown request ID: ${bid.requestId}. Ignoring.`);\n            addBidResponse.reject(null, bid, REJECTION_REASON.INVALID_REQUEST_ID);\n          }\n        },\n        onCompletion: afterAllResponses,\n      });\n    }\n  });\n\n  function isInvalidAlternateBidder(responseBidder, requestBidder) {\n    let allowAlternateBidderCodes = bidderSettings.get(requestBidder, 'allowAlternateBidderCodes') || false;\n    let alternateBiddersList = bidderSettings.get(requestBidder, 'allowedAlternateBidderCodes');\n    if (!!responseBidder && !!requestBidder && requestBidder !== responseBidder) {\n      alternateBiddersList = isArray(alternateBiddersList) ? alternateBiddersList.map(val => val.trim().toLowerCase()).filter(val => !!val).filter(uniques) : alternateBiddersList;\n      if (!allowAlternateBidderCodes || (isArray(alternateBiddersList) && (alternateBiddersList[0] !== '*' && !alternateBiddersList.includes(responseBidder)))) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function registerSyncs(responses, gdprConsent, uspConsent, gppConsent) {\n    registerSyncInner(spec, responses, gdprConsent, uspConsent, gppConsent);\n  }\n\n  function filterAndWarn(bid) {\n    if (!spec.isBidRequestValid(bid)) {\n      logWarn(`Invalid bid sent to bidder ${spec.code}: ${JSON.stringify(bid)}`);\n      return false;\n    }\n    return true;\n  }\n}\n\nconst RESPONSE_PROPS = ['bids', 'paapi']\n\n/**\n * Run a set of bid requests - that entails converting them to HTTP requests, sending\n * them over the network, and parsing the responses.\n *\n * @param spec bid adapter spec\n * @param bids bid requests to run\n * @param bidderRequest the bid request object that `bids` is connected to\n * @param ajax ajax method to use\n * @param wrapCallback {function(callback)} a function used to wrap every callback (for the purpose of `config.currentBidder`)\n * @param onRequest {function({})} invoked once for each HTTP request built by the adapter - with the raw request\n * @param onResponse {function({})} invoked once on each successful HTTP response - with the raw response\n * @param onError {function(String, {})} invoked once for each HTTP error - with status code and response\n * @param onBid {function({})} invoked once for each bid in the response - with the bid as returned by interpretResponse\n * @param onCompletion {function()} invoked once when all bid requests have been processed\n */\nexport const processBidderRequests = hook('sync', function (spec, bids, bidderRequest, ajax, wrapCallback, {onRequest, onResponse, onPaapi, onError, onBid, onCompletion}) {\n  const metrics = adapterMetrics(bidderRequest);\n  onCompletion = metrics.startTiming('total').stopBefore(onCompletion);\n  const tidGuard = guardTids(bidderRequest);\n  let requests = metrics.measureTime('buildRequests', () => spec.buildRequests(bids.map(tidGuard.bidRequest), tidGuard.bidderRequest(bidderRequest)));\n\n  if (!requests || requests.length === 0) {\n    onCompletion();\n    return;\n  }\n  if (!Array.isArray(requests)) {\n    requests = [requests];\n  }\n\n  const requestDone = delayExecution(onCompletion, requests.length);\n\n  requests.forEach((request) => {\n    const requestMetrics = metrics.fork();\n    function addBid(bid) {\n      if (bid != null) bid.metrics = requestMetrics.fork().renameWith();\n      onBid(bid);\n    }\n    // If the server responds successfully, use the adapter code to unpack the Bids from it.\n    // If the adapter code fails, no bids should be added. After all the bids have been added,\n    // make sure to call the `requestDone` function so that we're one step closer to calling onCompletion().\n    const onSuccess = wrapCallback(function(response, responseObj) {\n      networkDone();\n      try {\n        response = JSON.parse(response);\n      } catch (e) { /* response might not be JSON... that's ok. */ }\n\n      // Make response headers available for #1742. These are lazy-loaded because most adapters won't need them.\n      response = {\n        body: response,\n        headers: headerParser(responseObj)\n      };\n      onResponse(response);\n\n      try {\n        response = requestMetrics.measureTime('interpretResponse', () => spec.interpretResponse(response, request));\n      } catch (err) {\n        logError(`Bidder ${spec.code} failed to interpret the server's response. Continuing without bids`, null, err);\n        requestDone();\n        return;\n      }\n\n      // adapters can reply with:\n      // a single bid\n      // an array of bids\n      // a BidderAuctionResponse object\n\n      let bids, paapiConfigs;\n      if (response && !Object.keys(response).some(key => !RESPONSE_PROPS.includes(key))) {\n        bids = response.bids;\n        paapiConfigs = response.paapi;\n      } else {\n        bids = response;\n      }\n      if (isArray(paapiConfigs)) {\n        paapiConfigs.forEach(onPaapi);\n      }\n      if (bids) {\n        if (isArray(bids)) {\n          bids.forEach(addBid);\n        } else {\n          addBid(bids);\n        }\n      }\n      requestDone();\n\n      function headerParser(xmlHttpResponse) {\n        return {\n          get: responseObj.getResponseHeader.bind(responseObj)\n        };\n      }\n    });\n\n    const onFailure = wrapCallback(function (errorMessage, error) {\n      networkDone();\n      onError(errorMessage, error);\n      requestDone();\n    });\n\n    onRequest(request);\n\n    const networkDone = requestMetrics.startTiming('net');\n\n    function getOptions(defaults) {\n      const ro = request.options;\n      return Object.assign(defaults, ro, {\n        browsingTopics: ro?.hasOwnProperty('browsingTopics') && !ro.browsingTopics\n          ? false\n          : (bidderSettings.get(spec.code, 'topicsHeader') ?? true) && isActivityAllowed(ACTIVITY_TRANSMIT_UFPD, activityParams(MODULE_TYPE_BIDDER, spec.code))\n      })\n    }\n    switch (request.method) {\n      case 'GET':\n        ajax(\n          `${request.url}${formatGetParameters(request.data)}`,\n          {\n            success: onSuccess,\n            error: onFailure\n          },\n          undefined,\n          getOptions({\n            method: 'GET',\n            withCredentials: true\n          })\n        );\n        break;\n      case 'POST':\n        ajax(\n          request.url,\n          {\n            success: onSuccess,\n            error: onFailure\n          },\n          typeof request.data === 'string' ? request.data : JSON.stringify(request.data),\n          getOptions({\n            method: 'POST',\n            contentType: 'text/plain',\n            withCredentials: true\n          })\n        );\n        break;\n      default:\n        logWarn(`Skipping invalid request from ${spec.code}. Request type ${request.type} must be GET or POST`);\n        requestDone();\n    }\n\n    function formatGetParameters(data) {\n      if (data) {\n        return `?${typeof data === 'object' ? parseQueryStringParameters(data) : data}`;\n      }\n\n      return '';\n    }\n  })\n}, 'processBidderRequests')\n\nexport const registerSyncInner = hook('async', function(spec, responses, gdprConsent, uspConsent, gppConsent) {\n  const aliasSyncEnabled = config.getConfig('userSync.aliasSyncEnabled');\n  if (spec.getUserSyncs && (aliasSyncEnabled || !adapterManager.aliasRegistry[spec.code])) {\n    let filterConfig = config.getConfig('userSync.filterSettings');\n    let syncs = spec.getUserSyncs({\n      iframeEnabled: !!(filterConfig && (filterConfig.iframe || filterConfig.all)),\n      pixelEnabled: !!(filterConfig && (filterConfig.image || filterConfig.all)),\n    }, responses, gdprConsent, uspConsent, gppConsent);\n    if (syncs) {\n      if (!Array.isArray(syncs)) {\n        syncs = [syncs];\n      }\n      syncs.forEach((sync) => {\n        userSync.registerSync(sync.type, spec.code, sync.url)\n      });\n      userSync.bidderDone(spec.code);\n    }\n  }\n}, 'registerSyncs')\n\nexport const addPaapiConfig = hook('sync', (request, paapiConfig) => {\n}, 'addPaapiConfig');\n\n// check that the bid has a width and height set\nfunction validBidSize(adUnitCode, bid, {index = auctionManager.index} = {}) {\n  if ((bid.width || parseInt(bid.width, 10) === 0) && (bid.height || parseInt(bid.height, 10) === 0)) {\n    bid.width = parseInt(bid.width, 10);\n    bid.height = parseInt(bid.height, 10);\n    return true;\n  }\n\n  const bidRequest = index.getBidRequest(bid);\n  const mediaTypes = index.getMediaTypes(bid);\n\n  const sizes = (bidRequest && bidRequest.sizes) || (mediaTypes && mediaTypes.banner && mediaTypes.banner.sizes);\n  const parsedSizes = parseSizesInput(sizes);\n\n  // if a banner impression has one valid size, we assign that size to any bid\n  // response that does not explicitly set width or height\n  if (parsedSizes.length === 1) {\n    const [ width, height ] = parsedSizes[0].split('x');\n    bid.width = parseInt(width, 10);\n    bid.height = parseInt(height, 10);\n    return true;\n  }\n\n  return false;\n}\n\n// Validate the arguments sent to us by the adapter. If this returns false, the bid should be totally ignored.\nexport function isValid(adUnitCode, bid, {index = auctionManager.index} = {}) {\n  function hasValidKeys() {\n    let bidKeys = Object.keys(bid);\n    return COMMON_BID_RESPONSE_KEYS.every(key => includes(bidKeys, key) && !includes([undefined, null], bid[key]));\n  }\n\n  function errorMessage(msg) {\n    return `Invalid bid from ${bid.bidderCode}. Ignoring bid: ${msg}`;\n  }\n\n  if (!adUnitCode) {\n    logWarn('No adUnitCode was supplied to addBidResponse.');\n    return false;\n  }\n\n  if (!bid) {\n    logWarn(`Some adapter tried to add an undefined bid for ${adUnitCode}.`);\n    return false;\n  }\n\n  if (!hasValidKeys()) {\n    logError(errorMessage(`Bidder ${bid.bidderCode} is missing required params. Check http://prebid.org/dev-docs/bidder-adapter-1.html for list of params.`));\n    return false;\n  }\n\n  if (FEATURES.NATIVE && bid.mediaType === 'native' && !nativeBidIsValid(bid, {index})) {\n    logError(errorMessage('Native bid missing some required properties.'));\n    return false;\n  }\n  if (FEATURES.VIDEO && bid.mediaType === 'video' && !isValidVideoBid(bid, {index})) {\n    logError(errorMessage(`Video bid does not have required vastUrl or renderer property`));\n    return false;\n  }\n  if (bid.mediaType === 'banner' && !validBidSize(adUnitCode, bid, {index})) {\n    logError(errorMessage(`Banner bids require a width and height`));\n    return false;\n  }\n\n  return true;\n}\n\nexport function adapterMetrics(bidderRequest) {\n  return useMetrics(bidderRequest.metrics).renameWith(n => [`adapter.client.${n}`, `adapters.client.${bidderRequest.bidderCode}.${n}`])\n}\n","import { LOAD_EXTERNAL_SCRIPT } from './activities/activities.js';\nimport { activityParams } from './activities/activityParams.js';\nimport { isActivityAllowed } from './activities/rules.js';\nimport { includes } from './polyfill.js';\nimport { insertElement, logError, logWarn, setScriptAttributes } from './utils.js';\n\nconst _requestCache = new WeakMap();\n// The below list contains modules or vendors whom Prebid allows to load external JS.\nconst _approvedLoadExternalJSList = [\n  // Prebid maintained modules:\n  'debugging',\n  'outstream',\n  // Bid Modules - only exception is on rendering edge cases, to clean up in Prebid 10:\n  'improvedigital',\n  'showheroes-bs',\n  // RTD modules:\n  'aaxBlockmeter',\n  'adagio',\n  'adloox',\n  'akamaidap',\n  'arcspan',\n  'airgrid',\n  'browsi',\n  'brandmetrics',\n  'clean.io',\n  'humansecurity',\n  'confiant',\n  'contxtful',\n  'hadron',\n  'mediafilter',\n  'medianet',\n  'azerionedge',\n  'a1Media',\n  'geoedge',\n  'qortex',\n  'dynamicAdBoost',\n  '51Degrees',\n  'symitridap',\n  'wurfl',\n  // UserId Submodules\n  'justtag',\n  'tncId',\n  'ftrackId',\n  'id5',\n];\n\n/**\n * Loads external javascript. Can only be used if external JS is approved by Prebid. See https://github.com/prebid/prebid-js-external-js-template#policy\n * Each unique URL will be loaded at most 1 time.\n * @param {string} url the url to load\n * @param {string} moduleType moduleType of the module requesting this resource\n * @param {string} moduleCode bidderCode or module code of the module requesting this resource\n * @param {function} [callback] callback function to be called after the script is loaded\n * @param {Document} [doc] the context document, in which the script will be loaded, defaults to loaded document\n * @param {object} attributes an object of attributes to be added to the script with setAttribute by [key] and [value]; Only the attributes passed in the first request of a url will be added.\n */\nexport function loadExternalScript(url, moduleType, moduleCode, callback, doc, attributes) {\n  if (!isActivityAllowed(LOAD_EXTERNAL_SCRIPT, activityParams(moduleType, moduleCode))) {\n    return;\n  }\n\n  if (!moduleCode || !url) {\n    logError('cannot load external script without url and moduleCode');\n    return;\n  }\n  if (!includes(_approvedLoadExternalJSList, moduleCode)) {\n    logError(`${moduleCode} not whitelisted for loading external JavaScript`);\n    return;\n  }\n  if (!doc) {\n    doc = document; // provide a \"valid\" key for the WeakMap\n  }\n  // only load each asset once\n  const storedCachedObject = getCacheObject(doc, url);\n  if (storedCachedObject) {\n    if (callback && typeof callback === 'function') {\n      if (storedCachedObject.loaded) {\n        // invokeCallbacks immediately\n        callback();\n      } else {\n        // queue the callback\n        storedCachedObject.callbacks.push(callback);\n      }\n    }\n    return storedCachedObject.tag;\n  }\n  const cachedDocObj = _requestCache.get(doc) || {};\n  const cacheObject = {\n    loaded: false,\n    tag: null,\n    callbacks: []\n  };\n  cachedDocObj[url] = cacheObject;\n  _requestCache.set(doc, cachedDocObj);\n\n  if (callback && typeof callback === 'function') {\n    cacheObject.callbacks.push(callback);\n  }\n\n  logWarn(`module ${moduleCode} is loading external JavaScript`);\n  return requestResource(url, function () {\n    cacheObject.loaded = true;\n    try {\n      for (let i = 0; i < cacheObject.callbacks.length; i++) {\n        cacheObject.callbacks[i]();\n      }\n    } catch (e) {\n      logError('Error executing callback', 'adloader.js:loadExternalScript', e);\n    }\n  }, doc, attributes);\n\n  function requestResource(tagSrc, callback, doc, attributes) {\n    if (!doc) {\n      doc = document;\n    }\n    var jptScript = doc.createElement('script');\n    jptScript.type = 'text/javascript';\n    jptScript.async = true;\n\n    const cacheObject = getCacheObject(doc, url);\n    if (cacheObject) {\n      cacheObject.tag = jptScript;\n    }\n\n    if (jptScript.readyState) {\n      jptScript.onreadystatechange = function () {\n        if (jptScript.readyState === 'loaded' || jptScript.readyState === 'complete') {\n          jptScript.onreadystatechange = null;\n          callback();\n        }\n      };\n    } else {\n      jptScript.onload = function () {\n        callback();\n      };\n    }\n\n    jptScript.src = tagSrc;\n\n    if (attributes) {\n      setScriptAttributes(jptScript, attributes);\n    }\n\n    // add the new script tag to the page\n    insertElement(jptScript, doc);\n\n    return jptScript;\n  }\n  function getCacheObject(doc, url) {\n    const cachedDocObj = _requestCache.get(doc);\n    if (cachedDocObj && cachedDocObj[url]) {\n      return cachedDocObj[url];\n    }\n    return null; // return new cache object?\n  }\n};\n","import {config} from './config.js';\nimport {buildUrl, logError, parseUrl} from './utils.js';\n\nexport const dep = {\n  fetch: window.fetch.bind(window),\n  makeRequest: (r, o) => new Request(r, o),\n  timeout(timeout, resource) {\n    const ctl = new AbortController();\n    let cancelTimer = setTimeout(() => {\n      ctl.abort();\n      logError(`Request timeout after ${timeout}ms`, resource);\n      cancelTimer = null;\n    }, timeout);\n    return {\n      signal: ctl.signal,\n      done() {\n        cancelTimer && clearTimeout(cancelTimer)\n      }\n    }\n  }\n}\n\nconst GET = 'GET';\nconst POST = 'POST';\nconst CTYPE = 'Content-Type';\n\n/**\n * transform legacy `ajax` parameters into a fetch request.\n * @returns {Request}\n */\nexport function toFetchRequest(url, data, options = {}) {\n  const method = options.method || (data ? POST : GET);\n  if (method === GET && data) {\n    const urlInfo = parseUrl(url, options);\n    Object.assign(urlInfo.search, data);\n    url = buildUrl(urlInfo);\n  }\n  const headers = new Headers(options.customHeaders);\n  headers.set(CTYPE, options.contentType || 'text/plain');\n  const rqOpts = {\n    method,\n    headers\n  }\n  if (method !== GET && data) {\n    rqOpts.body = data;\n  }\n  if (options.withCredentials) {\n    rqOpts.credentials = 'include';\n  }\n  if (isSecureContext) {\n    ['browsingTopics', 'adAuctionHeaders'].forEach(opt => {\n      // the Request constructor will throw an exception if the browser supports topics/fledge\n      // but we're not in a secure context\n      if (options[opt]) {\n        rqOpts[opt] = true;\n      }\n    })\n  }\n  if (options.keepalive) {\n    rqOpts.keepalive = true;\n  }\n  return dep.makeRequest(url, rqOpts);\n}\n\n/**\n * Return a version of `fetch` that automatically cancels requests after `timeout` milliseconds.\n *\n * If provided, `request` and `done` should be functions accepting a single argument.\n * `request` is invoked at the beginning of each request, and `done` at the end; both are passed its origin.\n *\n * @returns {function(*, {}?): Promise<Response>}\n */\nexport function fetcherFactory(timeout = 3000, {request, done} = {}) {\n  let fetcher = (resource, options) => {\n    let to;\n    if (timeout != null && options?.signal == null && !config.getConfig('disableAjaxTimeout')) {\n      to = dep.timeout(timeout, resource);\n      options = Object.assign({signal: to.signal}, options);\n    }\n    let pm = dep.fetch(resource, options);\n    if (to?.done != null) pm = pm.finally(to.done);\n    return pm;\n  };\n\n  if (request != null || done != null) {\n    fetcher = ((fetch) => function (resource, options) {\n      const origin = new URL(resource?.url == null ? resource : resource.url, document.location).origin;\n      let req = fetch(resource, options);\n      request && request(origin);\n      if (done) req = req.finally(() => done(origin));\n      return req;\n    })(fetcher);\n  }\n  return fetcher;\n}\n\nfunction toXHR({status, statusText = '', headers, url}, responseText) {\n  let xml = 0;\n  function getXML(onError) {\n    if (xml === 0) {\n      try {\n        xml = new DOMParser().parseFromString(responseText, headers?.get(CTYPE)?.split(';')?.[0])\n      } catch (e) {\n        xml = null;\n        onError && onError(e)\n      }\n    }\n    return xml;\n  }\n  return {\n    // eslint-disable-next-line prebid/no-global\n    readyState: XMLHttpRequest.DONE,\n    status,\n    statusText,\n    responseText,\n    response: responseText,\n    responseType: '',\n    responseURL: url,\n    get responseXML() {\n      return getXML(logError);\n    },\n    getResponseHeader: (header) => headers?.has(header) ? headers.get(header) : null,\n    toJSON() {\n      return Object.assign({responseXML: getXML()}, this)\n    },\n    timedOut: false\n  }\n}\n\n/**\n * attach legacy `ajax` callbacks to a fetch promise.\n */\nexport function attachCallbacks(fetchPm, callback) {\n  const {success, error} = typeof callback === 'object' && callback != null ? callback : {\n    success: typeof callback === 'function' ? callback : () => null,\n    error: (e, x) => logError('Network error', e, x)\n  };\n  return fetchPm.then(response => response.text().then((responseText) => [response, responseText]))\n    .then(([response, responseText]) => {\n      const xhr = toXHR(response, responseText);\n      response.ok || response.status === 304 ? success(responseText, xhr) : error(response.statusText, xhr);\n    }, (reason) => error('', Object.assign(\n      toXHR({status: 0}, ''),\n      {reason, timedOut: reason?.name === 'AbortError'}))\n    );\n}\n\nexport function ajaxBuilder(timeout = 3000, {request, done} = {}) {\n  const fetcher = fetcherFactory(timeout, {request, done});\n  return function (url, callback, data, options = {}) {\n    attachCallbacks(fetcher(toFetchRequest(url, data, options)), callback);\n  };\n}\n\n/**\n * simple wrapper around sendBeacon such that invocations of navigator.sendBeacon can be centrally maintained.\n * verifies that the navigator and sendBeacon are defined for maximum compatibility\n * @param {string} url The URL that will receive the data. Can be relative or absolute.\n * @param {*} data An ArrayBuffer, a TypedArray, a DataView, a Blob, a string literal or object, a FormData or a URLSearchParams object containing the data to send.\n * @returns {boolean} true if the user agent successfully queued the data for transfer. Otherwise, it returns false.\n */\nexport function sendBeacon(url, data) {\n  if (!window.navigator || !window.navigator.sendBeacon) {\n    return false;\n  }\n  return window.navigator.sendBeacon(url, data);\n}\n\nexport const ajax = ajaxBuilder();\nexport const fetch = fetcherFactory();\n","/**\n * Module for auction instances.\n *\n * In Prebid 0.x, $$PREBID_GLOBAL$$ had _bidsRequested and _bidsReceived as public properties.\n * Starting 1.0, Prebid will support concurrent auctions. Each auction instance will store private properties, bidsRequested and bidsReceived.\n *\n * AuctionManager will create an instance of auction and will store all the auctions.\n *\n */\n\n/**\n * @typedef {import('../src/adapters/bidderFactory.js').BidRequest} BidRequest\n * @typedef {import('../src/adapters/bidderFactory.js').Bid} Bid\n * @typedef {import('../src/config.js').MediaTypePriceGranularity} MediaTypePriceGranularity\n * @typedef {import('../src/mediaTypes.js').MediaType} MediaType\n */\n\n/**\n * @typedef {Object} AdUnit An object containing the adUnit configuration.\n *\n * @property {string} code A code which will be used to uniquely identify this bidder. This should be the same\n *   one as is used in the call to registerBidAdapter\n * @property {Array.<size>} sizes A list of size for adUnit.\n * @property {object} params Any bidder-specific params which the publisher used in their bid request.\n *   This is guaranteed to have passed the spec.areParamsValid() test.\n */\n\n/**\n * @typedef {Array.<number>} size\n */\n\n/**\n * @typedef {Array.<string>} AdUnitCode\n */\n\n/**\n * @typedef {Object} BidderRequest\n *\n * @property {string} bidderCode - adUnit bidder\n * @property {number} auctionId - random UUID\n * @property {string} bidderRequestId - random string, unique key set on all bidRequest.bids[]\n * @property {Array.<Bid>} bids\n * @property {number} auctionStart - Date.now() at auction start\n * @property {number} timeout - callback timeout\n * @property {refererInfo} refererInfo - referer info object\n * @property {string} [tid] - random UUID (used for s2s)\n * @property {string} [src] - s2s or client (used for s2s)\n * @property {import('./types/ortb2.js').Ortb2.BidRequest} [ortb2] Global (not specific to any adUnit) first party data to use for all requests in this auction.\n */\n\n/**\n * @typedef {Object} BidReceived\n * //TODO add all properties\n */\n\n/**\n * @typedef {Object} Auction\n *\n * @property {function(): string} getAuctionStatus - returns the auction status which can be any one of 'started', 'in progress' or 'completed'\n * @property {function(): AdUnit[]} getAdUnits - return the adUnits for this auction instance\n * @property {function(): AdUnitCode[]} getAdUnitCodes - return the adUnitCodes for this auction instance\n * @property {function(): BidRequest[]} getBidRequests - get all bid requests for this auction instance\n * @property {function(): BidReceived[]} getBidsReceived - get all bid received for this auction instance\n * @property {function(): void} startAuctionTimer - sets the bidsBackHandler callback and starts the timer for auction\n * @property {function(): void} callBids - sends requests to all adapters for bids\n */\n\nimport {\n  generateUUID,\n  isEmpty,\n  isEmptyStr,\n  isFn,\n  logError,\n  logInfo,\n  logMessage,\n  logWarn,\n  parseUrl,\n  timestamp\n} from './utils.js';\nimport {getPriceBucketString} from './cpmBucketManager.js';\nimport {getNativeTargeting, isNativeResponse, setNativeResponseProperties} from './native.js';\nimport {batchAndStore} from './videoCache.js';\nimport {Renderer} from './Renderer.js';\nimport {config} from './config.js';\nimport {userSync} from './userSync.js';\nimport {hook} from './hook.js';\nimport {find, includes} from './polyfill.js';\nimport {OUTSTREAM} from './video.js';\nimport {VIDEO} from './mediaTypes.js';\nimport {auctionManager} from './auctionManager.js';\nimport {bidderSettings} from './bidderSettings.js';\nimport * as events from './events.js';\nimport adapterManager from './adapterManager.js';\nimport {EVENTS, GRANULARITY_OPTIONS, JSON_MAPPING, REJECTION_REASON, S2S, TARGETING_KEYS} from './constants.js';\nimport {defer, GreedyPromise} from './utils/promise.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {adjustCpm} from './utils/cpm.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport {ttlCollection} from './utils/ttlCollection.js';\nimport {getMinBidCacheTTL, onMinBidCacheTTLChange} from './bidTTL.js';\n\nconst { syncUsers } = userSync;\n\nexport const AUCTION_STARTED = 'started';\nexport const AUCTION_IN_PROGRESS = 'inProgress';\nexport const AUCTION_COMPLETED = 'completed';\n\n// register event for bid adjustment\nevents.on(EVENTS.BID_ADJUSTMENT, function (bid) {\n  adjustBids(bid);\n});\n\nconst MAX_REQUESTS_PER_ORIGIN = 4;\nconst outstandingRequests = {};\nconst sourceInfo = {};\nconst queuedCalls = [];\n\nconst pbjsInstance = getGlobal();\n\n/**\n * Clear global state for tests\n */\nexport function resetAuctionState() {\n  queuedCalls.length = 0;\n  [outstandingRequests, sourceInfo].forEach((ob) => Object.keys(ob).forEach((k) => { delete ob[k] }));\n}\n\n/**\n * Creates new auction instance\n *\n * @param {Object} requestConfig\n * @param {AdUnit} requestConfig.adUnits\n * @param {AdUnitCode} requestConfig.adUnitCodes\n * @param {function():void} requestConfig.callback\n * @param {number} requestConfig.cbTimeout\n * @param {Array.<string>} requestConfig.labels\n * @param {string} requestConfig.auctionId\n * @param {{global: {}, bidder: {}}} requestConfig.ortb2Fragments first party data, separated into global\n *    (from getConfig('ortb2') + requestBids({ortb2})) and bidder (a map from bidderCode to ortb2)\n * @param {Object} requestConfig.metrics\n * @returns {Auction} auction instance\n */\nexport function newAuction({adUnits, adUnitCodes, callback, cbTimeout, labels, auctionId, ortb2Fragments, metrics}) {\n  metrics = useMetrics(metrics);\n  const _adUnits = adUnits;\n  const _labels = labels;\n  const _adUnitCodes = adUnitCodes;\n  const _auctionId = auctionId || generateUUID();\n  const _timeout = cbTimeout;\n  const _timelyRequests = new Set();\n  const done = defer();\n  const requestsDone = defer();\n  let _bidsRejected = [];\n  let _callback = callback;\n  let _bidderRequests = [];\n  let _bidsReceived = ttlCollection({\n    startTime: (bid) => bid.responseTimestamp,\n    ttl: (bid) => getMinBidCacheTTL() == null ? null : Math.max(getMinBidCacheTTL(), bid.ttl) * 1000\n  });\n  let _noBids = [];\n  let _winningBids = [];\n  let _auctionStart;\n  let _auctionEnd;\n  let _timeoutTimer;\n  let _auctionStatus;\n  let _nonBids = [];\n\n  onMinBidCacheTTLChange(() => _bidsReceived.refresh());\n\n  function addBidRequests(bidderRequests) { _bidderRequests = _bidderRequests.concat(bidderRequests); }\n  function addBidReceived(bid) { _bidsReceived.add(bid); }\n  function addBidRejected(bidsRejected) { _bidsRejected = _bidsRejected.concat(bidsRejected); }\n  function addNoBid(noBid) { _noBids = _noBids.concat(noBid); }\n  function addNonBids(seatnonbids) { _nonBids = _nonBids.concat(seatnonbids); }\n\n  function getProperties() {\n    return {\n      auctionId: _auctionId,\n      timestamp: _auctionStart,\n      auctionEnd: _auctionEnd,\n      auctionStatus: _auctionStatus,\n      adUnits: _adUnits,\n      adUnitCodes: _adUnitCodes,\n      labels: _labels,\n      bidderRequests: _bidderRequests,\n      noBids: _noBids,\n      bidsReceived: _bidsReceived.toArray(),\n      bidsRejected: _bidsRejected,\n      winningBids: _winningBids,\n      timeout: _timeout,\n      metrics: metrics,\n      seatNonBids: _nonBids\n    };\n  }\n\n  function startAuctionTimer() {\n    _timeoutTimer = setTimeout(() => executeCallback(true), _timeout);\n  }\n\n  function executeCallback(timedOut) {\n    if (!timedOut) {\n      clearTimeout(_timeoutTimer);\n    } else {\n      events.emit(EVENTS.AUCTION_TIMEOUT, getProperties());\n    }\n    if (_auctionEnd === undefined) {\n      let timedOutRequests = [];\n      if (timedOut) {\n        logMessage(`Auction ${_auctionId} timedOut`);\n        timedOutRequests = _bidderRequests.filter(rq => !_timelyRequests.has(rq.bidderRequestId)).flatMap(br => br.bids)\n        if (timedOutRequests.length) {\n          events.emit(EVENTS.BID_TIMEOUT, timedOutRequests);\n        }\n      }\n\n      _auctionStatus = AUCTION_COMPLETED;\n      _auctionEnd = Date.now();\n      metrics.checkpoint('auctionEnd');\n      metrics.timeBetween('requestBids', 'auctionEnd', 'requestBids.total');\n      metrics.timeBetween('callBids', 'auctionEnd', 'requestBids.callBids');\n      done.resolve();\n\n      events.emit(EVENTS.AUCTION_END, getProperties());\n      bidsBackCallback(_adUnits, function () {\n        try {\n          if (_callback != null) {\n            const bids = _bidsReceived.toArray()\n              .filter(bid => _adUnitCodes.includes(bid.adUnitCode))\n              .reduce(groupByPlacement, {});\n            _callback.apply(pbjsInstance, [bids, timedOut, _auctionId]);\n            _callback = null;\n          }\n        } catch (e) {\n          logError('Error executing bidsBackHandler', null, e);\n        } finally {\n          // Calling timed out bidders\n          if (timedOutRequests.length) {\n            adapterManager.callTimedOutBidders(adUnits, timedOutRequests, _timeout);\n          }\n          // Only automatically sync if the publisher has not chosen to \"enableOverride\"\n          let userSyncConfig = config.getConfig('userSync') || {};\n          if (!userSyncConfig.enableOverride) {\n            // Delay the auto sync by the config delay\n            syncUsers(userSyncConfig.syncDelay);\n          }\n        }\n      })\n    }\n  }\n\n  function auctionDone() {\n    config.resetBidder();\n    // when all bidders have called done callback atleast once it means auction is complete\n    logInfo(`Bids Received for Auction with id: ${_auctionId}`, _bidsReceived.toArray());\n    _auctionStatus = AUCTION_COMPLETED;\n    executeCallback(false);\n  }\n\n  function onTimelyResponse(bidderRequestId) {\n    _timelyRequests.add(bidderRequestId);\n  }\n\n  function callBids() {\n    _auctionStatus = AUCTION_STARTED;\n    _auctionStart = Date.now();\n\n    let bidRequests = metrics.measureTime('requestBids.makeRequests',\n      () => adapterManager.makeBidRequests(_adUnits, _auctionStart, _auctionId, _timeout, _labels, ortb2Fragments, metrics));\n    logInfo(`Bids Requested for Auction with id: ${_auctionId}`, bidRequests);\n\n    metrics.checkpoint('callBids')\n\n    if (bidRequests.length < 1) {\n      logWarn('No valid bid requests returned for auction');\n      auctionDone();\n    } else {\n      addBidderRequests.call({\n        dispatch: addBidderRequestsCallback,\n        context: this\n      }, bidRequests);\n    }\n  }\n\n  /**\n   * callback executed after addBidderRequests completes\n   * @param {BidRequest[]} bidRequests\n   */\n  function addBidderRequestsCallback(bidRequests) {\n    bidRequests.forEach(bidRequest => {\n      addBidRequests(bidRequest);\n    });\n\n    let requests = {};\n    let call = {\n      bidRequests,\n      run: () => {\n        startAuctionTimer();\n\n        _auctionStatus = AUCTION_IN_PROGRESS;\n\n        events.emit(EVENTS.AUCTION_INIT, getProperties());\n\n        let callbacks = auctionCallbacks(auctionDone, this);\n        adapterManager.callBids(_adUnits, bidRequests, callbacks.addBidResponse, callbacks.adapterDone, {\n          request(source, origin) {\n            increment(outstandingRequests, origin);\n            increment(requests, source);\n\n            if (!sourceInfo[source]) {\n              sourceInfo[source] = {\n                SRA: true,\n                origin\n              };\n            }\n            if (requests[source] > 1) {\n              sourceInfo[source].SRA = false;\n            }\n          },\n          done(origin) {\n            outstandingRequests[origin]--;\n            if (queuedCalls[0]) {\n              if (runIfOriginHasCapacity(queuedCalls[0])) {\n                queuedCalls.shift();\n              }\n            }\n          }\n        }, _timeout, onTimelyResponse, ortb2Fragments);\n        requestsDone.resolve();\n      }\n    };\n\n    if (!runIfOriginHasCapacity(call)) {\n      logWarn('queueing auction due to limited endpoint capacity');\n      queuedCalls.push(call);\n    }\n\n    function runIfOriginHasCapacity(call) {\n      let hasCapacity = true;\n\n      let maxRequests = config.getConfig('maxRequestsPerOrigin') || MAX_REQUESTS_PER_ORIGIN;\n\n      call.bidRequests.some(bidRequest => {\n        let requests = 1;\n        let source = (typeof bidRequest.src !== 'undefined' && bidRequest.src === S2S.SRC) ? 's2s'\n          : bidRequest.bidderCode;\n        // if we have no previous info on this source just let them through\n        if (sourceInfo[source]) {\n          if (sourceInfo[source].SRA === false) {\n            // some bidders might use more than the MAX_REQUESTS_PER_ORIGIN in a single auction.  In those cases\n            // set their request count to MAX_REQUESTS_PER_ORIGIN so the auction isn't permanently queued waiting\n            // for capacity for that bidder\n            requests = Math.min(bidRequest.bids.length, maxRequests);\n          }\n          if (outstandingRequests[sourceInfo[source].origin] + requests > maxRequests) {\n            hasCapacity = false;\n          }\n        }\n        // return only used for terminating this .some() iteration early if it is determined we don't have capacity\n        return !hasCapacity;\n      });\n\n      if (hasCapacity) {\n        call.run();\n      }\n\n      return hasCapacity;\n    }\n\n    function increment(obj, prop) {\n      if (typeof obj[prop] === 'undefined') {\n        obj[prop] = 1\n      } else {\n        obj[prop]++;\n      }\n    }\n  }\n\n  function addWinningBid(winningBid) {\n    _winningBids = _winningBids.concat(winningBid);\n    adapterManager.callBidWonBidder(winningBid.adapterCode || winningBid.bidder, winningBid, adUnits);\n    if (!winningBid.deferBilling) {\n      adapterManager.triggerBilling(winningBid)\n    }\n  }\n\n  function setBidTargeting(bid) {\n    adapterManager.callSetTargetingBidder(bid.adapterCode || bid.bidder, bid);\n  }\n\n  events.on(EVENTS.SEAT_NON_BID, (event) => {\n    if (event.auctionId === _auctionId) {\n      addNonBids(event.seatnonbid)\n    }\n  });\n\n  return {\n    addBidReceived,\n    addBidRejected,\n    addNoBid,\n    callBids,\n    addWinningBid,\n    setBidTargeting,\n    getWinningBids: () => _winningBids,\n    getAuctionStart: () => _auctionStart,\n    getAuctionEnd: () => _auctionEnd,\n    getTimeout: () => _timeout,\n    getAuctionId: () => _auctionId,\n    getAuctionStatus: () => _auctionStatus,\n    getAdUnits: () => _adUnits,\n    getAdUnitCodes: () => _adUnitCodes,\n    getBidRequests: () => _bidderRequests,\n    getBidsReceived: () => _bidsReceived.toArray(),\n    getNoBids: () => _noBids,\n    getNonBids: () => _nonBids,\n    getFPD: () => ortb2Fragments,\n    getMetrics: () => metrics,\n    end: done.promise,\n    requestsDone: requestsDone.promise\n  };\n}\n\n/**\n * Hook into this to intercept bids before they are added to an auction.\n *\n * @type {Function}\n * @param adUnitCode\n * @param bid\n * @param {function(String): void} reject a function that, when called, rejects `bid` with the given reason.\n */\nexport const addBidResponse = hook('sync', function(adUnitCode, bid, reject) {\n  if (!isValidPrice(bid)) {\n    reject(REJECTION_REASON.PRICE_TOO_HIGH)\n  } else {\n    this.dispatch.call(null, adUnitCode, bid);\n  }\n}, 'addBidResponse');\n\n/**\n * Delay hook for adapter responses.\n *\n * `ready` is a promise; auctions wait for it to resolve before closing. Modules can hook into this\n * to delay the end of auctions while they perform initialization that does not need to delay their start.\n */\nexport const responsesReady = hook('sync', (ready) => ready, 'responsesReady');\n\nexport const addBidderRequests = hook('sync', function(bidderRequests) {\n  this.dispatch.call(this.context, bidderRequests);\n}, 'addBidderRequests');\n\nexport const bidsBackCallback = hook('async', function (adUnits, callback) {\n  if (callback) {\n    callback();\n  }\n}, 'bidsBackCallback');\n\nexport function auctionCallbacks(auctionDone, auctionInstance, {index = auctionManager.index} = {}) {\n  let outstandingBidsAdded = 0;\n  let allAdapterCalledDone = false;\n  let bidderRequestsDone = new Set();\n  let bidResponseMap = {};\n\n  function afterBidAdded() {\n    outstandingBidsAdded--;\n    if (allAdapterCalledDone && outstandingBidsAdded === 0) {\n      auctionDone()\n    }\n  }\n\n  function handleBidResponse(adUnitCode, bid, handler) {\n    bidResponseMap[bid.requestId] = true;\n    addCommonResponseProperties(bid, adUnitCode)\n    outstandingBidsAdded++;\n    return handler(afterBidAdded);\n  }\n\n  function acceptBidResponse(adUnitCode, bid) {\n    handleBidResponse(adUnitCode, bid, (done) => {\n      let bidResponse = getPreparedBidForAuction(bid);\n      events.emit(EVENTS.BID_ACCEPTED, bidResponse);\n      if (FEATURES.VIDEO && bidResponse.mediaType === VIDEO) {\n        tryAddVideoBid(auctionInstance, bidResponse, done);\n      } else {\n        if (FEATURES.NATIVE && isNativeResponse(bidResponse)) {\n          setNativeResponseProperties(bidResponse, index.getAdUnit(bidResponse));\n        }\n        addBidToAuction(auctionInstance, bidResponse);\n        done();\n      }\n    });\n  }\n\n  function rejectBidResponse(adUnitCode, bid, reason) {\n    return handleBidResponse(adUnitCode, bid, (done) => {\n      bid.rejectionReason = reason;\n      logWarn(`Bid from ${bid.bidder || 'unknown bidder'} was rejected: ${reason}`, bid)\n      events.emit(EVENTS.BID_REJECTED, bid);\n      auctionInstance.addBidRejected(bid);\n      done();\n    })\n  }\n\n  function adapterDone() {\n    let bidderRequest = this;\n    let bidderRequests = auctionInstance.getBidRequests();\n    const auctionOptionsConfig = config.getConfig('auctionOptions');\n\n    bidderRequestsDone.add(bidderRequest);\n\n    if (auctionOptionsConfig && !isEmpty(auctionOptionsConfig)) {\n      const secondaryBidders = auctionOptionsConfig.secondaryBidders;\n      if (secondaryBidders && !bidderRequests.every(bidder => includes(secondaryBidders, bidder.bidderCode))) {\n        bidderRequests = bidderRequests.filter(request => !includes(secondaryBidders, request.bidderCode));\n      }\n    }\n\n    allAdapterCalledDone = bidderRequests.every(bidderRequest => bidderRequestsDone.has(bidderRequest));\n\n    bidderRequest.bids.forEach(bid => {\n      if (!bidResponseMap[bid.bidId]) {\n        auctionInstance.addNoBid(bid);\n        events.emit(EVENTS.NO_BID, bid);\n      }\n    });\n\n    if (allAdapterCalledDone && outstandingBidsAdded === 0) {\n      auctionDone();\n    }\n  }\n\n  return {\n    addBidResponse: (function () {\n      function addBid(adUnitCode, bid) {\n        addBidResponse.call({\n          dispatch: acceptBidResponse,\n        }, adUnitCode, bid, (() => {\n          let rejected = false;\n          return (reason) => {\n            if (!rejected) {\n              rejectBidResponse(adUnitCode, bid, reason);\n              rejected = true;\n            }\n          }\n        })())\n      }\n      addBid.reject = rejectBidResponse;\n      return addBid;\n    })(),\n    adapterDone: function () {\n      responsesReady(GreedyPromise.resolve()).finally(() => adapterDone.call(this));\n    }\n  }\n}\n\n// Add a bid to the auction.\nexport function addBidToAuction(auctionInstance, bidResponse) {\n  setupBidTargeting(bidResponse);\n\n  useMetrics(bidResponse.metrics).timeSince('addBidResponse', 'addBidResponse.total');\n  auctionInstance.addBidReceived(bidResponse);\n  events.emit(EVENTS.BID_RESPONSE, bidResponse);\n}\n\n// Video bids may fail if the cache is down, or there's trouble on the network.\nfunction tryAddVideoBid(auctionInstance, bidResponse, afterBidAdded, {index = auctionManager.index} = {}) {\n  let addBid = true;\n\n  const videoMediaType = index.getMediaTypes({\n    requestId: bidResponse.originalRequestId || bidResponse.requestId,\n    adUnitId: bidResponse.adUnitId\n  })?.video;\n  const context = videoMediaType && videoMediaType?.context;\n  const useCacheKey = videoMediaType && videoMediaType?.useCacheKey;\n\n  if (config.getConfig('cache.url') && (useCacheKey || context !== OUTSTREAM)) {\n    if (!bidResponse.videoCacheKey || config.getConfig('cache.ignoreBidderCacheKey')) {\n      addBid = false;\n      callPrebidCache(auctionInstance, bidResponse, afterBidAdded, videoMediaType);\n    } else if (!bidResponse.vastUrl) {\n      logError('videoCacheKey specified but not required vastUrl for video bid');\n      addBid = false;\n    }\n  }\n  if (addBid) {\n    addBidToAuction(auctionInstance, bidResponse);\n    afterBidAdded();\n  }\n}\n\nexport const callPrebidCache = hook('async', function(auctionInstance, bidResponse, afterBidAdded, videoMediaType) {\n  if (FEATURES.VIDEO) {\n    batchAndStore(auctionInstance, bidResponse, afterBidAdded);\n  }\n}, 'callPrebidCache');\n\n/**\n * Augment `bidResponse` with properties that are common across all bids - including rejected bids.\n *\n */\nfunction addCommonResponseProperties(bidResponse, adUnitCode, {index = auctionManager.index} = {}) {\n  const bidderRequest = index.getBidderRequest(bidResponse);\n  const adUnit = index.getAdUnit(bidResponse);\n  const start = (bidderRequest && bidderRequest.start) || bidResponse.requestTimestamp;\n\n  Object.assign(bidResponse, {\n    responseTimestamp: bidResponse.responseTimestamp || timestamp(),\n    requestTimestamp: bidResponse.requestTimestamp || start,\n    cpm: parseFloat(bidResponse.cpm) || 0,\n    bidder: bidResponse.bidder || bidResponse.bidderCode,\n    adUnitCode\n  });\n\n  if (adUnit?.ttlBuffer != null) {\n    bidResponse.ttlBuffer = adUnit.ttlBuffer;\n  }\n\n  bidResponse.timeToRespond = bidResponse.responseTimestamp - bidResponse.requestTimestamp;\n}\n\n/**\n * Add additional bid response properties that are universal for all _accepted_ bids.\n */\nfunction getPreparedBidForAuction(bid, {index = auctionManager.index} = {}) {\n  // Let listeners know that now is the time to adjust the bid, if they want to.\n  //\n  // CAREFUL: Publishers rely on certain bid properties to be available (like cpm),\n  // but others to not be set yet (like priceStrings). See #1372 and #1389.\n  events.emit(EVENTS.BID_ADJUSTMENT, bid);\n\n  // a publisher-defined renderer can be used to render bids\n  const bidRenderer = index.getBidRequest(bid)?.renderer || index.getAdUnit(bid).renderer;\n\n  // a publisher can also define a renderer for a mediaType\n  const bidObjectMediaType = bid.mediaType;\n  const mediaTypes = index.getMediaTypes(bid);\n  const bidMediaType = mediaTypes && mediaTypes[bidObjectMediaType];\n\n  var mediaTypeRenderer = bidMediaType && bidMediaType.renderer;\n\n  var renderer = null;\n\n  // the renderer for the mediaType takes precendence\n  if (mediaTypeRenderer && mediaTypeRenderer.render && !(mediaTypeRenderer.backupOnly === true && bid.renderer)) {\n    renderer = mediaTypeRenderer;\n  } else if (bidRenderer && bidRenderer.render && !(bidRenderer.backupOnly === true && bid.renderer)) {\n    renderer = bidRenderer;\n  }\n\n  if (renderer) {\n    // be aware, an adapter could already have installed the bidder, in which case this overwrite's the existing adapter\n    bid.renderer = Renderer.install({ url: renderer.url, config: renderer.options, renderNow: renderer.url == null });// rename options to config, to make it consistent?\n    bid.renderer.setRender(renderer.render);\n  }\n\n  // Use the config value 'mediaTypeGranularity' if it has been defined for mediaType, else use 'customPriceBucket'\n  const mediaTypeGranularity = getMediaTypeGranularity(bid.mediaType, mediaTypes, config.getConfig('mediaTypePriceGranularity'));\n  const priceStringsObj = getPriceBucketString(\n    bid.cpm,\n    (typeof mediaTypeGranularity === 'object') ? mediaTypeGranularity : config.getConfig('customPriceBucket'),\n    config.getConfig('currency.granularityMultiplier')\n  );\n  bid.pbLg = priceStringsObj.low;\n  bid.pbMg = priceStringsObj.med;\n  bid.pbHg = priceStringsObj.high;\n  bid.pbAg = priceStringsObj.auto;\n  bid.pbDg = priceStringsObj.dense;\n  bid.pbCg = priceStringsObj.custom;\n\n  return bid;\n}\n\nfunction setupBidTargeting(bidObject) {\n  let keyValues;\n  const cpmCheck = (bidderSettings.get(bidObject.bidderCode, 'allowZeroCpmBids') === true) ? bidObject.cpm >= 0 : bidObject.cpm > 0;\n  if (bidObject.bidderCode && (cpmCheck || bidObject.dealId)) {\n    keyValues = getKeyValueTargetingPairs(bidObject.bidderCode, bidObject);\n  }\n\n  // use any targeting provided as defaults, otherwise just set from getKeyValueTargetingPairs\n  bidObject.adserverTargeting = Object.assign(bidObject.adserverTargeting || {}, keyValues);\n}\n\n/**\n * @param {MediaType} mediaType\n * @param mediaTypes media types map from adUnit\n * @param {MediaTypePriceGranularity} [mediaTypePriceGranularity]\n * @returns {(Object|string|undefined)}\n */\nexport function getMediaTypeGranularity(mediaType, mediaTypes, mediaTypePriceGranularity) {\n  if (mediaType && mediaTypePriceGranularity) {\n    if (FEATURES.VIDEO && mediaType === VIDEO) {\n      const context = mediaTypes?.[VIDEO]?.context ?? 'instream';\n      if (mediaTypePriceGranularity[`${VIDEO}-${context}`]) {\n        return mediaTypePriceGranularity[`${VIDEO}-${context}`];\n      }\n    }\n    return mediaTypePriceGranularity[mediaType];\n  }\n}\n\n/**\n * This function returns the price granularity defined. It can be either publisher defined or default value\n * @param {Bid} bid bid response object\n * @param {object} obj\n * @param {object} obj.index\n * @returns {string} granularity\n */\nexport const getPriceGranularity = (bid, {index = auctionManager.index} = {}) => {\n  // Use the config value 'mediaTypeGranularity' if it has been set for mediaType, else use 'priceGranularity'\n  const mediaTypeGranularity = getMediaTypeGranularity(bid.mediaType, index.getMediaTypes(bid), config.getConfig('mediaTypePriceGranularity'));\n  const granularity = (typeof bid.mediaType === 'string' && mediaTypeGranularity) ? ((typeof mediaTypeGranularity === 'string') ? mediaTypeGranularity : 'custom') : config.getConfig('priceGranularity');\n  return granularity;\n}\n\n/**\n * This function returns a function to get bid price by price granularity\n * @param {string} granularity\n * @returns {function}\n */\nexport const getPriceByGranularity = (granularity) => {\n  return (bid) => {\n    const bidGranularity = granularity || getPriceGranularity(bid);\n    if (bidGranularity === GRANULARITY_OPTIONS.AUTO) {\n      return bid.pbAg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.DENSE) {\n      return bid.pbDg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.LOW) {\n      return bid.pbLg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.MEDIUM) {\n      return bid.pbMg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.HIGH) {\n      return bid.pbHg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.CUSTOM) {\n      return bid.pbCg;\n    }\n  }\n}\n\n/**\n * This function returns a function to get crid from bid response\n * @returns {function}\n */\nexport const getCreativeId = () => {\n  return (bid) => {\n    return (bid.creativeId) ? bid.creativeId : '';\n  }\n}\n\n/**\n * This function returns a function to get first advertiser domain from bid response meta\n * @returns {function}\n */\nexport const getAdvertiserDomain = () => {\n  return (bid) => {\n    return (bid.meta && bid.meta.advertiserDomains && bid.meta.advertiserDomains.length > 0) ? [bid.meta.advertiserDomains].flat()[0] : '';\n  }\n}\n\n/**\n * This function returns a function to get dsp name or id from bid response meta\n * @returns {function}\n */\nexport const getDSP = () => {\n  return (bid) => {\n    return (bid.meta && (bid.meta.networkId || bid.meta.networkName)) ? bid?.meta?.networkName || bid?.meta?.networkId : '';\n  }\n}\n\n/**\n * This function returns a function to get the primary category id from bid response meta\n * @returns {function}\n */\nexport const getPrimaryCatId = () => {\n  return (bid) => {\n    return (bid.meta && bid.meta.primaryCatId) ? bid.meta.primaryCatId : '';\n  }\n}\n\n// factory for key value objs\nfunction createKeyVal(key, value) {\n  return {\n    key,\n    val: (typeof value === 'function')\n      ? function (bidResponse, bidReq) {\n        return value(bidResponse, bidReq);\n      }\n      : function (bidResponse) {\n        return bidResponse[value];\n      }\n  };\n}\n\nfunction defaultAdserverTargeting() {\n  return [\n    createKeyVal(TARGETING_KEYS.BIDDER, 'bidderCode'),\n    createKeyVal(TARGETING_KEYS.AD_ID, 'adId'),\n    createKeyVal(TARGETING_KEYS.PRICE_BUCKET, getPriceByGranularity()),\n    createKeyVal(TARGETING_KEYS.SIZE, 'size'),\n    createKeyVal(TARGETING_KEYS.DEAL, 'dealId'),\n    createKeyVal(TARGETING_KEYS.SOURCE, 'source'),\n    createKeyVal(TARGETING_KEYS.FORMAT, 'mediaType'),\n    createKeyVal(TARGETING_KEYS.ADOMAIN, getAdvertiserDomain()),\n    createKeyVal(TARGETING_KEYS.ACAT, getPrimaryCatId()),\n    createKeyVal(TARGETING_KEYS.DSP, getDSP()),\n    createKeyVal(TARGETING_KEYS.CRID, getCreativeId()),\n  ]\n}\n\n/**\n * @param {string} mediaType\n * @param {string} bidderCode\n * @returns {*}\n */\nexport function getStandardBidderSettings(mediaType, bidderCode) {\n  const standardSettings = Object.assign({}, bidderSettings.settingsFor(null));\n  if (!standardSettings[JSON_MAPPING.ADSERVER_TARGETING]) {\n    standardSettings[JSON_MAPPING.ADSERVER_TARGETING] = defaultAdserverTargeting();\n  }\n\n  if (FEATURES.VIDEO && mediaType === 'video') {\n    const adserverTargeting = standardSettings[JSON_MAPPING.ADSERVER_TARGETING].slice();\n    standardSettings[JSON_MAPPING.ADSERVER_TARGETING] = adserverTargeting;\n\n    // Adding hb_uuid + hb_cache_id\n    [TARGETING_KEYS.UUID, TARGETING_KEYS.CACHE_ID].forEach(targetingKeyVal => {\n      if (typeof find(adserverTargeting, kvPair => kvPair.key === targetingKeyVal) === 'undefined') {\n        adserverTargeting.push(createKeyVal(targetingKeyVal, 'videoCacheKey'));\n      }\n    });\n\n    // Adding hb_cache_host\n    if (config.getConfig('cache.url') && (!bidderCode || bidderSettings.get(bidderCode, 'sendStandardTargeting') !== false)) {\n      const urlInfo = parseUrl(config.getConfig('cache.url'));\n\n      if (typeof find(adserverTargeting, targetingKeyVal => targetingKeyVal.key === TARGETING_KEYS.CACHE_HOST) === 'undefined') {\n        adserverTargeting.push(createKeyVal(TARGETING_KEYS.CACHE_HOST, function(bidResponse) {\n          return bidResponse?.adserverTargeting?.[TARGETING_KEYS.CACHE_HOST] || urlInfo.hostname;\n        }));\n      }\n    }\n  }\n\n  return standardSettings;\n}\n\nexport function getKeyValueTargetingPairs(bidderCode, custBidObj, {index = auctionManager.index} = {}) {\n  if (!custBidObj) {\n    return {};\n  }\n  const bidRequest = index.getBidRequest(custBidObj);\n  var keyValues = {};\n\n  // 1) set the keys from \"standard\" setting or from prebid defaults\n  // initialize default if not set\n  const standardSettings = getStandardBidderSettings(custBidObj.mediaType, bidderCode);\n  setKeys(keyValues, standardSettings, custBidObj, bidRequest);\n\n  // 2) set keys from specific bidder setting override if they exist\n  if (bidderCode && bidderSettings.getOwn(bidderCode, JSON_MAPPING.ADSERVER_TARGETING)) {\n    setKeys(keyValues, bidderSettings.ownSettingsFor(bidderCode), custBidObj, bidRequest);\n    custBidObj.sendStandardTargeting = bidderSettings.get(bidderCode, 'sendStandardTargeting');\n  }\n\n  // set native key value targeting\n  if (FEATURES.NATIVE && custBidObj['native']) {\n    keyValues = Object.assign({}, keyValues, getNativeTargeting(custBidObj));\n  }\n\n  return keyValues;\n}\n\nfunction setKeys(keyValues, bidderSettings, custBidObj, bidReq) {\n  var targeting = bidderSettings[JSON_MAPPING.ADSERVER_TARGETING];\n  custBidObj.size = custBidObj.getSize();\n\n  (targeting || []).forEach(function (kvPair) {\n    var key = kvPair.key;\n    var value = kvPair.val;\n\n    if (keyValues[key]) {\n      logWarn('The key: ' + key + ' is being overwritten');\n    }\n\n    if (isFn(value)) {\n      try {\n        value = value(custBidObj, bidReq);\n      } catch (e) {\n        logError('bidmanager', 'ERROR', e);\n      }\n    }\n\n    if (\n      ((typeof bidderSettings.suppressEmptyKeys !== 'undefined' && bidderSettings.suppressEmptyKeys === true) ||\n        key === TARGETING_KEYS.DEAL || key === TARGETING_KEYS.ACAT || key === TARGETING_KEYS.DSP || key === TARGETING_KEYS.CRID) && // hb_deal & hb_acat are suppressed automatically if not set\n      (\n        isEmptyStr(value) ||\n        value === null ||\n        value === undefined\n      )\n    ) {\n      logInfo(\"suppressing empty key '\" + key + \"' from adserver targeting\");\n    } else {\n      keyValues[key] = value;\n    }\n  });\n\n  return keyValues;\n}\n\nexport function adjustBids(bid) {\n  let bidPriceAdjusted = adjustCpm(bid.cpm, bid);\n\n  if (bidPriceAdjusted >= 0) {\n    bid.cpm = bidPriceAdjusted;\n  }\n}\n\n/**\n * groupByPlacement is a reduce function that converts an array of Bid objects\n * to an object with placement codes as keys, with each key representing an object\n * with an array of `Bid` objects for that placement\n * @returns {*} as { [adUnitCode]: { bids: [Bid, Bid, Bid] } }\n */\nfunction groupByPlacement(bidsByPlacement, bid) {\n  if (!bidsByPlacement[bid.adUnitCode]) { bidsByPlacement[bid.adUnitCode] = { bids: [] }; }\n  bidsByPlacement[bid.adUnitCode].bids.push(bid);\n  return bidsByPlacement;\n}\n\n/**\n * isValidPrice is price validation function\n * which checks if price from bid response\n * is not higher than top limit set in config\n * @type {Function}\n * @param bid\n * @returns {boolean}\n */\nfunction isValidPrice(bid) {\n  const maxBidValue = config.getConfig('maxBid');\n  if (!maxBidValue || !bid.cpm) return true;\n  return maxBidValue >= Number(bid.cpm);\n}\n","/**\n * @typedef {Object} AuctionIndex\n *\n * @property {function({ auctionId: * }): *} getAuction Returns auction instance for `auctionId`\n * @property {function({ adUnitId: * }): *} getAdUnit Returns `adUnit` object for `transactionId`.\n * You should prefer `getMediaTypes` for looking up bid media types.\n * @property {function({ adUnitId: *, requestId: * }): *} getMediaTypes Returns mediaTypes object from bidRequest (through `requestId`) falling back to the adUnit (through `transactionId`).\n * The bidRequest is given precedence because its mediaTypes can differ from the adUnit's (if bidder-specific labels are in use).\n * Bids that have no associated request do not have labels either, and use the adUnit's mediaTypes.\n * @property {function({ requestId: *, bidderRequestId: * }): *} getBidderRequest Returns bidderRequest that matches both requestId and bidderRequestId (if either or both are provided).\n * Bid responses are not guaranteed to have a corresponding request.\n * @property {function({ requestId: * }): *} getBidRequest Returns bidRequest object for requestId.\n * Bid responses are not guaranteed to have a corresponding request.\n */\n\n/**\n * Retrieves request-related bid data.\n * All methods are designed to work with Bid (response) objects returned by bid adapters.\n */\nexport function AuctionIndex(getAuctions) {\n  Object.assign(this, {\n    getAuction({auctionId}) {\n      if (auctionId != null) {\n        return getAuctions()\n          .find(auction => auction.getAuctionId() === auctionId);\n      }\n    },\n    getAdUnit({adUnitId}) {\n      if (adUnitId != null) {\n        return getAuctions()\n          .flatMap(a => a.getAdUnits())\n          .find(au => au.adUnitId === adUnitId);\n      }\n    },\n    getMediaTypes({adUnitId, requestId}) {\n      if (requestId != null) {\n        const req = this.getBidRequest({requestId});\n        if (req != null && (adUnitId == null || req.adUnitId === adUnitId)) {\n          return req.mediaTypes;\n        }\n      } else if (adUnitId != null) {\n        const au = this.getAdUnit({adUnitId});\n        if (au != null) {\n          return au.mediaTypes;\n        }\n      }\n    },\n    getBidderRequest({requestId, bidderRequestId}) {\n      if (requestId != null || bidderRequestId != null) {\n        let bers = getAuctions().flatMap(a => a.getBidRequests());\n        if (bidderRequestId != null) {\n          bers = bers.filter(ber => ber.bidderRequestId === bidderRequestId);\n        }\n        if (requestId == null) {\n          return bers[0];\n        } else {\n          return bers.find(ber => ber.bids && ber.bids.find(br => br.bidId === requestId) != null)\n        }\n      }\n    },\n    getBidRequest({requestId}) {\n      if (requestId != null) {\n        return getAuctions()\n          .flatMap(a => a.getBidRequests())\n          .flatMap(ber => ber.bids)\n          .find(br => br && br.bidId === requestId);\n      }\n    },\n    getOrtb2(bid) {\n      return this.getBidderRequest(bid)?.ortb2 || this.getAuction(bid)?.getFPD()?.global?.ortb2\n    }\n  });\n}\n","/**\n * AuctionManager modules is responsible for creating auction instances.\n * This module is the gateway for Prebid core to access auctions.\n * It stores all created instances of auction and can be used to get consolidated values from auction.\n */\n\n/**\n * @typedef {Object} AuctionManager\n *\n * @property {function(): Array} getBidsRequested - returns consolidated bid requests\n * @property {function(): Array} getBidsReceived - returns consolidated bid received\n * @property {function(): Array} getAllBidsForAdUnitCode - returns consolidated bid received for a given adUnit\n * @property {function(): Array} getAdUnits - returns consolidated adUnits\n * @property {function(): Array} getAdUnitCodes - returns consolidated adUnitCodes\n * @property {function(): Object} createAuction - creates auction instance and stores it for future reference\n * @property {function(): Object} findBidByAdId - find bid received by adId. This function will be called by $$PREBID_GLOBAL$$.renderAd\n * @property {function(): Object} getStandardBidderAdServerTargeting - returns standard bidder targeting for all the adapters. Refer http://prebid.org/dev-docs/publisher-api-reference.html#module_pbjs.bidderSettings for more details\n * @property {function(Object): void} addWinningBid - add a winning bid to an auction based on auctionId\n * @property {function(): void} clearAllAuctions - clear all auctions for testing\n * @property {AuctionIndex} index\n */\n\nimport { uniques, logWarn } from './utils.js';\nimport { newAuction, getStandardBidderSettings, AUCTION_COMPLETED } from './auction.js';\nimport {AuctionIndex} from './auctionIndex.js';\nimport { BID_STATUS, JSON_MAPPING } from './constants.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {ttlCollection} from './utils/ttlCollection.js';\nimport {getMinBidCacheTTL, onMinBidCacheTTLChange} from './bidTTL.js';\n\n/**\n * Creates new instance of auctionManager. There will only be one instance of auctionManager but\n * a factory is created to assist in testing.\n *\n * @returns {AuctionManager} auctionManagerInstance\n */\nexport function newAuctionManager() {\n  const _auctions = ttlCollection({\n    startTime: (au) => au.end.then(() => au.getAuctionEnd()),\n    ttl: (au) => getMinBidCacheTTL() == null ? null : au.end.then(() => {\n      return Math.max(getMinBidCacheTTL(), ...au.getBidsReceived().map(bid => bid.ttl)) * 1000\n    }),\n  });\n\n  onMinBidCacheTTLChange(() => _auctions.refresh());\n\n  const auctionManager = {\n    onExpiry: _auctions.onExpiry\n  };\n\n  function getAuction(auctionId) {\n    for (const auction of _auctions) {\n      if (auction.getAuctionId() === auctionId) return auction;\n    }\n  }\n\n  auctionManager.addWinningBid = function(bid) {\n    const metrics = useMetrics(bid.metrics);\n    metrics.checkpoint('bidWon');\n    metrics.timeBetween('auctionEnd', 'bidWon', 'adserver.pending');\n    metrics.timeBetween('requestBids', 'bidWon', 'adserver.e2e');\n    const auction = getAuction(bid.auctionId);\n    if (auction) {\n      auction.addWinningBid(bid);\n    } else {\n      logWarn(`Auction not found when adding winning bid`);\n    }\n  };\n\n  Object.entries({\n    getAllWinningBids: {\n      name: 'getWinningBids',\n    },\n    getBidsRequested: {\n      name: 'getBidRequests'\n    },\n    getNoBids: {},\n    getAdUnits: {},\n    getBidsReceived: {\n      pre(auction) {\n        return auction.getAuctionStatus() === AUCTION_COMPLETED;\n      }\n    },\n    getAdUnitCodes: {\n      post: uniques,\n    }\n  }).forEach(([mgrMethod, {name = mgrMethod, pre, post}]) => {\n    const mapper = pre == null\n      ? (auction) => auction[name]()\n      : (auction) => pre(auction) ? auction[name]() : [];\n    const filter = post == null\n      ? (items) => items\n      : (items) => items.filter(post)\n    auctionManager[mgrMethod] = () => {\n      return filter(_auctions.toArray().flatMap(mapper));\n    }\n  })\n\n  function allBidsReceived() {\n    return _auctions.toArray().flatMap(au => au.getBidsReceived())\n  }\n\n  auctionManager.getAllBidsForAdUnitCode = function(adUnitCode) {\n    return allBidsReceived()\n      .filter(bid => bid && bid.adUnitCode === adUnitCode)\n  };\n\n  auctionManager.createAuction = function(opts) {\n    const auction = newAuction(opts);\n    _addAuction(auction);\n    return auction;\n  };\n\n  auctionManager.findBidByAdId = function(adId) {\n    return allBidsReceived()\n      .find(bid => bid.adId === adId);\n  };\n\n  auctionManager.getStandardBidderAdServerTargeting = function() {\n    return getStandardBidderSettings()[JSON_MAPPING.ADSERVER_TARGETING];\n  };\n\n  auctionManager.setStatusForBids = function(adId, status) {\n    let bid = auctionManager.findBidByAdId(adId);\n    if (bid) bid.status = status;\n\n    if (bid && status === BID_STATUS.BID_TARGETING_SET) {\n      const auction = getAuction(bid.auctionId);\n      if (auction) auction.setBidTargeting(bid);\n    }\n  }\n\n  auctionManager.getLastAuctionId = function() {\n    const auctions = _auctions.toArray();\n    return auctions.length && auctions[auctions.length - 1].getAuctionId()\n  };\n\n  auctionManager.clearAllAuctions = function() {\n    _auctions.clear();\n  }\n\n  function _addAuction(auction) {\n    _auctions.add(auction);\n  }\n\n  auctionManager.index = new AuctionIndex(() => _auctions.toArray());\n\n  return auctionManager;\n}\n\nexport const auctionManager = newAuctionManager();\n","import { isArrayOfNums, isInteger, isStr } from './utils.js';\n\n/**\n * List of OpenRTB 2.x banner object properties with simple validators.\n * Not included: `ext`\n * reference: https://github.com/InteractiveAdvertisingBureau/openrtb2.x/blob/main/2.6.md\n */\nexport const ORTB_BANNER_PARAMS = new Map([\n  [ 'format', value => Array.isArray(value) && value.length > 0 && value.every(v => typeof v === 'object') ],\n  [ 'w', isInteger ],\n  [ 'h', isInteger ],\n  [ 'btype', isArrayOfNums ],\n  [ 'battr', isArrayOfNums ],\n  [ 'pos', isInteger ],\n  [ 'mimes', value => Array.isArray(value) && value.length > 0 && value.every(v => typeof v === 'string') ],\n  [ 'topframe', value => [1, 0].includes(value) ],\n  [ 'expdir', isArrayOfNums ],\n  [ 'api', isArrayOfNums ],\n  [ 'id', isStr ],\n  [ 'vcm', value => [1, 0].includes(value) ]\n]);\n","import {config} from './config.js';\nimport {logError} from './utils.js';\nconst CACHE_TTL_SETTING = 'minBidCacheTTL';\nlet TTL_BUFFER = 1;\nlet minCacheTTL = null;\nconst listeners = [];\n\nconfig.getConfig('ttlBuffer', (cfg) => {\n  if (typeof cfg.ttlBuffer === 'number') {\n    TTL_BUFFER = cfg.ttlBuffer;\n  } else {\n    logError('Invalid value for ttlBuffer', cfg.ttlBuffer);\n  }\n})\n\nexport function getBufferedTTL(bid) {\n  return bid.ttl - (bid.hasOwnProperty('ttlBuffer') ? bid.ttlBuffer : TTL_BUFFER);\n}\n\nexport function getMinBidCacheTTL() {\n  return minCacheTTL;\n}\n\nconfig.getConfig(CACHE_TTL_SETTING, (cfg) => {\n  const prev = minCacheTTL;\n  minCacheTTL = cfg?.[CACHE_TTL_SETTING];\n  minCacheTTL = typeof minCacheTTL === 'number' ? minCacheTTL : null;\n  if (prev !== minCacheTTL) {\n    listeners.forEach(l => l(minCacheTTL))\n  }\n})\n\nexport function onMinBidCacheTTLChange(listener) {\n  listeners.push(listener);\n}\n","import {deepAccess, mergeDeep} from './utils.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport { JSON_MAPPING } from './constants.js';\n\nexport class ScopedSettings {\n  constructor(getSettings, defaultScope) {\n    this.getSettings = getSettings;\n    this.defaultScope = defaultScope;\n  }\n\n  /**\n   * Get setting value at `path` under the given scope, falling back to the default scope if needed.\n   * If `scope` is `null`, get the setting's default value.\n   * @param scope {String|null}\n   * @param path {String}\n   * @returns {*}\n   */\n  get(scope, path) {\n    let value = this.getOwn(scope, path);\n    if (typeof value === 'undefined') {\n      value = this.getOwn(null, path);\n    }\n    return value;\n  }\n\n  /**\n   * Get the setting value at `path` *without* falling back to the default value.\n   * @param scope {String}\n   * @param path {String}\n   * @returns {*}\n   */\n  getOwn(scope, path) {\n    scope = this.#resolveScope(scope);\n    return deepAccess(this.getSettings(), `${scope}.${path}`)\n  }\n\n  /**\n   * @returns {string[]} all existing scopes except the default one.\n   */\n  getScopes() {\n    return Object.keys(this.getSettings()).filter((scope) => scope !== this.defaultScope);\n  }\n\n  /**\n   * @returns all settings in the given scope, merged with the settings for the default scope.\n   */\n  settingsFor(scope) {\n    return mergeDeep({}, this.ownSettingsFor(null), this.ownSettingsFor(scope));\n  }\n\n  /**\n   * @returns all settings in the given scope, *without* any of the default settings.\n   */\n  ownSettingsFor(scope) {\n    scope = this.#resolveScope(scope);\n    return this.getSettings()[scope] || {};\n  }\n\n  #resolveScope(scope) {\n    if (scope == null) {\n      return this.defaultScope;\n    } else {\n      return scope;\n    }\n  }\n}\n\nexport const bidderSettings = new ScopedSettings(() => getGlobal().bidderSettings || {}, JSON_MAPPING.BD_SETTING_STANDARD);\n","import { getUniqueIdentifierStr } from './utils.js';\n\n/**\n Required paramaters\n bidderCode,\n height,\n width,\n statusCode\n Optional paramaters\n adId,\n cpm,\n ad,\n adUrl,\n dealId,\n priceKeyString;\n */\nfunction Bid(statusCode, {src = 'client', bidder = '', bidId, transactionId, adUnitId, auctionId} = {}) {\n  var _bidSrc = src;\n  var _statusCode = statusCode || 0;\n\n  Object.assign(this, {\n    bidderCode: bidder,\n    width: 0,\n    height: 0,\n    statusMessage: _getStatus(),\n    adId: getUniqueIdentifierStr(),\n    requestId: bidId,\n    transactionId,\n    adUnitId,\n    auctionId,\n    mediaType: 'banner',\n    source: _bidSrc\n  })\n\n  function _getStatus() {\n    switch (_statusCode) {\n      case 0:\n        return 'Pending';\n      case 1:\n        return 'Bid available';\n      case 2:\n        return 'Bid returned empty or error response';\n      case 3:\n        return 'Bid timed out';\n    }\n  }\n\n  this.getStatusCode = function () {\n    return _statusCode;\n  };\n\n  // returns the size of the bid creative. Concatenation of width and height by ‘x’.\n  this.getSize = function () {\n    return this.width + 'x' + this.height;\n  };\n\n  this.getIdentifiers = function () {\n    return {\n      src: this.source,\n      bidder: this.bidderCode,\n      bidId: this.requestId,\n      transactionId: this.transactionId,\n      adUnitId: this.adUnitId,\n      auctionId: this.auctionId\n    }\n  };\n}\n\n// Bid factory function.\nexport function createBid(statusCode, identifiers) {\n  return new Bid(statusCode, identifiers);\n}\n","/*\n * Module for getting and setting Prebid configuration.\n*/\n\n/**\n * @typedef {Object} MediaTypePriceGranularity\n *\n * @property {(string|Object)} [banner]\n * @property {(string|Object)} [native]\n * @property {(string|Object)} [video]\n * @property {(string|Object)} [video-instream]\n * @property {(string|Object)} [video-outstream]\n */\n\nimport {isValidPriceConfig} from './cpmBucketManager.js';\nimport {arrayFrom as from, find, includes} from './polyfill.js';\nimport {\n  deepAccess,\n  deepClone,\n  getParameterByName,\n  isArray,\n  isBoolean,\n  isPlainObject,\n  isStr,\n  logError,\n  logMessage,\n  logWarn,\n  mergeDeep\n} from './utils.js';\nimport {DEBUG_MODE} from './constants.js';\n\nconst DEFAULT_DEBUG = getParameterByName(DEBUG_MODE).toUpperCase() === 'TRUE';\nconst DEFAULT_BIDDER_TIMEOUT = 3000;\nconst DEFAULT_ENABLE_SEND_ALL_BIDS = true;\nconst DEFAULT_DISABLE_AJAX_TIMEOUT = false;\nconst DEFAULT_BID_CACHE = false;\nconst DEFAULT_DEVICE_ACCESS = true;\nconst DEFAULT_MAX_NESTED_IFRAMES = 10;\nconst DEFAULT_MAXBID_VALUE = 5000\n\nconst DEFAULT_IFRAMES_CONFIG = {};\n\nexport const RANDOM = 'random';\nconst FIXED = 'fixed';\n\nconst VALID_ORDERS = {};\nVALID_ORDERS[RANDOM] = true;\nVALID_ORDERS[FIXED] = true;\n\nconst DEFAULT_BIDDER_SEQUENCE = RANDOM;\n\nconst GRANULARITY_OPTIONS = {\n  LOW: 'low',\n  MEDIUM: 'medium',\n  HIGH: 'high',\n  AUTO: 'auto',\n  DENSE: 'dense',\n  CUSTOM: 'custom'\n};\n\nconst ALL_TOPICS = '*';\n\nfunction attachProperties(config, useDefaultValues = true) {\n  const values = useDefaultValues ? {\n    priceGranularity: GRANULARITY_OPTIONS.MEDIUM,\n    customPriceBucket: {},\n    mediaTypePriceGranularity: {},\n    bidderSequence: DEFAULT_BIDDER_SEQUENCE,\n    auctionOptions: {}\n  } : {}\n\n  function getProp(name) {\n    return values[name];\n  }\n\n  function setProp(name, val) {\n    if (!values.hasOwnProperty(name)) {\n      Object.defineProperty(config, name, {enumerable: true});\n    }\n    values[name] = val;\n  }\n\n  const props = {\n    publisherDomain: {\n      set(val) {\n        if (val != null) {\n          logWarn('publisherDomain is deprecated and has no effect since v7 - use pageUrl instead')\n        }\n        setProp('publisherDomain', val);\n      }\n    },\n    priceGranularity: {\n      set(val) {\n        if (validatePriceGranularity(val)) {\n          if (typeof val === 'string') {\n            setProp('priceGranularity', (hasGranularity(val)) ? val : GRANULARITY_OPTIONS.MEDIUM);\n          } else if (isPlainObject(val)) {\n            setProp('customPriceBucket', val);\n            setProp('priceGranularity', GRANULARITY_OPTIONS.CUSTOM)\n            logMessage('Using custom price granularity');\n          }\n        }\n      }\n    },\n    customPriceBucket: {},\n    mediaTypePriceGranularity: {\n      set(val) {\n        val != null && setProp('mediaTypePriceGranularity', Object.keys(val).reduce((aggregate, item) => {\n          if (validatePriceGranularity(val[item])) {\n            if (typeof val === 'string') {\n              aggregate[item] = (hasGranularity(val[item])) ? val[item] : getProp('priceGranularity');\n            } else if (isPlainObject(val)) {\n              aggregate[item] = val[item];\n              logMessage(`Using custom price granularity for ${item}`);\n            }\n          } else {\n            logWarn(`Invalid price granularity for media type: ${item}`);\n          }\n          return aggregate;\n        }, {}));\n      }\n    },\n    bidderSequence: {\n      set(val) {\n        if (VALID_ORDERS[val]) {\n          setProp('bidderSequence', val);\n        } else {\n          logWarn(`Invalid order: ${val}. Bidder Sequence was not set.`);\n        }\n      }\n    },\n    auctionOptions: {\n      set(val) {\n        if (validateauctionOptions(val)) {\n          setProp('auctionOptions', val);\n        }\n      }\n    }\n  }\n\n  Object.defineProperties(config, Object.fromEntries(\n    Object.entries(props)\n      .map(([k, def]) => [k, Object.assign({\n        get: getProp.bind(null, k),\n        set: setProp.bind(null, k),\n        enumerable: values.hasOwnProperty(k),\n        configurable: !values.hasOwnProperty(k)\n      }, def)])\n  ));\n\n  return config;\n\n  function hasGranularity(val) {\n    return find(Object.keys(GRANULARITY_OPTIONS), option => val === GRANULARITY_OPTIONS[option]);\n  }\n\n  function validatePriceGranularity(val) {\n    if (!val) {\n      logError('Prebid Error: no value passed to `setPriceGranularity()`');\n      return false;\n    }\n    if (typeof val === 'string') {\n      if (!hasGranularity(val)) {\n        logWarn('Prebid Warning: setPriceGranularity was called with invalid setting, using `medium` as default.');\n      }\n    } else if (isPlainObject(val)) {\n      if (!isValidPriceConfig(val)) {\n        logError('Invalid custom price value passed to `setPriceGranularity()`');\n        return false;\n      }\n    }\n    return true;\n  }\n\n  function validateauctionOptions(val) {\n    if (!isPlainObject(val)) {\n      logWarn('Auction Options must be an object')\n      return false\n    }\n\n    for (let k of Object.keys(val)) {\n      if (k !== 'secondaryBidders' && k !== 'suppressStaleRender' && k !== 'suppressExpiredRender') {\n        logWarn(`Auction Options given an incorrect param: ${k}`)\n        return false\n      }\n      if (k === 'secondaryBidders') {\n        if (!isArray(val[k])) {\n          logWarn(`Auction Options ${k} must be of type Array`);\n          return false\n        } else if (!val[k].every(isStr)) {\n          logWarn(`Auction Options ${k} must be only string`);\n          return false\n        }\n      } else if (k === 'suppressStaleRender' || k === 'suppressExpiredRender') {\n        if (!isBoolean(val[k])) {\n          logWarn(`Auction Options ${k} must be of type boolean`);\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n\nexport function newConfig() {\n  let listeners = [];\n  let defaults;\n  let config;\n  let bidderConfig;\n  let currBidder = null;\n\n  function resetConfig() {\n    defaults = {};\n\n    let newConfig = attachProperties({\n      // `debug` is equivalent to legacy `pbjs.logging` property\n      debug: DEFAULT_DEBUG,\n      bidderTimeout: DEFAULT_BIDDER_TIMEOUT,\n      enableSendAllBids: DEFAULT_ENABLE_SEND_ALL_BIDS,\n      useBidCache: DEFAULT_BID_CACHE,\n\n      /**\n       * deviceAccess set to false will disable setCookie, getCookie, hasLocalStorage\n       * @type {boolean}\n       */\n      deviceAccess: DEFAULT_DEVICE_ACCESS,\n\n      disableAjaxTimeout: DEFAULT_DISABLE_AJAX_TIMEOUT,\n\n      // default max nested iframes for referer detection\n      maxNestedIframes: DEFAULT_MAX_NESTED_IFRAMES,\n\n      // default max bid\n      maxBid: DEFAULT_MAXBID_VALUE,\n      userSync: {\n        topics: DEFAULT_IFRAMES_CONFIG\n      }\n    });\n\n    if (config) {\n      callSubscribers(\n        Object.keys(config).reduce((memo, topic) => {\n          if (config[topic] !== newConfig[topic]) {\n            memo[topic] = newConfig[topic] || {};\n          }\n          return memo;\n        },\n        {})\n      );\n    }\n\n    config = newConfig;\n    bidderConfig = {};\n  }\n\n  /**\n   * Returns base config with bidder overrides (if there is currently a bidder)\n   * @private\n   */\n  function _getConfig() {\n    if (currBidder && bidderConfig && isPlainObject(bidderConfig[currBidder])) {\n      let currBidderConfig = bidderConfig[currBidder];\n      const configTopicSet = new Set(Object.keys(config).concat(Object.keys(currBidderConfig)));\n\n      return from(configTopicSet).reduce((memo, topic) => {\n        if (typeof currBidderConfig[topic] === 'undefined') {\n          memo[topic] = config[topic];\n        } else if (typeof config[topic] === 'undefined') {\n          memo[topic] = currBidderConfig[topic];\n        } else {\n          if (isPlainObject(currBidderConfig[topic])) {\n            memo[topic] = mergeDeep({}, config[topic], currBidderConfig[topic]);\n          } else {\n            memo[topic] = currBidderConfig[topic];\n          }\n        }\n        return memo;\n      }, {});\n    }\n    return Object.assign({}, config);\n  }\n\n  function _getRestrictedConfig() {\n    // This causes reading 'ortb2' to throw an error; with prebid 7, that will almost\n    // always be the incorrect way to access FPD configuration (https://github.com/prebid/Prebid.js/issues/7651)\n    // code that needs the ortb2 config should explicitly use `getAnyConfig`\n    // TODO: this is meant as a temporary tripwire to catch inadvertent use of `getConfig('ortb')` as we transition.\n    // It should be removed once the risk of that happening is low enough.\n    const conf = _getConfig();\n    Object.defineProperty(conf, 'ortb2', {\n      get: function () {\n        throw new Error('invalid access to \\'orbt2\\' config - use request parameters instead');\n      }\n    });\n    return conf;\n  }\n\n  const [getAnyConfig, getConfig] = [_getConfig, _getRestrictedConfig].map(accessor => {\n    /*\n     * Returns configuration object if called without parameters,\n     * or single configuration property if given a string matching a configuration\n     * property name.  Allows deep access e.g. getConfig('currency.adServerCurrency')\n     *\n     * If called with callback parameter, or a string and a callback parameter,\n     * subscribes to configuration updates. See `subscribe` function for usage.\n     */\n    return function getConfig(...args) {\n      if (args.length <= 1 && typeof args[0] !== 'function') {\n        const option = args[0];\n        return option ? deepAccess(accessor(), option) : _getConfig();\n      }\n\n      return subscribe(...args);\n    }\n  })\n\n  const [readConfig, readAnyConfig] = [getConfig, getAnyConfig].map(wrapee => {\n    /*\n     * Like getConfig, except that it returns a deepClone of the result.\n     */\n    return function readConfig(...args) {\n      let res = wrapee(...args);\n      if (res && typeof res === 'object') {\n        res = deepClone(res);\n      }\n      return res;\n    }\n  })\n\n  /**\n   * Internal API for modules (such as prebid-server) that might need access to all bidder config\n   */\n  function getBidderConfig() {\n    return bidderConfig;\n  }\n\n  /*\n   * Sets configuration given an object containing key-value pairs and calls\n   * listeners that were added by the `subscribe` function\n   */\n  function setConfig(options) {\n    if (!isPlainObject(options)) {\n      logError('setConfig options must be an object');\n      return;\n    }\n\n    let topics = Object.keys(options);\n    let topicalConfig = {};\n\n    topics.forEach(topic => {\n      let option = options[topic];\n\n      if (isPlainObject(defaults[topic]) && isPlainObject(option)) {\n        option = Object.assign({}, defaults[topic], option);\n      }\n\n      try {\n        topicalConfig[topic] = config[topic] = option;\n      } catch (e) {\n        logWarn(`Cannot set config for property ${topic} : `, e)\n      }\n    });\n\n    callSubscribers(topicalConfig);\n  }\n\n  /**\n   * Sets configuration defaults which setConfig values can be applied on top of\n   * @param {object} options\n   */\n  function setDefaults(options) {\n    if (!isPlainObject(defaults)) {\n      logError('defaults must be an object');\n      return;\n    }\n\n    Object.assign(defaults, options);\n    // Add default values to config as well\n    Object.assign(config, options);\n  }\n\n  /*\n   * Adds a function to a set of listeners that are invoked whenever `setConfig`\n   * is called. The subscribed function will be passed the options object that\n   * was used in the `setConfig` call. Topics can be subscribed to to only get\n   * updates when specific properties are updated by passing a topic string as\n   * the first parameter.\n   *\n   * If `options.init` is true, the listener will be immediately called with the current options.\n   *\n   * Returns an `unsubscribe` function for removing the subscriber from the\n   * set of listeners\n   *\n   * Example use:\n   * // subscribe to all configuration changes\n   * subscribe((config) => console.log('config set:', config));\n   *\n   * // subscribe to only 'logging' changes\n   * subscribe('logging', (config) => console.log('logging set:', config));\n   *\n   * // unsubscribe\n   * const unsubscribe = subscribe(...);\n   * unsubscribe(); // no longer listening\n   *\n   */\n  function subscribe(topic, listener, options = {}) {\n    let callback = listener;\n\n    if (typeof topic !== 'string') {\n      // first param should be callback function in this case,\n      // meaning it gets called for any config change\n      callback = topic;\n      topic = ALL_TOPICS;\n      options = listener || {};\n    }\n\n    if (typeof callback !== 'function') {\n      logError('listener must be a function');\n      return;\n    }\n\n    const nl = { topic, callback };\n    listeners.push(nl);\n\n    if (options.init) {\n      if (topic === ALL_TOPICS) {\n        callback(getConfig());\n      } else {\n        // eslint-disable-next-line standard/no-callback-literal\n        callback({[topic]: getConfig(topic)});\n      }\n    }\n\n    // save and call this function to remove the listener\n    return function unsubscribe() {\n      listeners.splice(listeners.indexOf(nl), 1);\n    };\n  }\n\n  /*\n   * Calls listeners that were added by the `subscribe` function\n   */\n  function callSubscribers(options) {\n    const TOPICS = Object.keys(options);\n\n    // call subscribers of a specific topic, passing only that configuration\n    listeners\n      .filter(listener => includes(TOPICS, listener.topic))\n      .forEach(listener => {\n        listener.callback({ [listener.topic]: options[listener.topic] });\n      });\n\n    // call subscribers that didn't give a topic, passing everything that was set\n    listeners\n      .filter(listener => listener.topic === ALL_TOPICS)\n      .forEach(listener => listener.callback(options));\n  }\n\n  function setBidderConfig(config, mergeFlag = false) {\n    try {\n      check(config);\n      config.bidders.forEach(bidder => {\n        if (!bidderConfig[bidder]) {\n          bidderConfig[bidder] = attachProperties({}, false);\n        }\n        Object.keys(config.config).forEach(topic => {\n          let option = config.config[topic];\n          const currentConfig = bidderConfig[bidder][topic];\n          if (isPlainObject(option) && (currentConfig == null || isPlainObject(currentConfig))) {\n            const func = mergeFlag ? mergeDeep : Object.assign;\n            bidderConfig[bidder][topic] = func({}, currentConfig || {}, option);\n          } else {\n            bidderConfig[bidder][topic] = option;\n          }\n        });\n      });\n    } catch (e) {\n      logError(e);\n    }\n\n    function check(obj) {\n      if (!isPlainObject(obj)) {\n        throw 'setBidderConfig bidder options must be an object';\n      }\n      if (!(Array.isArray(obj.bidders) && obj.bidders.length)) {\n        throw 'setBidderConfig bidder options must contain a bidders list with at least 1 bidder';\n      }\n      if (!isPlainObject(obj.config)) {\n        throw 'setBidderConfig bidder options must contain a config object';\n      }\n    }\n  }\n\n  function mergeConfig(obj) {\n    if (!isPlainObject(obj)) {\n      logError('mergeConfig input must be an object');\n      return;\n    }\n\n    const mergedConfig = mergeDeep(_getConfig(), obj);\n\n    setConfig({ ...mergedConfig });\n    return mergedConfig;\n  }\n\n  function mergeBidderConfig(obj) {\n    return setBidderConfig(obj, true);\n  }\n\n  /**\n   * Internal functions for core to execute some synchronous code while having an active bidder set.\n   */\n  function runWithBidder(bidder, fn) {\n    currBidder = bidder;\n    try {\n      return fn();\n    } finally {\n      resetBidder();\n    }\n  }\n  function callbackWithBidder(bidder) {\n    return function(cb) {\n      return function(...args) {\n        if (typeof cb === 'function') {\n          return runWithBidder(bidder, cb.bind(this, ...args))\n        } else {\n          logWarn('config.callbackWithBidder callback is not a function');\n        }\n      }\n    }\n  }\n\n  function getCurrentBidder() {\n    return currBidder;\n  }\n\n  function resetBidder() {\n    currBidder = null;\n  }\n\n  resetConfig();\n\n  return {\n    getCurrentBidder,\n    resetBidder,\n    getConfig,\n    getAnyConfig,\n    readConfig,\n    readAnyConfig,\n    setConfig,\n    mergeConfig,\n    setDefaults,\n    resetConfig,\n    runWithBidder,\n    callbackWithBidder,\n    setBidderConfig,\n    getBidderConfig,\n    mergeBidderConfig,\n  };\n}\n\n/**\n * Set a `cache.url` if we should use prebid-cache to store video bids before adding bids to the auction.\n * This must be set if you want to use the dfpAdServerVideo module.\n */\nexport const config = newConfig();\n","import {cyrb53Hash, isStr, timestamp} from './utils.js';\nimport {defer, GreedyPromise} from './utils/promise.js';\nimport {config} from './config.js';\n\n/**\n * Placeholder gvlid for when vendor consent is not required. When this value is used as gvlid, the gdpr\n * enforcement module will take it to mean \"vendor consent was given\".\n *\n * see https://github.com/prebid/Prebid.js/issues/8161\n */\nexport const VENDORLESS_GVLID = Object.freeze({});\n\nexport class ConsentHandler {\n  #enabled;\n  #data;\n  #defer;\n  #ready;\n  #dirty = true;\n  #hash;\n  generatedTime;\n  hashFields;\n\n  constructor() {\n    this.reset();\n  }\n\n  #resolve(data) {\n    this.#ready = true;\n    this.#data = data;\n    this.#defer.resolve(data);\n  }\n\n  /**\n   * reset this handler (mainly for tests)\n   */\n  reset() {\n    this.#defer = defer();\n    this.#enabled = false;\n    this.#data = null;\n    this.#ready = false;\n    this.generatedTime = null;\n  }\n\n  /**\n   * Enable this consent handler. This should be called by the relevant consent management module\n   * on initialization.\n   */\n  enable() {\n    this.#enabled = true;\n  }\n\n  /**\n   * @returns {boolean} true if the related consent management module is enabled.\n   */\n  get enabled() {\n    return this.#enabled;\n  }\n\n  /**\n   * @returns {boolean} true if consent data has been resolved (it may be `null` if the resolution failed).\n   */\n  get ready() {\n    return this.#ready;\n  }\n\n  /**\n   * @returns a promise than resolves to the consent data, or null if no consent data is available\n   */\n  get promise() {\n    if (this.#ready) {\n      return GreedyPromise.resolve(this.#data);\n    }\n    if (!this.#enabled) {\n      this.#resolve(null);\n    }\n    return this.#defer.promise;\n  }\n\n  setConsentData(data, time = timestamp()) {\n    this.generatedTime = time;\n    this.#dirty = true;\n    this.#resolve(data);\n  }\n\n  getConsentData() {\n    return this.#data;\n  }\n\n  get hash() {\n    if (this.#dirty) {\n      this.#hash = cyrb53Hash(JSON.stringify(this.#data && this.hashFields ? this.hashFields.map(f => this.#data[f]) : this.#data))\n      this.#dirty = false;\n    }\n    return this.#hash;\n  }\n}\n\nclass UspConsentHandler extends ConsentHandler {\n  getConsentMeta() {\n    const consentData = this.getConsentData();\n    if (consentData && this.generatedTime) {\n      return {\n        generatedAt: this.generatedTime\n      };\n    }\n  }\n}\n\nclass GdprConsentHandler extends ConsentHandler {\n  hashFields = ['gdprApplies', 'consentString']\n  getConsentMeta() {\n    const consentData = this.getConsentData();\n    if (consentData && consentData.vendorData && this.generatedTime) {\n      return {\n        gdprApplies: consentData.gdprApplies,\n        consentStringSize: (isStr(consentData.vendorData.tcString)) ? consentData.vendorData.tcString.length : 0,\n        generatedAt: this.generatedTime,\n        apiVersion: consentData.apiVersion\n      }\n    }\n  }\n}\n\nclass GppConsentHandler extends ConsentHandler {\n  hashFields = ['applicableSections', 'gppString'];\n  getConsentMeta() {\n    const consentData = this.getConsentData();\n    if (consentData && this.generatedTime) {\n      return {\n        generatedAt: this.generatedTime,\n      }\n    }\n  }\n}\n\nexport function gvlidRegistry() {\n  const registry = {};\n  const flat = {};\n  const none = {};\n  return {\n    /**\n     * Register a module's GVL ID.\n     * @param {string} moduleType defined in `activities/modules.js`\n     * @param {string} moduleName\n     * @param {number} gvlid\n     */\n    register(moduleType, moduleName, gvlid) {\n      if (gvlid) {\n        (registry[moduleName] = registry[moduleName] || {})[moduleType] = gvlid;\n        if (flat.hasOwnProperty(moduleName)) {\n          if (flat[moduleName] !== gvlid) flat[moduleName] = none;\n        } else {\n          flat[moduleName] = gvlid;\n        }\n      }\n    },\n    /**\n     * @typedef {Object} GvlIdResult\n     * @property {Object.<string, number>} modules - A map from module type to that module's GVL ID.\n     * @property {number} [gvlid] - The single GVL ID for this family of modules (only defined if all modules with this name declared the same ID).\n     */\n\n    /**\n     * Get a module's GVL ID(s).\n     *\n     * @param {string} moduleName - The name of the module.\n     * @return {GvlIdResult} An object where:\n     *   `modules` is a map from module type to that module's GVL ID;\n     *   `gvlid` is the single GVL ID for this family of modules (only defined if all modules with this name declare the same ID).\n     */\n    get(moduleName) {\n      const result = {modules: registry[moduleName] || {}};\n      if (flat.hasOwnProperty(moduleName) && flat[moduleName] !== none) {\n        result.gvlid = flat[moduleName];\n      }\n      return result;\n    }\n  }\n}\n\nexport const gdprDataHandler = new GdprConsentHandler();\nexport const uspDataHandler = new UspConsentHandler();\nexport const gppDataHandler = new GppConsentHandler();\nexport const coppaDataHandler = (() => {\n  function getCoppa() {\n    return !!(config.getConfig('coppa'))\n  }\n  return {\n    getCoppa,\n    getConsentData: getCoppa,\n    getConsentMeta: getCoppa,\n    reset() {},\n    get promise() {\n      return GreedyPromise.resolve(getCoppa())\n    },\n    get hash() {\n      return getCoppa() ? '1' : '0'\n    }\n  }\n})();\n\nexport const GDPR_GVLIDS = gvlidRegistry();\n\nconst ALL_HANDLERS = {\n  gdpr: gdprDataHandler,\n  usp: uspDataHandler,\n  gpp: gppDataHandler,\n  coppa: coppaDataHandler,\n}\n\nexport function multiHandler(handlers = ALL_HANDLERS) {\n  handlers = Object.entries(handlers);\n  function collector(method) {\n    return function () {\n      return Object.fromEntries(handlers.map(([name, handler]) => [name, handler[method]()]))\n    }\n  }\n  return Object.assign(\n    {\n      get promise() {\n        return GreedyPromise.all(handlers.map(([name, handler]) => handler.promise.then(val => [name, val])))\n          .then(entries => Object.fromEntries(entries));\n      },\n      get hash() {\n        return cyrb53Hash(handlers.map(([_, handler]) => handler.hash).join(':'));\n      }\n    },\n    Object.fromEntries(['getConsentData', 'getConsentMeta', 'reset'].map(n => [n, collector(n)])),\n  )\n}\n\nexport const allConsent = multiHandler();\n","export const JSON_MAPPING = {\n  PL_CODE: 'code',\n  PL_SIZE: 'sizes',\n  PL_BIDS: 'bids',\n  BD_BIDDER: 'bidder',\n  BD_ID: 'paramsd',\n  BD_PL_ID: 'placementId',\n  ADSERVER_TARGETING: 'adserverTargeting',\n  BD_SETTING_STANDARD: 'standard'\n};\n\nexport const DEBUG_MODE = 'pbjs_debug';\n\nexport const STATUS = {\n  GOOD: 1\n};\n\nexport const EVENTS = {\n  AUCTION_INIT: 'auctionInit',\n  AUCTION_TIMEOUT: 'auctionTimeout',\n  AUCTION_END: 'auctionEnd',\n  BID_ADJUSTMENT: 'bidAdjustment',\n  BID_TIMEOUT: 'bidTimeout',\n  BID_REQUESTED: 'bidRequested',\n  BID_RESPONSE: 'bidResponse',\n  BID_REJECTED: 'bidRejected',\n  NO_BID: 'noBid',\n  SEAT_NON_BID: 'seatNonBid',\n  BID_WON: 'bidWon',\n  BIDDER_DONE: 'bidderDone',\n  BIDDER_ERROR: 'bidderError',\n  SET_TARGETING: 'setTargeting',\n  BEFORE_REQUEST_BIDS: 'beforeRequestBids',\n  BEFORE_BIDDER_HTTP: 'beforeBidderHttp',\n  REQUEST_BIDS: 'requestBids',\n  ADD_AD_UNITS: 'addAdUnits',\n  AD_RENDER_FAILED: 'adRenderFailed',\n  AD_RENDER_SUCCEEDED: 'adRenderSucceeded',\n  TCF2_ENFORCEMENT: 'tcf2Enforcement',\n  AUCTION_DEBUG: 'auctionDebug',\n  BID_VIEWABLE: 'bidViewable',\n  STALE_RENDER: 'staleRender',\n  EXPIRED_RENDER: 'expiredRender',\n  BILLABLE_EVENT: 'billableEvent',\n  BID_ACCEPTED: 'bidAccepted',\n  RUN_PAAPI_AUCTION: 'paapiRunAuction',\n  PBS_ANALYTICS: 'pbsAnalytics',\n  PAAPI_BID: 'paapiBid',\n  PAAPI_NO_BID: 'paapiNoBid',\n  PAAPI_ERROR: 'paapiError',\n};\n\nexport const AD_RENDER_FAILED_REASON = {\n  PREVENT_WRITING_ON_MAIN_DOCUMENT: 'preventWritingOnMainDocument',\n  NO_AD: 'noAd',\n  EXCEPTION: 'exception',\n  CANNOT_FIND_AD: 'cannotFindAd',\n  MISSING_DOC_OR_ADID: 'missingDocOrAdid'\n};\n\nexport const EVENT_ID_PATHS = {\n  bidWon: 'adUnitCode'\n};\n\nexport const GRANULARITY_OPTIONS = {\n  LOW: 'low',\n  MEDIUM: 'medium',\n  HIGH: 'high',\n  AUTO: 'auto',\n  DENSE: 'dense',\n  CUSTOM: 'custom'\n};\n\nexport const TARGETING_KEYS = {\n  BIDDER: 'hb_bidder',\n  AD_ID: 'hb_adid',\n  PRICE_BUCKET: 'hb_pb',\n  SIZE: 'hb_size',\n  DEAL: 'hb_deal',\n  SOURCE: 'hb_source',\n  FORMAT: 'hb_format',\n  UUID: 'hb_uuid',\n  CACHE_ID: 'hb_cache_id',\n  CACHE_HOST: 'hb_cache_host',\n  ADOMAIN: 'hb_adomain',\n  ACAT: 'hb_acat',\n  CRID: 'hb_crid',\n  DSP: 'hb_dsp'\n};\n\nexport const DEFAULT_TARGETING_KEYS = {\n  BIDDER: 'hb_bidder',\n  AD_ID: 'hb_adid',\n  PRICE_BUCKET: 'hb_pb',\n  SIZE: 'hb_size',\n  DEAL: 'hb_deal',\n  FORMAT: 'hb_format',\n  UUID: 'hb_uuid',\n  CACHE_HOST: 'hb_cache_host'\n};\n\nexport const NATIVE_KEYS = {\n  title: 'hb_native_title',\n  body: 'hb_native_body',\n  body2: 'hb_native_body2',\n  privacyLink: 'hb_native_privacy',\n  privacyIcon: 'hb_native_privicon',\n  sponsoredBy: 'hb_native_brand',\n  image: 'hb_native_image',\n  icon: 'hb_native_icon',\n  clickUrl: 'hb_native_linkurl',\n  displayUrl: 'hb_native_displayurl',\n  cta: 'hb_native_cta',\n  rating: 'hb_native_rating',\n  address: 'hb_native_address',\n  downloads: 'hb_native_downloads',\n  likes: 'hb_native_likes',\n  phone: 'hb_native_phone',\n  price: 'hb_native_price',\n  salePrice: 'hb_native_saleprice',\n  rendererUrl: 'hb_renderer_url',\n  adTemplate: 'hb_adTemplate'\n};\n\nexport const S2S = {\n  SRC: 's2s',\n  DEFAULT_ENDPOINT: 'https://prebid.adnxs.com/pbs/v1/openrtb2/auction',\n  SYNCED_BIDDERS_KEY: 'pbjsSyncs'\n};\n\nexport const BID_STATUS = {\n  BID_TARGETING_SET: 'targetingSet',\n  RENDERED: 'rendered',\n  BID_REJECTED: 'bidRejected'\n};\n\nexport const REJECTION_REASON = {\n  INVALID: 'Bid has missing or invalid properties',\n  INVALID_REQUEST_ID: 'Invalid request ID',\n  BIDDER_DISALLOWED: 'Bidder code is not allowed by allowedAlternateBidderCodes / allowUnknownBidderCodes',\n  FLOOR_NOT_MET: 'Bid does not meet price floor',\n  CANNOT_CONVERT_CURRENCY: 'Unable to convert currency',\n  DSA_REQUIRED: 'Bid does not provide required DSA transparency info',\n  DSA_MISMATCH: 'Bid indicates inappropriate DSA rendering method',\n  PRICE_TOO_HIGH: 'Bid price exceeds maximum value'\n};\n\nexport const PREBID_NATIVE_DATA_KEYS_TO_ORTB = {\n  body: 'desc',\n  body2: 'desc2',\n  sponsoredBy: 'sponsored',\n  cta: 'ctatext',\n  rating: 'rating',\n  address: 'address',\n  downloads: 'downloads',\n  likes: 'likes',\n  phone: 'phone',\n  price: 'price',\n  salePrice: 'saleprice',\n  displayUrl: 'displayurl'\n};\n\nexport const NATIVE_ASSET_TYPES = {\n  sponsored: 1,\n  desc: 2,\n  rating: 3,\n  likes: 4,\n  downloads: 5,\n  price: 6,\n  saleprice: 7,\n  phone: 8,\n  address: 9,\n  desc2: 10,\n  displayurl: 11,\n  ctatext: 12\n};\n\nexport const NATIVE_IMAGE_TYPES = {\n  ICON: 1,\n  MAIN: 3\n};\n\nexport const NATIVE_KEYS_THAT_ARE_NOT_ASSETS = [\n  'privacyIcon',\n  'clickUrl',\n  'sendTargetingKeys',\n  'adTemplate',\n  'rendererUrl',\n  'type'\n];\n\nexport const MESSAGES = {\n  REQUEST: 'Prebid Request',\n  RESPONSE: 'Prebid Response',\n  NATIVE: 'Prebid Native',\n  EVENT: 'Prebid Event'\n};\n\nexport const PB_LOCATOR = '__pb_locator__';\n","import {find} from './polyfill.js';\nimport { isEmpty, logWarn } from './utils.js';\nimport { config } from './config.js';\n\nconst _defaultPrecision = 2;\nconst _lgPriceConfig = {\n  'buckets': [{\n    'max': 5,\n    'increment': 0.5\n  }]\n};\nconst _mgPriceConfig = {\n  'buckets': [{\n    'max': 20,\n    'increment': 0.1\n  }]\n};\nconst _hgPriceConfig = {\n  'buckets': [{\n    'max': 20,\n    'increment': 0.01\n  }]\n};\nconst _densePriceConfig = {\n  'buckets': [{\n    'max': 3,\n    'increment': 0.01\n  },\n  {\n    'max': 8,\n    'increment': 0.05\n  },\n  {\n    'max': 20,\n    'increment': 0.5\n  }]\n};\nconst _autoPriceConfig = {\n  'buckets': [{\n    'max': 5,\n    'increment': 0.05\n  },\n  {\n    'max': 10,\n    'increment': 0.1\n  },\n  {\n    'max': 20,\n    'increment': 0.5\n  }]\n};\n\nfunction getPriceBucketString(cpm, customConfig, granularityMultiplier = 1) {\n  let cpmFloat = parseFloat(cpm);\n  if (isNaN(cpmFloat)) {\n    cpmFloat = '';\n  }\n\n  return {\n    low: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _lgPriceConfig, granularityMultiplier),\n    med: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _mgPriceConfig, granularityMultiplier),\n    high: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _hgPriceConfig, granularityMultiplier),\n    auto: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _autoPriceConfig, granularityMultiplier),\n    dense: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _densePriceConfig, granularityMultiplier),\n    custom: (cpmFloat === '') ? '' : getCpmStringValue(cpm, customConfig, granularityMultiplier)\n  };\n}\n\nfunction getCpmStringValue(cpm, config, granularityMultiplier) {\n  let cpmStr = '';\n  if (!isValidPriceConfig(config)) {\n    return cpmStr;\n  }\n  const cap = config.buckets.reduce((prev, curr) => {\n    if (prev.max > curr.max) {\n      return prev;\n    }\n    return curr;\n  }, {\n    'max': 0,\n  });\n\n  let bucketFloor = 0;\n  let bucket = find(config.buckets, bucket => {\n    if (cpm > cap.max * granularityMultiplier) {\n      // cpm exceeds cap, just return the cap.\n      let precision = bucket.precision;\n      if (typeof precision === 'undefined') {\n        precision = _defaultPrecision;\n      }\n      cpmStr = (bucket.max * granularityMultiplier).toFixed(precision);\n    } else if (cpm <= bucket.max * granularityMultiplier && cpm >= bucketFloor * granularityMultiplier) {\n      bucket.min = bucketFloor;\n      return bucket;\n    } else {\n      bucketFloor = bucket.max;\n    }\n  });\n  if (bucket) {\n    cpmStr = getCpmTarget(cpm, bucket, granularityMultiplier);\n  }\n  return cpmStr;\n}\n\nfunction isValidPriceConfig(config) {\n  if (isEmpty(config) || !config.buckets || !Array.isArray(config.buckets)) {\n    return false;\n  }\n  let isValid = true;\n  config.buckets.forEach(bucket => {\n    if (!bucket.max || !bucket.increment) {\n      isValid = false;\n    }\n  });\n  return isValid;\n}\n\nfunction getCpmTarget(cpm, bucket, granularityMultiplier) {\n  const precision = typeof bucket.precision !== 'undefined' ? bucket.precision : _defaultPrecision;\n  const increment = bucket.increment * granularityMultiplier;\n  const bucketMin = bucket.min * granularityMultiplier;\n  let roundingFunction = Math.floor;\n  let customRoundingFunction = config.getConfig('cpmRoundingFunction');\n  if (typeof customRoundingFunction === 'function') {\n    roundingFunction = customRoundingFunction;\n  }\n\n  // start increments at the bucket min and then add bucket min back to arrive at the correct rounding\n  // note - we're padding the values to avoid using decimals in the math prior to flooring\n  // this is done as JS can return values slightly below the expected mark which would skew the price bucket target\n  //   (eg 4.01 / 0.01 = 400.99999999999994)\n  // min precison should be 2 to move decimal place over.\n  let pow = Math.pow(10, precision + 2);\n  let cpmToRound = ((cpm * pow) - (bucketMin * pow)) / (increment * pow);\n  let cpmTarget;\n  let invalidRounding;\n  // It is likely that we will be passed {cpmRoundingFunction: roundingFunction()}\n  // rather than the expected {cpmRoundingFunction: roundingFunction}. Default back to floor in that case\n  try {\n    cpmTarget = (roundingFunction(cpmToRound) * increment) + bucketMin;\n  } catch (err) {\n    invalidRounding = true;\n  }\n  if (invalidRounding || typeof cpmTarget !== 'number') {\n    logWarn('Invalid rounding function passed in config');\n    cpmTarget = (Math.floor(cpmToRound) * increment) + bucketMin;\n  }\n  // force to 10 decimal places to deal with imprecise decimal/binary conversions\n  //    (for example 0.1 * 3 = 0.30000000000000004)\n\n  cpmTarget = Number(cpmTarget.toFixed(10));\n  return cpmTarget.toFixed(precision);\n}\n\nexport { getPriceBucketString, isValidPriceConfig };\n","import {GreedyPromise} from './utils/promise.js';\nimport {createInvisibleIframe} from './utils.js';\nimport {RENDERER} from '../libraries/creative-renderer-display/renderer.js';\nimport {hook} from './hook.js';\n\nexport const getCreativeRendererSource = hook('sync', function (bidResponse) {\n  return RENDERER;\n})\n\nexport const getCreativeRenderer = (function() {\n  const renderers = {};\n  return function (bidResponse) {\n    const src = getCreativeRendererSource(bidResponse);\n    if (!renderers.hasOwnProperty(src)) {\n      renderers[src] = new GreedyPromise((resolve) => {\n        const iframe = createInvisibleIframe();\n        iframe.srcdoc = `<script>${src}</script>`;\n        iframe.onload = () => resolve(iframe.contentWindow.render);\n        document.body.appendChild(iframe);\n      })\n    }\n    return renderers[src];\n  }\n})();\n","import {config} from './config.js';\nimport {getHook, hook} from './hook.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport {logMessage, prefixLog} from './utils.js';\nimport {createBid} from './bidfactory.js';\nimport {loadExternalScript} from './adloader.js';\nimport {GreedyPromise} from './utils/promise.js';\nimport { MODULE_TYPE_PREBID } from './activities/modules.js';\n\nexport const DEBUG_KEY = '__$$PREBID_GLOBAL$$_debugging__';\n\nfunction isDebuggingInstalled() {\n  return getGlobal().installedModules.includes('debugging');\n}\n\nfunction loadScript(url) {\n  return new GreedyPromise((resolve) => {\n    loadExternalScript(url, MODULE_TYPE_PREBID, 'debugging', resolve);\n  });\n}\n\nexport function debuggingModuleLoader({alreadyInstalled = isDebuggingInstalled, script = loadScript} = {}) {\n  let loading = null;\n  return function () {\n    if (loading == null) {\n      loading = new GreedyPromise((resolve, reject) => {\n        // run this in a 0-delay timeout to give installedModules time to be populated\n        setTimeout(() => {\n          if (alreadyInstalled()) {\n            resolve();\n          } else {\n            const url = '$$PREBID_DIST_URL_BASE$$debugging-standalone.js';\n            logMessage(`Debugging module not installed, loading it from \"${url}\"...`);\n            getGlobal()._installDebugging = true;\n            script(url).then(() => {\n              getGlobal()._installDebugging({DEBUG_KEY, hook, config, createBid, logger: prefixLog('DEBUG:')});\n            }).then(resolve, reject);\n          }\n        });\n      })\n    }\n    return loading;\n  }\n}\n\nexport function debuggingControls({load = debuggingModuleLoader(), hook = getHook('requestBids')} = {}) {\n  let promise = null;\n  let enabled = false;\n  function waitForDebugging(next, ...args) {\n    return (promise || GreedyPromise.resolve()).then(() => next.apply(this, args))\n  }\n  function enable() {\n    if (!enabled) {\n      promise = load();\n      // set debugging to high priority so that it has the opportunity to mess with most things\n      hook.before(waitForDebugging, 99);\n      enabled = true;\n    }\n  }\n  function disable() {\n    hook.getHooks({hook: waitForDebugging}).remove();\n    enabled = false;\n  }\n  function reset() {\n    promise = null;\n    disable();\n  }\n  return {enable, disable, reset};\n}\n\nconst ctl = debuggingControls();\nexport const reset = ctl.reset;\n\nexport function loadSession() {\n  let storage = null;\n  try {\n    // eslint-disable-next-line prebid/no-global\n    storage = window.sessionStorage;\n  } catch (e) {}\n\n  if (storage !== null) {\n    let debugging = ctl;\n    let config = null;\n    try {\n      config = storage.getItem(DEBUG_KEY);\n    } catch (e) {}\n    if (config !== null) {\n      // just make sure the module runs; it will take care of parsing the config (and disabling itself if necessary)\n      debugging.enable();\n    }\n  }\n}\n\nconfig.getConfig('debugging', function ({debugging}) {\n  debugging?.enabled ? ctl.enable() : ctl.disable();\n});\n","/**\n * events.js\n */\nimport * as utils from './utils.js'\nimport { EVENTS, EVENT_ID_PATHS } from './constants.js';\nimport {ttlCollection} from './utils/ttlCollection.js';\nimport {config} from './config.js';\nconst TTL_CONFIG = 'eventHistoryTTL';\n\nlet eventTTL = null;\n\n// keep a record of all events fired\nconst eventsFired = ttlCollection({\n  monotonic: true,\n  ttl: () => eventTTL,\n})\n\nconfig.getConfig(TTL_CONFIG, (val) => {\n  const previous = eventTTL;\n  val = val?.[TTL_CONFIG];\n  eventTTL = typeof val === 'number' ? val * 1000 : null;\n  if (previous !== eventTTL) {\n    eventsFired.refresh();\n  }\n});\n\nlet slice = Array.prototype.slice;\nlet push = Array.prototype.push;\n\n// define entire events\nlet allEvents = Object.values(EVENTS);\n\nconst idPaths = EVENT_ID_PATHS;\n\nconst _public = (function () {\n  let _handlers = {};\n  let _public = {};\n\n  /**\n   *\n   * @param {String} eventString  The name of the event.\n   * @param {Array} args  The payload emitted with the event.\n   * @private\n   */\n  function _dispatch(eventString, args) {\n    utils.logMessage('Emitting event for: ' + eventString);\n\n    let eventPayload = args[0] || {};\n    let idPath = idPaths[eventString];\n    let key = eventPayload[idPath];\n    let event = _handlers[eventString] || { que: [] };\n    var eventKeys = Object.keys(event);\n\n    let callbacks = [];\n\n    // record the event:\n    eventsFired.add({\n      eventType: eventString,\n      args: eventPayload,\n      id: key,\n      elapsedTime: utils.getPerformanceNow(),\n    });\n\n    /**\n     * Push each specific callback to the `callbacks` array.\n     * If the `event` map has a key that matches the value of the\n     * event payload id path, e.g. `eventPayload[idPath]`, then apply\n     * each function in the `que` array as an argument to push to the\n     * `callbacks` array\n     */\n    if (key && eventKeys.includes(key)) {\n      push.apply(callbacks, event[key].que);\n    }\n\n    /** Push each general callback to the `callbacks` array. */\n    push.apply(callbacks, event.que);\n\n    /** call each of the callbacks */\n    (callbacks || []).forEach(function (fn) {\n      if (!fn) return;\n      try {\n        fn.apply(null, args);\n      } catch (e) {\n        utils.logError('Error executing handler:', 'events.js', e, eventString);\n      }\n    });\n  }\n\n  function _checkAvailableEvent(event) {\n    return allEvents.includes(event)\n  }\n\n  _public.has = _checkAvailableEvent;\n\n  _public.on = function (eventString, handler, id) {\n    // check whether available event or not\n    if (_checkAvailableEvent(eventString)) {\n      let event = _handlers[eventString] || { que: [] };\n\n      if (id) {\n        event[id] = event[id] || { que: [] };\n        event[id].que.push(handler);\n      } else {\n        event.que.push(handler);\n      }\n\n      _handlers[eventString] = event;\n    } else {\n      utils.logError('Wrong event name : ' + eventString + ' Valid event names :' + allEvents);\n    }\n  };\n\n  _public.emit = function (event) {\n    let args = slice.call(arguments, 1);\n    _dispatch(event, args);\n  };\n\n  _public.off = function (eventString, handler, id) {\n    let event = _handlers[eventString];\n\n    if (utils.isEmpty(event) || (utils.isEmpty(event.que) && utils.isEmpty(event[id]))) {\n      return;\n    }\n\n    if (id && (utils.isEmpty(event[id]) || utils.isEmpty(event[id].que))) {\n      return;\n    }\n\n    if (id) {\n      (event[id].que || []).forEach(function (_handler) {\n        let que = event[id].que;\n        if (_handler === handler) {\n          que.splice(que.indexOf(_handler), 1);\n        }\n      });\n    } else {\n      (event.que || []).forEach(function (_handler) {\n        let que = event.que;\n        if (_handler === handler) {\n          que.splice(que.indexOf(_handler), 1);\n        }\n      });\n    }\n\n    _handlers[eventString] = event;\n  };\n\n  _public.get = function () {\n    return _handlers;\n  };\n\n  _public.addEvents = function (events) {\n    allEvents = allEvents.concat(events);\n  }\n\n  /**\n   * This method can return a copy of all the events fired\n   * @return {Array} array of events fired\n   */\n  _public.getEvents = function () {\n    return eventsFired.toArray().map(val => Object.assign({}, val))\n  };\n\n  return _public;\n}());\n\nutils._setEventEmitter(_public.emit.bind(_public));\n\nexport const {on, off, get, getEvents, emit, addEvents, has} = _public;\n\nexport function clearEvents() {\n  eventsFired.clear();\n}\n","import {hook} from '../hook.js';\nimport {getRefererInfo, parseDomain} from '../refererDetection.js';\nimport {findRootDomain} from './rootDomain.js';\nimport {deepSetValue, getDefinedParams, getDNT, getWindowSelf, getWindowTop, mergeDeep} from '../utils.js';\nimport {config} from '../config.js';\nimport {getHighEntropySUA, getLowEntropySUA} from './sua.js';\nimport {GreedyPromise} from '../utils/promise.js';\nimport {CLIENT_SECTIONS, clientSectionChecker, hasSection} from './oneClient.js';\nimport {isActivityAllowed} from '../activities/rules.js';\nimport {activityParams} from '../activities/activityParams.js';\nimport {ACTIVITY_ACCESS_DEVICE} from '../activities/activities.js';\nimport {MODULE_TYPE_PREBID} from '../activities/modules.js';\n\nexport const dep = {\n  getRefererInfo,\n  findRootDomain,\n  getWindowTop,\n  getWindowSelf,\n  getHighEntropySUA,\n  getLowEntropySUA,\n};\n\nconst oneClient = clientSectionChecker('FPD')\n\n/**\n * Enrich an ortb2 object with first-party data.\n * @param {Promise<Object>} fpd - A promise that resolves to an ortb2 object.\n * @returns {Promise<Object>} - A promise that resolves to an enriched ortb2 object.\n */\nexport const enrichFPD = hook('sync', (fpd) => {\n  const promArr = [fpd, getSUA().catch(() => null), tryToGetCdepLabel().catch(() => null)];\n\n  return GreedyPromise.all(promArr)\n    .then(([ortb2, sua, cdep]) => {\n      const ri = dep.getRefererInfo();\n      Object.entries(ENRICHMENTS).forEach(([section, getEnrichments]) => {\n        const data = getEnrichments(ortb2, ri);\n        if (data && Object.keys(data).length > 0) {\n          ortb2[section] = mergeDeep({}, data, ortb2[section]);\n        }\n      });\n\n      if (sua) {\n        deepSetValue(ortb2, 'device.sua', Object.assign({}, sua, ortb2.device.sua));\n      }\n\n      if (cdep) {\n        const ext = {\n          cdep\n        }\n        deepSetValue(ortb2, 'device.ext', Object.assign({}, ext, ortb2.device.ext));\n      }\n\n      ortb2 = oneClient(ortb2);\n      for (let section of CLIENT_SECTIONS) {\n        if (hasSection(ortb2, section)) {\n          ortb2[section] = mergeDeep({}, clientEnrichment(ortb2, ri), ortb2[section]);\n          break;\n        }\n      }\n\n      return ortb2;\n    });\n});\n\nfunction winFallback(fn) {\n  try {\n    return fn(dep.getWindowTop());\n  } catch (e) {\n    return fn(dep.getWindowSelf());\n  }\n}\n\nfunction getSUA() {\n  const hints = config.getConfig('firstPartyData.uaHints');\n  return !Array.isArray(hints) || hints.length === 0\n    ? GreedyPromise.resolve(dep.getLowEntropySUA())\n    : dep.getHighEntropySUA(hints);\n}\n\nfunction removeUndef(obj) {\n  return getDefinedParams(obj, Object.keys(obj))\n}\n\nfunction tryToGetCdepLabel() {\n  return GreedyPromise.resolve('cookieDeprecationLabel' in navigator && isActivityAllowed(ACTIVITY_ACCESS_DEVICE, activityParams(MODULE_TYPE_PREBID, 'cdep')) && navigator.cookieDeprecationLabel.getValue());\n}\n\nconst ENRICHMENTS = {\n  site(ortb2, ri) {\n    if (CLIENT_SECTIONS.filter(p => p !== 'site').some(hasSection.bind(null, ortb2))) {\n      // do not enrich site if dooh or app are set\n      return;\n    }\n    return removeUndef({\n      page: ri.page,\n      ref: ri.ref,\n    });\n  },\n  device() {\n    return winFallback((win) => {\n      // screen.width and screen.height are the physical dimensions of the screen\n      const w = win.screen.width;\n      const h = win.screen.height;\n\n      // vpw and vph are the viewport dimensions of the browser window\n      const vpw = win.innerWidth || win.document.documentElement.clientWidth || win.document.body.clientWidth;\n      const vph = win.innerHeight || win.document.documentElement.clientHeight || win.document.body.clientHeight;\n\n      const device = {\n        w,\n        h,\n        dnt: getDNT() ? 1 : 0,\n        ua: win.navigator.userAgent,\n        language: win.navigator.language.split('-').shift(),\n        ext: {\n          vpw,\n          vph,\n        },\n      };\n\n      if (win.navigator?.webdriver) {\n        deepSetValue(device, 'ext.webdriver', true);\n      }\n\n      return device;\n    })\n  },\n  regs() {\n    const regs = {};\n    if (winFallback((win) => win.navigator.globalPrivacyControl)) {\n      deepSetValue(regs, 'ext.gpc', '1');\n    }\n    const coppa = config.getConfig('coppa');\n    if (typeof coppa === 'boolean') {\n      regs.coppa = coppa ? 1 : 0;\n    }\n    return regs;\n  }\n};\n\n// Enrichment of properties common across dooh, app and site - will be dropped into whatever\n// section is appropriate\nfunction clientEnrichment(ortb2, ri) {\n  const domain = parseDomain(ri.page, {noLeadingWww: true});\n  const keywords = winFallback((win) => win.document.querySelector('meta[name=\\'keywords\\']'))\n    ?.content?.replace?.(/\\s/g, '');\n  return removeUndef({\n    domain,\n    keywords,\n    publisher: removeUndef({\n      domain: dep.findRootDomain(domain)\n    })\n  })\n}\n","import {logWarn} from '../utils.js';\n\n// mutually exclusive ORTB sections in order of priority - 'dooh' beats 'app' & 'site' and 'app' beats 'site';\n// if one is set, the others will be removed\nexport const CLIENT_SECTIONS = ['dooh', 'app', 'site']\n\nexport function clientSectionChecker(logPrefix) {\n  return function onlyOneClientSection(ortb2) {\n    CLIENT_SECTIONS.reduce((found, section) => {\n      if (hasSection(ortb2, section)) {\n        if (found != null) {\n          logWarn(`${logPrefix} specifies both '${found}' and '${section}'; dropping the latter.`)\n          delete ortb2[section];\n        } else {\n          found = section;\n        }\n      }\n      return found;\n    }, null);\n    return ortb2;\n  }\n}\n\nexport function hasSection(ortb2, section) {\n  return ortb2[section] != null && Object.keys(ortb2[section]).length > 0\n}\n","import {memoize, timestamp} from '../utils.js';\nimport {getCoreStorageManager} from '../storageManager.js';\n\nexport const coreStorage = getCoreStorageManager('fpdEnrichment');\n\n/**\n * Find the root domain by testing for the topmost domain that will allow setting cookies.\n */\n\nexport const findRootDomain = memoize(function findRootDomain(fullDomain = window.location.host) {\n  if (!coreStorage.cookiesAreEnabled()) {\n    return fullDomain;\n  }\n\n  const domainParts = fullDomain.split('.');\n  if (domainParts.length === 2) {\n    return fullDomain;\n  }\n  let rootDomain;\n  let continueSearching;\n  let startIndex = -2;\n  const TEST_COOKIE_NAME = `_rdc${Date.now()}`;\n  const TEST_COOKIE_VALUE = 'writeable';\n  do {\n    rootDomain = domainParts.slice(startIndex).join('.');\n    let expirationDate = new Date(timestamp() + 10 * 1000).toUTCString();\n\n    // Write a test cookie\n    coreStorage.setCookie(\n      TEST_COOKIE_NAME,\n      TEST_COOKIE_VALUE,\n      expirationDate,\n      'Lax',\n      rootDomain,\n      undefined\n    );\n\n    // See if the write was successful\n    const value = coreStorage.getCookie(TEST_COOKIE_NAME, undefined);\n    if (value === TEST_COOKIE_VALUE) {\n      continueSearching = false;\n      // Delete our test cookie\n      coreStorage.setCookie(\n        TEST_COOKIE_NAME,\n        '',\n        'Thu, 01 Jan 1970 00:00:01 GMT',\n        undefined,\n        rootDomain,\n        undefined\n      );\n    } else {\n      startIndex += -1;\n      continueSearching = Math.abs(startIndex) <= domainParts.length;\n    }\n  } while (continueSearching);\n  return rootDomain;\n});\n","import {isEmptyStr, isStr, isEmpty} from '../utils.js';\nimport {GreedyPromise} from '../utils/promise.js';\n\nexport const SUA_SOURCE_UNKNOWN = 0;\nexport const SUA_SOURCE_LOW_ENTROPY = 1;\nexport const SUA_SOURCE_HIGH_ENTROPY = 2;\nexport const SUA_SOURCE_UA_HEADER = 3;\n\n// \"high entropy\" (i.e. privacy-sensitive) fields that can be requested from the navigator.\nexport const HIGH_ENTROPY_HINTS = [\n  'architecture',\n  'bitness',\n  'model',\n  'platformVersion',\n  'fullVersionList'\n]\n\nexport const LOW_ENTROPY_HINTS = [\n  'brands',\n  'mobile',\n  'platform'\n]\n\n/**\n * Returns low entropy UA client hints encoded as an ortb2.6 device.sua object; or null if no UA client hints are available.\n */\nexport const getLowEntropySUA = lowEntropySUAAccessor();\n\n/**\n * Returns a promise to high entropy UA client hints encoded as an ortb2.6 device.sua object, or null if no UA client hints are available.\n *\n * Note that the return value is a promise because the underlying browser API returns a promise; this\n * seems to plan for additional controls (such as alerts / permission request prompts to the user); it's unclear\n * at the moment if this means that asking for more hints would result in slower / more expensive calls.\n *\n * @param {Array[String]} hints hints to request, defaults to all (HIGH_ENTROPY_HINTS).\n */\nexport const getHighEntropySUA = highEntropySUAAccessor();\n\nexport function lowEntropySUAAccessor(uaData = window.navigator?.userAgentData) {\n  const sua = (uaData && LOW_ENTROPY_HINTS.some(h => typeof uaData[h] !== 'undefined')) ? Object.freeze(uaDataToSUA(SUA_SOURCE_LOW_ENTROPY, uaData)) : null;\n  return function () {\n    return sua;\n  }\n}\n\nexport function highEntropySUAAccessor(uaData = window.navigator?.userAgentData) {\n  const cache = {};\n  const keys = new WeakMap();\n  return function (hints = HIGH_ENTROPY_HINTS) {\n    if (!keys.has(hints)) {\n      const sorted = Array.from(hints);\n      sorted.sort();\n      keys.set(hints, sorted.join('|'));\n    }\n    const key = keys.get(hints);\n    if (!cache.hasOwnProperty(key)) {\n      try {\n        cache[key] = uaData.getHighEntropyValues(hints).then(result => {\n          return isEmpty(result) ? null : Object.freeze(uaDataToSUA(SUA_SOURCE_HIGH_ENTROPY, result))\n        }).catch(() => null);\n      } catch (e) {\n        cache[key] = GreedyPromise.resolve(null);\n      }\n    }\n    return cache[key];\n  }\n}\n\n/**\n * Convert a User Agent client hints object to an ORTB 2.6 device.sua fragment\n * https://iabtechlab.com/wp-content/uploads/2022/04/OpenRTB-2-6_FINAL.pdf\n *\n * @param source source of the UAData object (0 to 3)\n * @param uaData https://developer.mozilla.org/en-US/docs/Web/API/NavigatorUAData/\n * @return {{}}\n */\nexport function uaDataToSUA(source, uaData) {\n  function toBrandVersion(brand, version) {\n    const bv = {brand};\n    if (isStr(version) && !isEmptyStr(version)) {\n      bv.version = version.split('.');\n    }\n    return bv;\n  }\n\n  const sua = {source};\n  if (uaData.platform) {\n    sua.platform = toBrandVersion(uaData.platform, uaData.platformVersion);\n  }\n  if (uaData.fullVersionList || uaData.brands) {\n    sua.browsers = (uaData.fullVersionList || uaData.brands).map(({brand, version}) => toBrandVersion(brand, version));\n  }\n  if (typeof uaData['mobile'] !== 'undefined') {\n    sua.mobile = uaData.mobile ? 1 : 0;\n  }\n  ['model', 'bitness', 'architecture'].forEach(prop => {\n    const value = uaData[prop];\n    if (isStr(value)) {\n      sua[prop] = value;\n    }\n  })\n  return sua;\n}\n","import funHooks from 'fun-hooks/no-eval/index.js';\nimport {defer} from './utils/promise.js';\n\nexport let hook = funHooks({\n  ready: funHooks.SYNC | funHooks.ASYNC | funHooks.QUEUE\n});\n\nconst readyCtl = defer();\nhook.ready = (() => {\n  const ready = hook.ready;\n  return function () {\n    try {\n      return ready.apply(hook, arguments);\n    } finally {\n      readyCtl.resolve();\n    }\n  }\n})();\n\n/**\n * A promise that resolves when hooks are ready.\n * @type {Promise}\n */\nexport const ready = readyCtl.promise;\n\nexport const getHook = hook.get;\n\nexport function setupBeforeHookFnOnce(baseFn, hookFn, priority = 15) {\n  let result = baseFn.getHooks({hook: hookFn});\n  if (result.length === 0) {\n    baseFn.before(hookFn, priority);\n  }\n}\nconst submoduleInstallMap = {};\n\nexport function module(name, install, {postInstallAllowed = false} = {}) {\n  hook('async', function (submodules) {\n    submodules.forEach(args => install(...args));\n    if (postInstallAllowed) submoduleInstallMap[name] = install;\n  }, name)([]); // will be queued until hook.ready() called in pbjs.processQueue();\n}\n\nexport function submodule(name, ...args) {\n  const install = submoduleInstallMap[name];\n  if (install) return install(...args);\n  getHook(name).before((next, modules) => {\n    modules.push(args);\n    next(modules);\n  });\n}\n\n/**\n * Copy hook methods (.before, .after, etc) from a given hook to a given wrapper object.\n */\nexport function wrapHook(hook, wrapper) {\n  Object.defineProperties(\n    wrapper,\n    Object.fromEntries(['before', 'after', 'getHooks', 'removeAll'].map((m) => [m, {get: () => hook[m]}]))\n  );\n  return wrapper;\n}\n","/**\n * This file contains the valid Media Types in Prebid.\n *\n * All adapters are assumed to support banner ads. Other media types are specified by Adapters when they\n * register themselves with prebid-core.\n */\n\n/**\n * @typedef {('native'|'video'|'banner')} MediaType\n * @typedef {('adpod')} VideoContext\n */\n\n/** @type {MediaType} */\nexport const NATIVE = 'native';\n/** @type {MediaType} */\nexport const VIDEO = 'video';\n/** @type {MediaType} */\nexport const BANNER = 'banner';\n/** @type {VideoContext} */\nexport const ADPOD = 'adpod';\n","import {\n  deepClone, getDefinedParams,\n  insertHtmlIntoIframe,\n  isArray,\n  isBoolean,\n  isInteger,\n  isNumber,\n  isPlainObject,\n  logError,\n  pick,\n  triggerPixel\n} from './utils.js';\nimport {includes} from './polyfill.js';\nimport {auctionManager} from './auctionManager.js';\nimport {NATIVE_ASSET_TYPES, NATIVE_IMAGE_TYPES, PREBID_NATIVE_DATA_KEYS_TO_ORTB, NATIVE_KEYS_THAT_ARE_NOT_ASSETS, NATIVE_KEYS} from './constants.js';\nimport {NATIVE} from './mediaTypes.js';\nimport {getRenderingData} from './adRendering.js';\nimport {getCreativeRendererSource} from './creativeRenderers.js';\n\n/**\n * @typedef {import('../src/adapters/bidderFactory.js').BidRequest} BidRequest\n * @typedef {import('../src/adapters/bidderFactory.js').Bid} Bid\n */\n\nexport const nativeAdapters = [];\n\nexport const NATIVE_TARGETING_KEYS = Object.keys(NATIVE_KEYS).map(\n  key => NATIVE_KEYS[key]\n);\n\nexport const IMAGE = {\n  ortb: {\n    ver: '1.2',\n    assets: [\n      {\n        required: 1,\n        id: 1,\n        img: {\n          type: 3,\n          wmin: 100,\n          hmin: 100,\n        }\n      },\n      {\n        required: 1,\n        id: 2,\n        title: {\n          len: 140,\n        }\n      },\n      {\n        required: 1,\n        id: 3,\n        data: {\n          type: 1,\n        }\n      },\n      {\n        required: 0,\n        id: 4,\n        data: {\n          type: 2,\n        }\n      },\n      {\n        required: 0,\n        id: 5,\n        img: {\n          type: 1,\n          wmin: 20,\n          hmin: 20,\n        }\n      },\n    ],\n  },\n  image: { required: true },\n  title: { required: true },\n  sponsoredBy: { required: true },\n  clickUrl: { required: true },\n  body: { required: false },\n  icon: { required: false },\n};\n\nconst SUPPORTED_TYPES = {\n  image: IMAGE\n};\n\n// inverse native maps useful for converting to legacy\nconst PREBID_NATIVE_DATA_KEYS_TO_ORTB_INVERSE = inverse(PREBID_NATIVE_DATA_KEYS_TO_ORTB);\nconst NATIVE_ASSET_TYPES_INVERSE = inverse(NATIVE_ASSET_TYPES);\n\nconst TRACKER_METHODS = {\n  img: 1,\n  js: 2,\n  1: 'img',\n  2: 'js'\n}\n\nconst TRACKER_EVENTS = {\n  impression: 1,\n  'viewable-mrc50': 2,\n  'viewable-mrc100': 3,\n  'viewable-video50': 4,\n}\n\nexport function isNativeResponse(bidResponse) {\n  // check for native data and not mediaType; it's possible\n  // to treat banner responses as native\n  return bidResponse.native && typeof bidResponse.native === 'object';\n}\n\n/**\n * Recieves nativeParams from an adUnit. If the params were not of type 'type',\n * passes them on directly. If they were of type 'type', translate\n * them into the predefined specific asset requests for that type of native ad.\n */\nexport function processNativeAdUnitParams(params) {\n  if (params && params.type && typeIsSupported(params.type)) {\n    params = SUPPORTED_TYPES[params.type];\n  }\n\n  if (params && params.ortb && !isOpenRTBBidRequestValid(params.ortb)) {\n    return;\n  }\n  return params;\n}\n\nexport function decorateAdUnitsWithNativeParams(adUnits) {\n  adUnits.forEach(adUnit => {\n    const nativeParams =\n      adUnit.nativeParams || adUnit?.mediaTypes?.native;\n    if (nativeParams) {\n      adUnit.nativeParams = processNativeAdUnitParams(nativeParams);\n    }\n    if (adUnit.nativeParams) {\n      adUnit.nativeOrtbRequest = adUnit.nativeParams.ortb || toOrtbNativeRequest(adUnit.nativeParams);\n    }\n  });\n}\nexport function isOpenRTBBidRequestValid(ortb) {\n  const assets = ortb.assets;\n  if (!Array.isArray(assets) || assets.length === 0) {\n    logError(`assets in mediaTypes.native.ortb is not an array, or it's empty. Assets: `, assets);\n    return false;\n  }\n\n  // validate that ids exist, that they are unique and that they are numbers\n  const ids = assets.map(asset => asset.id);\n  if (assets.length !== new Set(ids).size || ids.some(id => id !== parseInt(id, 10))) {\n    logError(`each asset object must have 'id' property, it must be unique and it must be an integer`);\n    return false;\n  }\n\n  if (ortb.hasOwnProperty('eventtrackers') && !Array.isArray(ortb.eventtrackers)) {\n    logError('ortb.eventtrackers is not an array. Eventtrackers: ', ortb.eventtrackers);\n    return false;\n  }\n\n  return assets.every(asset => isOpenRTBAssetValid(asset))\n}\n\nfunction isOpenRTBAssetValid(asset) {\n  if (!isPlainObject(asset)) {\n    logError(`asset must be an object. Provided asset: `, asset);\n    return false;\n  }\n  if (asset.img) {\n    if (!isNumber(asset.img.w) && !isNumber(asset.img.wmin)) {\n      logError(`for img asset there must be 'w' or 'wmin' property`);\n      return false;\n    }\n    if (!isNumber(asset.img.h) && !isNumber(asset.img.hmin)) {\n      logError(`for img asset there must be 'h' or 'hmin' property`);\n      return false;\n    }\n  } else if (asset.title) {\n    if (!isNumber(asset.title.len)) {\n      logError(`for title asset there must be 'len' property defined`);\n      return false;\n    }\n  } else if (asset.data) {\n    if (!isNumber(asset.data.type)) {\n      logError(`for data asset 'type' property must be a number`);\n      return false;\n    }\n  } else if (asset.video) {\n    if (!Array.isArray(asset.video.mimes) || !Array.isArray(asset.video.protocols) ||\n      !isNumber(asset.video.minduration) || !isNumber(asset.video.maxduration)) {\n      logError('video asset is not properly configured');\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Check if the native type specified in the adUnit is supported by Prebid.\n */\nfunction typeIsSupported(type) {\n  if (!(type && includes(Object.keys(SUPPORTED_TYPES), type))) {\n    logError(`${type} nativeParam is not supported`);\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Helper functions for working with native-enabled adUnits\n * TODO: abstract this and the video helper functions into general\n * adunit validation helper functions\n */\nexport const nativeAdUnit = adUnit => {\n  const mediaType = adUnit.mediaType === 'native';\n  const mediaTypes = adUnit?.mediaTypes?.native;\n  return mediaType || mediaTypes;\n}\nexport const nativeBidder = bid => includes(nativeAdapters, bid.bidder);\nexport const hasNonNativeBidder = adUnit =>\n  adUnit.bids.filter(bid => !nativeBidder(bid)).length;\n\n/**\n * Validate that the native assets on this bid contain all assets that were\n * marked as required in the adUnit configuration.\n * @param {Bid} bid Native bid to validate\n * @param {BidRequest[]} bidRequests All bid requests for an auction\n * @return {Boolean} If object is valid\n */\nexport function nativeBidIsValid(bid, {index = auctionManager.index} = {}) {\n  const adUnit = index.getAdUnit(bid);\n  if (!adUnit) { return false; }\n  let ortbRequest = adUnit.nativeOrtbRequest\n  let ortbResponse = bid.native?.ortb || toOrtbNativeResponse(bid.native, ortbRequest);\n  return isNativeOpenRTBBidValid(ortbResponse, ortbRequest);\n}\n\nexport function isNativeOpenRTBBidValid(bidORTB, bidRequestORTB) {\n  if (!bidORTB?.link?.url) {\n    logError(`native response doesn't have 'link' property. Ortb response: `, bidORTB);\n    return false;\n  }\n\n  let requiredAssetIds = bidRequestORTB.assets.filter(asset => asset.required === 1).map(a => a.id);\n  let returnedAssetIds = bidORTB.assets.map(asset => asset.id);\n\n  const match = requiredAssetIds.every(assetId => includes(returnedAssetIds, assetId));\n  if (!match) {\n    logError(`didn't receive a bid with all required assets. Required ids: ${requiredAssetIds}, but received ids in response: ${returnedAssetIds}`);\n  }\n\n  return match;\n}\n\n/*\n * Native responses may have associated impression or click trackers.\n * This retrieves the appropriate tracker urls for the given ad object and\n * fires them. As a native creatives may be in a cross-origin frame, it may be\n * necessary to invoke this function via postMessage. secureCreatives is\n * configured to fire this function when it receives a `message` of 'Prebid Native'\n * and an `adId` with the value of the `bid.adId`. When a message is posted with\n * these parameters, impression trackers are fired. To fire click trackers, the\n * message should contain an `action` set to 'click'.\n *\n * // Native creative template example usage\n * <a href=\"%%CLICK_URL_UNESC%%%%PATTERN:hb_native_linkurl%%\"\n *    target=\"_blank\"\n *    onclick=\"fireTrackers('click')\">\n *    %%PATTERN:hb_native_title%%\n * </a>\n *\n * <script>\n *   function fireTrackers(action) {\n *     var message = {message: 'Prebid Native', adId: '%%PATTERN:hb_adid%%'};\n *     if (action === 'click') {message.action = 'click';} // fires click trackers\n *     window.parent.postMessage(JSON.stringify(message), '*');\n *   }\n *   fireTrackers(); // fires impressions when creative is loaded\n * </script>\n */\nexport function fireNativeTrackers(message, bidResponse) {\n  const nativeResponse = bidResponse.native.ortb || legacyPropertiesToOrtbNative(bidResponse.native);\n\n  if (message.action === 'click') {\n    fireClickTrackers(nativeResponse, message?.assetId);\n  } else {\n    fireImpressionTrackers(nativeResponse);\n  }\n  return message.action;\n}\n\nexport function fireImpressionTrackers(nativeResponse, {runMarkup = (mkup) => insertHtmlIntoIframe(mkup), fetchURL = triggerPixel} = {}) {\n  const impTrackers = (nativeResponse.eventtrackers || [])\n    .filter(tracker => tracker.event === TRACKER_EVENTS.impression);\n\n  let {img, js} = impTrackers.reduce((tally, tracker) => {\n    if (TRACKER_METHODS.hasOwnProperty(tracker.method)) {\n      tally[TRACKER_METHODS[tracker.method]].push(tracker.url)\n    }\n    return tally;\n  }, {img: [], js: []});\n\n  if (nativeResponse.imptrackers) {\n    img = img.concat(nativeResponse.imptrackers);\n  }\n  img.forEach(url => fetchURL(url));\n\n  js = js.map(url => `<script async src=\"${url}\"></script>`);\n  if (nativeResponse.jstracker) {\n    // jstracker is already HTML markup\n    js = js.concat([nativeResponse.jstracker]);\n  }\n  if (js.length) {\n    runMarkup(js.join('\\n'));\n  }\n}\n\nexport function fireClickTrackers(nativeResponse, assetId = null, {fetchURL = triggerPixel} = {}) {\n  // legacy click tracker\n  if (!assetId) {\n    (nativeResponse.link?.clicktrackers || []).forEach(url => fetchURL(url));\n  } else {\n    // ortb click tracker. This will try to call the clicktracker associated with the asset;\n    // will fallback to the link if none is found.\n    const assetIdLinkMap = (nativeResponse.assets || [])\n      .filter(a => a.link)\n      .reduce((map, asset) => {\n        map[asset.id] = asset.link;\n        return map\n      }, {});\n    const masterClickTrackers = nativeResponse.link?.clicktrackers || [];\n    let assetLink = assetIdLinkMap[assetId];\n    let clickTrackers = masterClickTrackers;\n    if (assetLink) {\n      clickTrackers = assetLink.clicktrackers || [];\n    }\n    clickTrackers.forEach(url => fetchURL(url));\n  }\n}\n\nexport function setNativeResponseProperties(bid, adUnit) {\n  const nativeOrtbRequest = adUnit?.nativeOrtbRequest;\n  const nativeOrtbResponse = bid.native?.ortb;\n\n  if (nativeOrtbRequest && nativeOrtbResponse) {\n    const legacyResponse = toLegacyResponse(nativeOrtbResponse, nativeOrtbRequest);\n    Object.assign(bid.native, legacyResponse);\n  }\n\n  ['rendererUrl', 'adTemplate'].forEach(prop => {\n    const val = adUnit?.nativeParams?.[prop];\n    if (val) {\n      bid.native[prop] = getAssetValue(val);\n    }\n  });\n}\n\n/**\n * Gets native targeting key-value pairs\n * @param {Object} bid\n * @return {Object} targeting\n */\nexport function getNativeTargeting(bid, {index = auctionManager.index} = {}) {\n  let keyValues = {};\n  const adUnit = index.getAdUnit(bid);\n\n  const globalSendTargetingKeys = adUnit?.nativeParams?.ortb == null && adUnit?.nativeParams?.sendTargetingKeys !== false;\n\n  const nativeKeys = getNativeKeys(adUnit);\n\n  const flatBidNativeKeys = { ...bid.native, ...bid.native.ext };\n  delete flatBidNativeKeys.ext;\n\n  Object.keys(flatBidNativeKeys).forEach(asset => {\n    const key = nativeKeys[asset];\n    let value = getAssetValue(bid.native[asset]) || getAssetValue(bid?.native?.ext?.[asset]);\n\n    if (asset === 'adTemplate' || !key || !value) {\n      return;\n    }\n\n    let sendPlaceholder = adUnit?.nativeParams?.[asset]?.sendId;\n    if (typeof sendPlaceholder !== 'boolean') {\n      sendPlaceholder = adUnit?.nativeParams?.ext?.[asset]?.sendId;\n    }\n\n    if (sendPlaceholder) {\n      const placeholder = `${key}:${bid.adId}`;\n      value = placeholder;\n    }\n\n    let assetSendTargetingKeys = adUnit?.nativeParams?.[asset]?.sendTargetingKeys;\n    if (typeof assetSendTargetingKeys !== 'boolean') {\n      assetSendTargetingKeys = adUnit?.nativeParams?.ext?.[asset]?.sendTargetingKeys;\n    }\n\n    const sendTargeting = typeof assetSendTargetingKeys === 'boolean' ? assetSendTargetingKeys : globalSendTargetingKeys;\n\n    if (sendTargeting) {\n      keyValues[key] = value;\n    }\n  });\n\n  return keyValues;\n}\n\nfunction getNativeAssets(nativeProps, keys, ext = false) {\n  let assets = [];\n  Object.entries(nativeProps)\n    .filter(([k, v]) => v && ((ext === false && k === 'ext') || keys == null || keys.includes(k)))\n    .forEach(([key, value]) => {\n      if (ext === false && key === 'ext') {\n        assets.push(...getNativeAssets(value, keys, true));\n      } else if (ext || NATIVE_KEYS.hasOwnProperty(key)) {\n        assets.push({key, value: getAssetValue(value)});\n      }\n    });\n  return assets;\n}\n\nexport function getNativeRenderingData(bid, adUnit, keys) {\n  const data = {\n    ...getDefinedParams(bid.native, ['rendererUrl', 'adTemplate']),\n    assets: getNativeAssets(bid.native, keys),\n    nativeKeys: NATIVE_KEYS\n  };\n  if (bid.native.ortb) {\n    data.ortb = bid.native.ortb;\n  } else if (adUnit.mediaTypes?.native?.ortb) {\n    data.ortb = toOrtbNativeResponse(bid.native, adUnit.nativeOrtbRequest);\n  }\n  return data;\n}\n\nfunction assetsMessage(data, adObject, keys, {index = auctionManager.index} = {}) {\n  const msg = {\n    message: 'assetResponse',\n    adId: data.adId,\n  };\n  let renderData = getRenderingData(adObject).native;\n  if (renderData) {\n    // if we have native rendering data (set up by the nativeRendering module)\n    // include it in full (\"all assets\") together with the renderer.\n    // this is to allow PUC to use dynamic renderers without requiring changes in creative setup\n    msg.native = Object.assign({}, renderData);\n    msg.renderer = getCreativeRendererSource(adObject);\n    if (keys != null) {\n      renderData.assets = renderData.assets.filter(({key}) => keys.includes(key))\n    }\n  } else {\n    renderData = getNativeRenderingData(adObject, index.getAdUnit(adObject), keys);\n  }\n  return Object.assign(msg, renderData);\n}\n\nconst NATIVE_KEYS_INVERTED = Object.fromEntries(Object.entries(NATIVE_KEYS).map(([k, v]) => [v, k]));\n\n/**\n * Constructs a message object containing asset values for each of the\n * requested data keys.\n */\nexport function getAssetMessage(data, adObject) {\n  const keys = data.assets.map((k) => NATIVE_KEYS_INVERTED[k]);\n  return assetsMessage(data, adObject, keys);\n}\n\nexport function getAllAssetsMessage(data, adObject) {\n  return assetsMessage(data, adObject, null);\n}\n\n/**\n * Native assets can be a string or an object with a url prop. Returns the value\n * appropriate for sending in adserver targeting or placeholder replacement.\n */\nfunction getAssetValue(value) {\n  return value?.url || value;\n}\n\nfunction getNativeKeys(adUnit) {\n  const extraNativeKeys = {}\n\n  if (adUnit?.nativeParams?.ext) {\n    Object.keys(adUnit.nativeParams.ext).forEach(extKey => {\n      extraNativeKeys[extKey] = `hb_native_${extKey}`;\n    })\n  }\n\n  return {\n    ...NATIVE_KEYS,\n    ...extraNativeKeys\n  }\n}\n\n/**\n * converts Prebid legacy native assets request to OpenRTB format\n * @param {object} legacyNativeAssets an object that describes a native bid request in Prebid proprietary format\n * @returns an OpenRTB format of the same bid request\n */\nexport function toOrtbNativeRequest(legacyNativeAssets) {\n  if (!legacyNativeAssets && !isPlainObject(legacyNativeAssets)) {\n    logError('Native assets object is empty or not an object: ', legacyNativeAssets);\n    return;\n  }\n  const ortb = {\n    ver: '1.2',\n    assets: []\n  };\n  for (let key in legacyNativeAssets) {\n    // skip conversion for non-asset keys\n    if (NATIVE_KEYS_THAT_ARE_NOT_ASSETS.includes(key)) continue;\n    if (!NATIVE_KEYS.hasOwnProperty(key)) {\n      logError(`Unrecognized native asset code: ${key}. Asset will be ignored.`);\n      continue;\n    }\n\n    if (key === 'privacyLink') {\n      ortb.privacy = 1;\n      continue;\n    }\n\n    const asset = legacyNativeAssets[key];\n    let required = 0;\n    if (asset.required && isBoolean(asset.required)) {\n      required = Number(asset.required);\n    }\n    const ortbAsset = {\n      id: ortb.assets.length,\n      required\n    };\n    // data cases\n    if (key in PREBID_NATIVE_DATA_KEYS_TO_ORTB) {\n      ortbAsset.data = {\n        type: NATIVE_ASSET_TYPES[PREBID_NATIVE_DATA_KEYS_TO_ORTB[key]]\n      }\n      if (asset.len) {\n        ortbAsset.data.len = asset.len;\n      }\n    // icon or image case\n    } else if (key === 'icon' || key === 'image') {\n      ortbAsset.img = {\n        type: key === 'icon' ? NATIVE_IMAGE_TYPES.ICON : NATIVE_IMAGE_TYPES.MAIN,\n      }\n      // if min_width and min_height are defined in aspect_ratio, they are preferred\n      if (asset.aspect_ratios) {\n        if (!isArray(asset.aspect_ratios)) {\n          logError(\"image.aspect_ratios was passed, but it's not a an array:\", asset.aspect_ratios);\n        } else if (!asset.aspect_ratios.length) {\n          logError(\"image.aspect_ratios was passed, but it's empty:\", asset.aspect_ratios);\n        } else {\n          const { min_width: minWidth, min_height: minHeight } = asset.aspect_ratios[0];\n          if (!isInteger(minWidth) || !isInteger(minHeight)) {\n            logError('image.aspect_ratios min_width or min_height are invalid: ', minWidth, minHeight);\n          } else {\n            ortbAsset.img.wmin = minWidth;\n            ortbAsset.img.hmin = minHeight;\n          }\n          const aspectRatios = asset.aspect_ratios\n            .filter((ar) => ar.ratio_width && ar.ratio_height)\n            .map(ratio => `${ratio.ratio_width}:${ratio.ratio_height}`);\n          if (aspectRatios.length > 0) {\n            ortbAsset.img.ext = {\n              aspectratios: aspectRatios\n            }\n          }\n        }\n      }\n\n      // if asset.sizes exist, by OpenRTB spec we should remove wmin and hmin\n      if (asset.sizes) {\n        if (asset.sizes.length !== 2 || !isInteger(asset.sizes[0]) || !isInteger(asset.sizes[1])) {\n          logError('image.sizes was passed, but its value is not an array of integers:', asset.sizes);\n        } else {\n          ortbAsset.img.w = asset.sizes[0];\n          ortbAsset.img.h = asset.sizes[1];\n          delete ortbAsset.img.hmin;\n          delete ortbAsset.img.wmin;\n        }\n      }\n    // title case\n    } else if (key === 'title') {\n      ortbAsset.title = {\n        // in openRTB, len is required for titles, while in legacy prebid was not.\n        // for this reason, if len is missing in legacy prebid, we're adding a default value of 140.\n        len: asset.len || 140\n      }\n    // all extensions to the native bid request are passed as is\n    } else if (key === 'ext') {\n      ortbAsset.ext = asset;\n      // in `ext` case, required field is not needed\n      delete ortbAsset.required;\n    }\n    ortb.assets.push(ortbAsset);\n  }\n  return ortb;\n}\n\n/**\n * Greatest common divisor between two positive integers\n * https://en.wikipedia.org/wiki/Euclidean_algorithm\n */\nfunction gcd(a, b) {\n  while (a && b && a !== b) {\n    if (a > b) {\n      a = a - b;\n    } else {\n      b = b - a;\n    }\n  }\n  return a || b;\n}\n\n/**\n * This function converts an OpenRTB native request object to Prebid proprietary\n * format. The purpose of this function is to help adapters to handle the\n * transition phase where publishers may be using OpenRTB objects but the\n *  bidder does not yet support it.\n * @param {object} openRTBRequest an OpenRTB v1.2 request object\n * @returns a Prebid legacy native format request\n */\nexport function fromOrtbNativeRequest(openRTBRequest) {\n  if (!isOpenRTBBidRequestValid(openRTBRequest)) {\n    return;\n  }\n\n  const oldNativeObject = {};\n  for (const asset of openRTBRequest.assets) {\n    if (asset.title) {\n      const title = {\n        required: asset.required ? Boolean(asset.required) : false,\n        len: asset.title.len\n      }\n      oldNativeObject.title = title;\n    } else if (asset.img) {\n      const image = {\n        required: asset.required ? Boolean(asset.required) : false,\n      }\n      if (asset.img.w && asset.img.h) {\n        image.sizes = [asset.img.w, asset.img.h];\n      } else if (asset.img.wmin && asset.img.hmin) {\n        const scale = gcd(asset.img.wmin, asset.img.hmin)\n        image.aspect_ratios = [{\n          min_width: asset.img.wmin,\n          min_height: asset.img.hmin,\n          ratio_width: asset.img.wmin / scale,\n          ratio_height: asset.img.hmin / scale\n        }]\n      }\n\n      if (asset.img.type === NATIVE_IMAGE_TYPES.MAIN) {\n        oldNativeObject.image = image;\n      } else {\n        oldNativeObject.icon = image;\n      }\n    } else if (asset.data) {\n      let assetType = Object.keys(NATIVE_ASSET_TYPES).find(k => NATIVE_ASSET_TYPES[k] === asset.data.type);\n      let prebidAssetName = Object.keys(PREBID_NATIVE_DATA_KEYS_TO_ORTB).find(k => PREBID_NATIVE_DATA_KEYS_TO_ORTB[k] === assetType);\n      oldNativeObject[prebidAssetName] = {\n        required: asset.required ? Boolean(asset.required) : false,\n      }\n      if (asset.data.len) {\n        oldNativeObject[prebidAssetName].len = asset.data.len;\n      }\n    }\n    if (openRTBRequest.privacy) {\n      oldNativeObject.privacyLink = { required: false };\n    }\n    // video was not supported by old prebid assets\n  }\n  return oldNativeObject;\n}\n\n/**\n * Converts an OpenRTB request to a proprietary Prebid.js format.\n * The proprietary Prebid format has many limitations and will be dropped in\n * the future; adapters are encouraged to stop using it in favour of OpenRTB format.\n * IMPLEMENTATION DETAILS: This function returns the same exact object if no\n * conversion is needed. If a conversion is needed (meaning, at least one\n * bidRequest contains a native.ortb definition), it will return a copy.\n *\n * @param {BidRequest[]} bidRequests an array of valid bid requests\n * @returns an array of valid bid requests where the openRTB bids are converted to proprietary format.\n */\nexport function convertOrtbRequestToProprietaryNative(bidRequests) {\n  if (FEATURES.NATIVE) {\n    if (!bidRequests || !isArray(bidRequests)) return bidRequests;\n    // check if a conversion is needed\n    if (!bidRequests.some(bidRequest => (bidRequest?.mediaTypes || {})[NATIVE]?.ortb)) {\n      return bidRequests;\n    }\n    let bidRequestsCopy = deepClone(bidRequests);\n    // convert Native ORTB definition to old-style prebid native definition\n    for (const bidRequest of bidRequestsCopy) {\n      if (bidRequest.mediaTypes && bidRequest.mediaTypes[NATIVE] && bidRequest.mediaTypes[NATIVE].ortb) {\n        bidRequest.mediaTypes[NATIVE] = Object.assign(\n          pick(bidRequest.mediaTypes[NATIVE], NATIVE_KEYS_THAT_ARE_NOT_ASSETS),\n          fromOrtbNativeRequest(bidRequest.mediaTypes[NATIVE].ortb)\n        );\n        bidRequest.nativeParams = processNativeAdUnitParams(bidRequest.mediaTypes[NATIVE]);\n      }\n    }\n    return bidRequestsCopy;\n  }\n  return bidRequests;\n}\n\n/**\n * convert PBJS proprietary native properties that are *not* assets to the ORTB native format.\n *\n * @param legacyNative `bidResponse.native` object as returned by adapters\n */\nexport function legacyPropertiesToOrtbNative(legacyNative) {\n  const response = {\n    link: {},\n    eventtrackers: []\n  }\n  Object.entries(legacyNative).forEach(([key, value]) => {\n    switch (key) {\n      case 'clickUrl':\n        response.link.url = value;\n        break;\n      case 'clickTrackers':\n        response.link.clicktrackers = Array.isArray(value) ? value : [value];\n        break;\n      case 'impressionTrackers':\n        (Array.isArray(value) ? value : [value]).forEach(url => {\n          response.eventtrackers.push({\n            event: TRACKER_EVENTS.impression,\n            method: TRACKER_METHODS.img,\n            url\n          });\n        });\n        break;\n      case 'javascriptTrackers':\n        // jstracker is deprecated, but we need to use it here since 'javascriptTrackers' is markup, not an url\n        // TODO: at the time of writing this, core expected javascriptTrackers to be a string (despite the name),\n        // but many adapters are passing an array. It's possible that some of them are, in fact, passing URLs and not markup\n        // in general, native trackers seem to be neglected and/or broken\n        response.jstracker = Array.isArray(value) ? value.join('') : value;\n        break;\n      case 'privacyLink':\n        response.privacy = value;\n        break;\n    }\n  });\n  return response;\n}\n\nexport function toOrtbNativeResponse(legacyResponse, ortbRequest) {\n  const ortbResponse = {\n    ...legacyPropertiesToOrtbNative(legacyResponse),\n    assets: []\n  };\n\n  function useRequestAsset(predicate, fn) {\n    let asset = ortbRequest.assets.find(predicate);\n    if (asset != null) {\n      asset = deepClone(asset);\n      fn(asset);\n      ortbResponse.assets.push(asset);\n    }\n  }\n\n  Object.keys(legacyResponse).filter(key => !!legacyResponse[key]).forEach(key => {\n    const value = getAssetValue(legacyResponse[key]);\n    switch (key) {\n      // process titles\n      case 'title':\n        useRequestAsset(asset => asset.title != null, titleAsset => {\n          titleAsset.title = {\n            text: value\n          };\n        })\n        break;\n      case 'image':\n      case 'icon':\n        const imageType = key === 'image' ? NATIVE_IMAGE_TYPES.MAIN : NATIVE_IMAGE_TYPES.ICON;\n        useRequestAsset(asset => asset.img != null && asset.img.type === imageType, imageAsset => {\n          imageAsset.img = {\n            url: value\n          };\n        })\n        break;\n      default:\n        if (key in PREBID_NATIVE_DATA_KEYS_TO_ORTB) {\n          useRequestAsset(asset => asset.data != null && asset.data.type === NATIVE_ASSET_TYPES[PREBID_NATIVE_DATA_KEYS_TO_ORTB[key]], dataAsset => {\n            dataAsset.data = {\n              value\n            };\n          })\n        }\n        break;\n    }\n  });\n  return ortbResponse;\n}\n\n/**\n * Generates a legacy response from an ortb response. Useful during the transition period.\n * @param {*} ortbResponse a standard ortb response object\n * @param {*} ortbRequest the ortb request, useful to match ids.\n * @returns an object containing the response in legacy native format: { title: \"this is a title\", image: ... }\n */\nexport function toLegacyResponse(ortbResponse, ortbRequest) {\n  const legacyResponse = {};\n  const requestAssets = ortbRequest?.assets || [];\n  legacyResponse.clickUrl = ortbResponse.link?.url;\n  legacyResponse.privacyLink = ortbResponse.privacy;\n  for (const asset of ortbResponse?.assets || []) {\n    const requestAsset = requestAssets.find(reqAsset => asset.id === reqAsset.id);\n    if (asset.title) {\n      legacyResponse.title = asset.title.text;\n    } else if (asset.img) {\n      legacyResponse[requestAsset?.img?.type === NATIVE_IMAGE_TYPES.MAIN ? 'image' : 'icon'] = {\n        url: asset.img.url,\n        width: asset.img.w,\n        height: asset.img.h\n      };\n    } else if (asset.data) {\n      legacyResponse[PREBID_NATIVE_DATA_KEYS_TO_ORTB_INVERSE[NATIVE_ASSET_TYPES_INVERSE[requestAsset?.data?.type]]] = asset.data.value;\n    }\n  }\n\n  // Handle trackers\n  legacyResponse.impressionTrackers = [];\n  let jsTrackers = [];\n\n  if (ortbResponse.imptrackers) {\n    legacyResponse.impressionTrackers.push(...ortbResponse.imptrackers);\n  }\n  for (const eventTracker of ortbResponse?.eventtrackers || []) {\n    if (eventTracker.event === TRACKER_EVENTS.impression && eventTracker.method === TRACKER_METHODS.img) {\n      legacyResponse.impressionTrackers.push(eventTracker.url);\n    }\n    if (eventTracker.event === TRACKER_EVENTS.impression && eventTracker.method === TRACKER_METHODS.js) {\n      jsTrackers.push(eventTracker.url);\n    }\n  }\n\n  jsTrackers = jsTrackers.map(url => `<script async src=\"${url}\"></script>`);\n  if (ortbResponse?.jstracker) { jsTrackers.push(ortbResponse.jstracker); }\n  if (jsTrackers.length) {\n    legacyResponse.javascriptTrackers = jsTrackers.join('\\n');\n  }\n\n  return legacyResponse;\n}\n\n/**\n * Inverts key-values of an object.\n */\nfunction inverse(obj) {\n  var retobj = {};\n  for (var key in obj) {\n    retobj[obj[key]] = key;\n  }\n  return retobj;\n}\n","export const PROCESSOR_TYPES = ['request', 'imp', 'bidResponse', 'response'];\nexport const PROCESSOR_DIALECTS = ['default', 'pbs'];\nexport const [REQUEST, IMP, BID_RESPONSE, RESPONSE] = PROCESSOR_TYPES;\nexport const [DEFAULT, PBS] = PROCESSOR_DIALECTS;\n\nconst types = new Set(PROCESSOR_TYPES);\n\nexport function processorRegistry() {\n  const processors = {};\n\n  return {\n    registerOrtbProcessor({type, name, fn, priority = 0, dialects = [DEFAULT]}) {\n      if (!types.has(type)) {\n        throw new Error(`ORTB processor type must be one of: ${PROCESSOR_TYPES.join(', ')}`)\n      }\n      dialects.forEach(dialect => {\n        if (!processors.hasOwnProperty(dialect)) {\n          processors[dialect] = {};\n        }\n        if (!processors[dialect].hasOwnProperty(type)) {\n          processors[dialect][type] = {};\n        }\n        processors[dialect][type][name] = {\n          priority,\n          fn\n        }\n      })\n    },\n    getProcessors(dialect) {\n      return processors[dialect] || {};\n    }\n  }\n}\n\nexport const {registerOrtbProcessor, getProcessors} = processorRegistry();\n","// These stubs are here to help transition away from core-js polyfills for browsers we are no longer supporting.\n// You should not need these for new code; use stock JS instead!\n\nexport function includes(target, elem, start) {\n  return (target && target.includes(elem, start)) || false;\n}\n\nexport function arrayFrom() {\n  return Array.from.apply(Array, arguments);\n}\n\nexport function find(arr, pred, thisArg) {\n  return arr && arr.find(pred, thisArg);\n}\n\nexport function findIndex(arr, pred, thisArg) {\n  return arr && arr.findIndex(pred, thisArg);\n}\n","/** @module pbjs */\n\nimport {getGlobal} from './prebidGlobal.js';\nimport {\n  deepAccess,\n  deepClone,\n  deepSetValue,\n  flatten,\n  generateUUID,\n  isArray,\n  isArrayOfNums,\n  isEmpty,\n  isFn,\n  isGptPubadsDefined,\n  isNumber,\n  logError,\n  logInfo,\n  logMessage,\n  logWarn,\n  mergeDeep,\n  transformAdServerTargetingObj,\n  uniques,\n  unsupportedBidderMessage\n} from './utils.js';\nimport {listenMessagesFromCreative} from './secureCreatives.js';\nimport {userSync} from './userSync.js';\nimport {config} from './config.js';\nimport {auctionManager} from './auctionManager.js';\nimport {isBidUsable, targeting} from './targeting.js';\nimport {hook, wrapHook} from './hook.js';\nimport {loadSession} from './debugging.js';\nimport {includes} from './polyfill.js';\nimport {createBid} from './bidfactory.js';\nimport {storageCallbacks} from './storageManager.js';\nimport {default as adapterManager, getS2SBidderSet} from './adapterManager.js';\nimport { BID_STATUS, EVENTS, NATIVE_KEYS } from './constants.js';\nimport * as events from './events.js';\nimport {newMetrics, useMetrics} from './utils/perfMetrics.js';\nimport {defer, GreedyPromise} from './utils/promise.js';\nimport {enrichFPD} from './fpd/enrichment.js';\nimport {allConsent} from './consentHandler.js';\nimport {\n  insertLocatorFrame,\n  markBidAsRendered,\n  markWinningBid,\n  renderAdDirect,\n  renderIfDeferred\n} from './adRendering.js';\nimport {getHighestCpm} from './utils/reducers.js';\nimport {ORTB_VIDEO_PARAMS, fillVideoDefaults, validateOrtbVideoFields} from './video.js';\nimport { ORTB_BANNER_PARAMS } from './banner.js';\nimport { BANNER, VIDEO } from './mediaTypes.js';\n\nconst pbjsInstance = getGlobal();\nconst { triggerUserSyncs } = userSync;\n\n/* private variables */\nconst { ADD_AD_UNITS, REQUEST_BIDS, SET_TARGETING } = EVENTS;\n\nconst eventValidators = {\n  bidWon: checkDefinedPlacement\n};\n\n// initialize existing debugging sessions if present\nloadSession();\n\n/* Public vars */\npbjsInstance.bidderSettings = pbjsInstance.bidderSettings || {};\n\n// let the world know we are loaded\npbjsInstance.libLoaded = true;\n\n// version auto generated from build\npbjsInstance.version = 'v$prebid.version$';\nlogInfo('Prebid.js v$prebid.version$ loaded');\n\npbjsInstance.installedModules = pbjsInstance.installedModules || [];\n\n// create adUnit array\npbjsInstance.adUnits = pbjsInstance.adUnits || [];\n\n// Allow publishers who enable user sync override to trigger their sync\npbjsInstance.triggerUserSyncs = triggerUserSyncs;\n\nfunction checkDefinedPlacement(id) {\n  var adUnitCodes = auctionManager.getBidsRequested().map(bidSet => bidSet.bids.map(bid => bid.adUnitCode))\n    .reduce(flatten)\n    .filter(uniques);\n\n  if (!adUnitCodes.includes(id)) {\n    logError('The \"' + id + '\" placement is not defined.');\n    return;\n  }\n\n  return true;\n}\n\nfunction validateSizes(sizes, targLength) {\n  let cleanSizes = [];\n  if (isArray(sizes) && ((targLength) ? sizes.length === targLength : sizes.length > 0)) {\n    // check if an array of arrays or array of numbers\n    if (sizes.every(sz => isArrayOfNums(sz, 2))) {\n      cleanSizes = sizes;\n    } else if (isArrayOfNums(sizes, 2)) {\n      cleanSizes.push(sizes);\n    }\n  }\n  return cleanSizes;\n}\n\n// synchronize fields between mediaTypes[mediaType] and ortb2Imp[mediaType]\nexport function syncOrtb2(adUnit, mediaType) {\n  const ortb2Imp = deepAccess(adUnit, `ortb2Imp.${mediaType}`);\n  const mediaTypes = deepAccess(adUnit, `mediaTypes.${mediaType}`);\n\n  if (!ortb2Imp && !mediaTypes) {\n    // omitting sync due to not present mediaType\n    return;\n  }\n\n  const fields = {\n    [VIDEO]: FEATURES.VIDEO && ORTB_VIDEO_PARAMS,\n    [BANNER]: ORTB_BANNER_PARAMS\n  }[mediaType];\n\n  if (!fields) {\n    return;\n  }\n\n  [...fields].forEach(([key, validator]) => {\n    const mediaTypesFieldValue = deepAccess(adUnit, `mediaTypes.${mediaType}.${key}`);\n    const ortbFieldValue = deepAccess(adUnit, `ortb2Imp.${mediaType}.${key}`);\n\n    if (mediaTypesFieldValue == undefined && ortbFieldValue == undefined) {\n      // omitting the params if it's not defined on either of sides\n    } else if (mediaTypesFieldValue == undefined) {\n      deepSetValue(adUnit, `mediaTypes.${mediaType}.${key}`, ortbFieldValue);\n    } else if (ortbFieldValue == undefined) {\n      deepSetValue(adUnit, `ortb2Imp.${mediaType}.${key}`, mediaTypesFieldValue);\n    } else {\n      logWarn(`adUnit ${adUnit.code}: specifies conflicting ortb2Imp.${mediaType}.${key} and mediaTypes.${mediaType}.${key}, the latter will be ignored`, adUnit);\n      deepSetValue(adUnit, `mediaTypes.${mediaType}.${key}`, ortbFieldValue);\n    }\n  });\n}\n\nfunction validateBannerMediaType(adUnit) {\n  const validatedAdUnit = deepClone(adUnit);\n  const banner = validatedAdUnit.mediaTypes.banner;\n  const bannerSizes = validateSizes(banner.sizes);\n  if (bannerSizes.length > 0) {\n    banner.sizes = bannerSizes;\n    // Deprecation Warning: This property will be deprecated in next release in favor of adUnit.mediaTypes.banner.sizes\n    validatedAdUnit.sizes = bannerSizes;\n  } else {\n    logError('Detected a mediaTypes.banner object without a proper sizes field.  Please ensure the sizes are listed like: [[300, 250], ...].  Removing invalid mediaTypes.banner object from request.');\n    delete validatedAdUnit.mediaTypes.banner\n  }\n  syncOrtb2(validatedAdUnit, 'banner')\n  return validatedAdUnit;\n}\n\nfunction validateVideoMediaType(adUnit) {\n  const validatedAdUnit = deepClone(adUnit);\n  const video = validatedAdUnit.mediaTypes.video;\n  if (video.playerSize) {\n    let tarPlayerSizeLen = (typeof video.playerSize[0] === 'number') ? 2 : 1;\n\n    const videoSizes = validateSizes(video.playerSize, tarPlayerSizeLen);\n    if (videoSizes.length > 0) {\n      if (tarPlayerSizeLen === 2) {\n        logInfo('Transforming video.playerSize from [640,480] to [[640,480]] so it\\'s in the proper format.');\n      }\n      video.playerSize = videoSizes;\n      // Deprecation Warning: This property will be deprecated in next release in favor of adUnit.mediaTypes.video.playerSize\n      validatedAdUnit.sizes = videoSizes;\n    } else {\n      logError('Detected incorrect configuration of mediaTypes.video.playerSize.  Please specify only one set of dimensions in a format like: [[640, 480]]. Removing invalid mediaTypes.video.playerSize property from request.');\n      delete validatedAdUnit.mediaTypes.video.playerSize;\n    }\n  }\n  validateOrtbVideoFields(validatedAdUnit);\n  syncOrtb2(validatedAdUnit, 'video');\n  return validatedAdUnit;\n}\n\nfunction validateNativeMediaType(adUnit) {\n  function err(msg) {\n    logError(`Error in adUnit \"${adUnit.code}\": ${msg}. Removing native request from ad unit`, adUnit);\n    delete validatedAdUnit.mediaTypes.native;\n    return validatedAdUnit;\n  }\n  function checkDeprecated(onDeprecated) {\n    for (const key of ['sendTargetingKeys', 'types']) {\n      if (native.hasOwnProperty(key)) {\n        const res = onDeprecated(key);\n        if (res) return res;\n      }\n    }\n  }\n  const validatedAdUnit = deepClone(adUnit);\n  const native = validatedAdUnit.mediaTypes.native;\n  // if native assets are specified in OpenRTB format, remove legacy assets and print a warn.\n  if (native.ortb) {\n    if (native.ortb.assets?.some(asset => !isNumber(asset.id) || asset.id < 0 || asset.id % 1 !== 0)) {\n      return err('native asset ID must be a nonnegative integer');\n    }\n    if (checkDeprecated(key => err(`ORTB native requests cannot specify \"${key}\"`))) {\n      return validatedAdUnit;\n    }\n    const legacyNativeKeys = Object.keys(NATIVE_KEYS).filter(key => NATIVE_KEYS[key].includes('hb_native_'));\n    const nativeKeys = Object.keys(native);\n    const intersection = nativeKeys.filter(nativeKey => legacyNativeKeys.includes(nativeKey));\n    if (intersection.length > 0) {\n      logError(`when using native OpenRTB format, you cannot use legacy native properties. Deleting ${intersection} keys from request.`);\n      intersection.forEach(legacyKey => delete validatedAdUnit.mediaTypes.native[legacyKey]);\n    }\n  } else {\n    checkDeprecated(key => `mediaTypes.native.${key} is deprecated, consider using native ORTB instead`, adUnit);\n  }\n  if (native.image && native.image.sizes && !Array.isArray(native.image.sizes)) {\n    logError('Please use an array of sizes for native.image.sizes field.  Removing invalid mediaTypes.native.image.sizes property from request.');\n    delete validatedAdUnit.mediaTypes.native.image.sizes;\n  }\n  if (native.image && native.image.aspect_ratios && !Array.isArray(native.image.aspect_ratios)) {\n    logError('Please use an array of sizes for native.image.aspect_ratios field.  Removing invalid mediaTypes.native.image.aspect_ratios property from request.');\n    delete validatedAdUnit.mediaTypes.native.image.aspect_ratios;\n  }\n  if (native.icon && native.icon.sizes && !Array.isArray(native.icon.sizes)) {\n    logError('Please use an array of sizes for native.icon.sizes field.  Removing invalid mediaTypes.native.icon.sizes property from request.');\n    delete validatedAdUnit.mediaTypes.native.icon.sizes;\n  }\n  return validatedAdUnit;\n}\n\nfunction validateAdUnitPos(adUnit, mediaType) {\n  let pos = adUnit?.mediaTypes?.[mediaType]?.pos;\n\n  if (!isNumber(pos) || isNaN(pos) || !isFinite(pos)) {\n    let warning = `Value of property 'pos' on ad unit ${adUnit.code} should be of type: Number`;\n\n    logWarn(warning);\n    delete adUnit.mediaTypes[mediaType].pos;\n  }\n\n  return adUnit\n}\n\nfunction validateAdUnit(adUnit) {\n  const msg = (msg) => `adUnit.code '${adUnit.code}' ${msg}`;\n\n  const mediaTypes = adUnit.mediaTypes;\n  const bids = adUnit.bids;\n\n  if (bids != null && !isArray(bids)) {\n    logError(msg(`defines 'adUnit.bids' that is not an array. Removing adUnit from auction`));\n    return null;\n  }\n  if (bids == null && adUnit.ortb2Imp == null) {\n    logError(msg(`has no 'adUnit.bids' and no 'adUnit.ortb2Imp'. Removing adUnit from auction`));\n    return null;\n  }\n  if (!mediaTypes || Object.keys(mediaTypes).length === 0) {\n    logError(msg(`does not define a 'mediaTypes' object.  This is a required field for the auction, so this adUnit has been removed.`));\n    return null;\n  }\n  if (adUnit.ortb2Imp != null && (bids == null || bids.length === 0)) {\n    adUnit.bids = [{bidder: null}]; // the 'null' bidder is treated as an s2s-only placeholder by adapterManager\n    logMessage(msg(`defines 'adUnit.ortb2Imp' with no 'adUnit.bids'; it will be seen only by S2S adapters`));\n  }\n\n  return adUnit;\n}\n\nexport const adUnitSetupChecks = {\n  validateAdUnit,\n  validateBannerMediaType,\n  validateSizes\n};\n\nif (FEATURES.NATIVE) {\n  Object.assign(adUnitSetupChecks, {validateNativeMediaType});\n}\n\nif (FEATURES.VIDEO) {\n  Object.assign(adUnitSetupChecks, { validateVideoMediaType });\n}\n\nexport const checkAdUnitSetup = hook('sync', function (adUnits) {\n  const validatedAdUnits = [];\n\n  adUnits.forEach(adUnit => {\n    adUnit = validateAdUnit(adUnit);\n    if (adUnit == null) return;\n\n    const mediaTypes = adUnit.mediaTypes;\n    let validatedBanner, validatedVideo, validatedNative;\n\n    if (mediaTypes.banner) {\n      validatedBanner = validateBannerMediaType(adUnit);\n      if (mediaTypes.banner.hasOwnProperty('pos')) validatedBanner = validateAdUnitPos(validatedBanner, 'banner');\n    }\n\n    if (FEATURES.VIDEO && mediaTypes.video) {\n      validatedVideo = validatedBanner ? validateVideoMediaType(validatedBanner) : validateVideoMediaType(adUnit);\n      if (mediaTypes.video.hasOwnProperty('pos')) validatedVideo = validateAdUnitPos(validatedVideo, 'video');\n    }\n\n    if (FEATURES.NATIVE && mediaTypes.native) {\n      validatedNative = validatedVideo ? validateNativeMediaType(validatedVideo) : validatedBanner ? validateNativeMediaType(validatedBanner) : validateNativeMediaType(adUnit);\n    }\n\n    const validatedAdUnit = Object.assign({}, validatedBanner, validatedVideo, validatedNative);\n\n    validatedAdUnits.push(validatedAdUnit);\n  });\n\n  return validatedAdUnits;\n}, 'checkAdUnitSetup');\n\nfunction fillAdUnitDefaults(adUnits) {\n  if (FEATURES.VIDEO) {\n    adUnits.forEach(au => fillVideoDefaults(au))\n  }\n}\n\n/// ///////////////////////////////\n//                              //\n//    Start Public APIs         //\n//                              //\n/// ///////////////////////////////\n\n/**\n * This function returns the query string targeting parameters available at this moment for a given ad unit. Note that some bidder's response may not have been received if you call this function too quickly after the requests are sent.\n * @param  {string} [adunitCode] adUnitCode to get the bid responses for\n * @alias module:pbjs.getAdserverTargetingForAdUnitCodeStr\n * @return {Array}  returnObj return bids array\n */\npbjsInstance.getAdserverTargetingForAdUnitCodeStr = function (adunitCode) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.getAdserverTargetingForAdUnitCodeStr', arguments);\n\n  // call to retrieve bids array\n  if (adunitCode) {\n    var res = pbjsInstance.getAdserverTargetingForAdUnitCode(adunitCode);\n    return transformAdServerTargetingObj(res);\n  } else {\n    logMessage('Need to call getAdserverTargetingForAdUnitCodeStr with adunitCode');\n  }\n};\n\n/**\n * This function returns the query string targeting parameters available at this moment for a given ad unit. Note that some bidder's response may not have been received if you call this function too quickly after the requests are sent.\n * @param adunitCode {string} adUnitCode to get the bid responses for\n * @alias module:pbjs.getHighestUnusedBidResponseForAdUnitCode\n * @returns {Object}  returnObj return bid\n */\npbjsInstance.getHighestUnusedBidResponseForAdUnitCode = function (adunitCode) {\n  if (adunitCode) {\n    const bid = auctionManager.getAllBidsForAdUnitCode(adunitCode)\n      .filter(isBidUsable)\n\n    return bid.length ? bid.reduce(getHighestCpm) : {}\n  } else {\n    logMessage('Need to call getHighestUnusedBidResponseForAdUnitCode with adunitCode');\n  }\n};\n\n/**\n * This function returns the query string targeting parameters available at this moment for a given ad unit. Note that some bidder's response may not have been received if you call this function too quickly after the requests are sent.\n * @param adUnitCode {string} adUnitCode to get the bid responses for\n * @alias module:pbjs.getAdserverTargetingForAdUnitCode\n * @returns {Object}  returnObj return bids\n */\npbjsInstance.getAdserverTargetingForAdUnitCode = function (adUnitCode) {\n  return pbjsInstance.getAdserverTargeting(adUnitCode)[adUnitCode];\n};\n\n/**\n * returns all ad server targeting for all ad units\n * @return {Object} Map of adUnitCodes and targeting values []\n * @alias module:pbjs.getAdserverTargeting\n */\n\npbjsInstance.getAdserverTargeting = function (adUnitCode) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.getAdserverTargeting', arguments);\n  return targeting.getAllTargeting(adUnitCode);\n};\n\npbjsInstance.getConsentMetadata = function () {\n  logInfo('Invoking $$PREBID_GLOBAL$$.getConsentMetadata');\n  return allConsent.getConsentMeta()\n};\n\nfunction getBids(type) {\n  const responses = auctionManager[type]()\n    .filter(bid => auctionManager.getAdUnitCodes().includes(bid.adUnitCode))\n\n  // find the last auction id to get responses for most recent auction only\n  const currentAuctionId = auctionManager.getLastAuctionId();\n\n  return responses\n    .map(bid => bid.adUnitCode)\n    .filter(uniques).map(adUnitCode => responses\n      .filter(bid => bid.auctionId === currentAuctionId && bid.adUnitCode === adUnitCode))\n    .filter(bids => bids && bids[0] && bids[0].adUnitCode)\n    .map(bids => {\n      return {\n        [bids[0].adUnitCode]: { bids }\n      };\n    })\n    .reduce((a, b) => Object.assign(a, b), {});\n}\n\n/**\n * This function returns the bids requests involved in an auction but not bid on\n * @alias module:pbjs.getNoBids\n * @return {Object}            map | object that contains the bidRequests\n */\n\npbjsInstance.getNoBids = function () {\n  logInfo('Invoking $$PREBID_GLOBAL$$.getNoBids', arguments);\n  return getBids('getNoBids');\n};\n\n/**\n * This function returns the bids requests involved in an auction but not bid on or the specified adUnitCode\n * @param  {string} adUnitCode adUnitCode\n * @alias module:pbjs.getNoBidsForAdUnitCode\n * @return {Object}           bidResponse object\n */\n\npbjsInstance.getNoBidsForAdUnitCode = function (adUnitCode) {\n  const bids = auctionManager.getNoBids().filter(bid => bid.adUnitCode === adUnitCode);\n  return { bids };\n};\n\n/**\n * This function returns the bid responses at the given moment.\n * @alias module:pbjs.getBidResponses\n * @return {Object}            map | object that contains the bidResponses\n */\n\npbjsInstance.getBidResponses = function () {\n  logInfo('Invoking $$PREBID_GLOBAL$$.getBidResponses', arguments);\n  return getBids('getBidsReceived');\n};\n\n/**\n * Returns bidResponses for the specified adUnitCode\n * @param  {string} adUnitCode adUnitCode\n * @alias module:pbjs.getBidResponsesForAdUnitCode\n * @return {Object}            bidResponse object\n */\n\npbjsInstance.getBidResponsesForAdUnitCode = function (adUnitCode) {\n  const bids = auctionManager.getBidsReceived().filter(bid => bid.adUnitCode === adUnitCode);\n  return { bids };\n};\n\n/**\n * Set query string targeting on one or more GPT ad units.\n * @param {(string|string[])} adUnit a single `adUnit.code` or multiple.\n * @param {function(object): function(string): boolean} customSlotMatching gets a GoogleTag slot and returns a filter function for adUnitCode, so you can decide to match on either eg. return slot => { return adUnitCode => { return slot.getSlotElementId() === 'myFavoriteDivId'; } };\n * @alias module:pbjs.setTargetingForGPTAsync\n */\npbjsInstance.setTargetingForGPTAsync = function (adUnit, customSlotMatching) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.setTargetingForGPTAsync', arguments);\n  if (!isGptPubadsDefined()) {\n    logError('window.googletag is not defined on the page');\n    return;\n  }\n  targeting.setTargetingForGPT(adUnit, customSlotMatching);\n};\n\n/**\n * Set query string targeting on all AST (AppNexus Seller Tag) ad units. Note that this function has to be called after all ad units on page are defined. For working example code, see [Using Prebid.js with AppNexus Publisher Ad Server](http://prebid.org/dev-docs/examples/use-prebid-with-appnexus-ad-server.html).\n * @param  {(string|string[])} adUnitCodes adUnitCode or array of adUnitCodes\n * @alias module:pbjs.setTargetingForAst\n */\npbjsInstance.setTargetingForAst = function (adUnitCodes) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.setTargetingForAn', arguments);\n  if (!targeting.isApntagDefined()) {\n    logError('window.apntag is not defined on the page');\n    return;\n  }\n\n  targeting.setTargetingForAst(adUnitCodes);\n\n  // emit event\n  events.emit(SET_TARGETING, targeting.getAllTargeting());\n};\n\n/**\n * This function will render the ad (based on params) in the given iframe document passed through.\n * Note that doc SHOULD NOT be the parent document page as we can't doc.write() asynchronously\n * @param  {Document} doc document\n * @param  {string} id bid id to locate the ad\n * @alias module:pbjs.renderAd\n */\npbjsInstance.renderAd = hook('async', function (doc, id, options) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.renderAd', arguments);\n  logMessage('Calling renderAd with adId :' + id);\n  renderAdDirect(doc, id, options);\n});\n\n/**\n * Remove adUnit from the $$PREBID_GLOBAL$$ configuration, if there are no addUnitCode(s) it will remove all\n * @param  {string| Array} adUnitCode the adUnitCode(s) to remove\n * @alias module:pbjs.removeAdUnit\n */\npbjsInstance.removeAdUnit = function (adUnitCode) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.removeAdUnit', arguments);\n\n  if (!adUnitCode) {\n    pbjsInstance.adUnits = [];\n    return;\n  }\n\n  let adUnitCodes;\n\n  if (isArray(adUnitCode)) {\n    adUnitCodes = adUnitCode;\n  } else {\n    adUnitCodes = [adUnitCode];\n  }\n\n  adUnitCodes.forEach((adUnitCode) => {\n    for (let i = pbjsInstance.adUnits.length - 1; i >= 0; i--) {\n      if (pbjsInstance.adUnits[i].code === adUnitCode) {\n        pbjsInstance.adUnits.splice(i, 1);\n      }\n    }\n  });\n};\n\n/**\n * @param {Object} requestOptions\n * @param {function} requestOptions.bidsBackHandler\n * @param {number} requestOptions.timeout\n * @param {Array} requestOptions.adUnits\n * @param {Array} requestOptions.adUnitCodes\n * @param {Array} requestOptions.labels\n * @param {String} requestOptions.auctionId\n * @alias module:pbjs.requestBids\n */\npbjsInstance.requestBids = (function() {\n  const delegate = hook('async', function ({ bidsBackHandler, timeout, adUnits, adUnitCodes, labels, auctionId, ttlBuffer, ortb2, metrics, defer } = {}) {\n    events.emit(REQUEST_BIDS);\n    const cbTimeout = timeout || config.getConfig('bidderTimeout');\n    logInfo('Invoking $$PREBID_GLOBAL$$.requestBids', arguments);\n    if (adUnitCodes != null && !Array.isArray(adUnitCodes)) {\n      adUnitCodes = [adUnitCodes];\n    }\n    if (adUnitCodes && adUnitCodes.length) {\n      // if specific adUnitCodes supplied filter adUnits for those codes\n      adUnits = adUnits.filter(unit => includes(adUnitCodes, unit.code));\n    } else {\n      // otherwise derive adUnitCodes from adUnits\n      adUnitCodes = adUnits && adUnits.map(unit => unit.code);\n    }\n    adUnitCodes = adUnitCodes.filter(uniques);\n    const ortb2Fragments = {\n      global: mergeDeep({}, config.getAnyConfig('ortb2') || {}, ortb2 || {}),\n      bidder: Object.fromEntries(Object.entries(config.getBidderConfig()).map(([bidder, cfg]) => [bidder, deepClone(cfg.ortb2)]).filter(([_, ortb2]) => ortb2 != null))\n    }\n    return enrichFPD(GreedyPromise.resolve(ortb2Fragments.global)).then(global => {\n      ortb2Fragments.global = global;\n      return startAuction({bidsBackHandler, timeout: cbTimeout, adUnits, adUnitCodes, labels, auctionId, ttlBuffer, ortb2Fragments, metrics, defer});\n    })\n  }, 'requestBids');\n\n  return wrapHook(delegate, function requestBids(req = {}) {\n    // unlike the main body of `delegate`, this runs before any other hook has a chance to;\n    // it's also not restricted in its return value in the way `async` hooks are.\n\n    // if the request does not specify adUnits, clone the global adUnit array;\n    // otherwise, if the caller goes on to use addAdUnits/removeAdUnits, any asynchronous logic\n    // in any hook might see their effects.\n    let adUnits = req.adUnits || pbjsInstance.adUnits;\n    req.adUnits = (isArray(adUnits) ? adUnits.slice() : [adUnits]);\n\n    req.metrics = newMetrics();\n    req.metrics.checkpoint('requestBids');\n    req.defer = defer({promiseFactory: (r) => new Promise(r)})\n    delegate.call(this, req);\n    return req.defer.promise;\n  });\n})();\n\nexport const startAuction = hook('async', function ({ bidsBackHandler, timeout: cbTimeout, adUnits, ttlBuffer, adUnitCodes, labels, auctionId, ortb2Fragments, metrics, defer } = {}) {\n  const s2sBidders = getS2SBidderSet(config.getConfig('s2sConfig') || []);\n  fillAdUnitDefaults(adUnits);\n  adUnits = useMetrics(metrics).measureTime('requestBids.validate', () => checkAdUnitSetup(adUnits));\n\n  function auctionDone(bids, timedOut, auctionId) {\n    if (typeof bidsBackHandler === 'function') {\n      try {\n        bidsBackHandler(bids, timedOut, auctionId);\n      } catch (e) {\n        logError('Error executing bidsBackHandler', null, e);\n      }\n    }\n    defer.resolve({bids, timedOut, auctionId})\n  }\n\n  const tids = {};\n\n  /*\n   * for a given adunit which supports a set of mediaTypes\n   * and a given bidder which supports a set of mediaTypes\n   * a bidder is eligible to participate on the adunit\n   * if it supports at least one of the mediaTypes on the adunit\n   */\n  adUnits.forEach(adUnit => {\n    // get the adunit's mediaTypes, defaulting to banner if mediaTypes isn't present\n    const adUnitMediaTypes = Object.keys(adUnit.mediaTypes || { 'banner': 'banner' });\n\n    // get the bidder's mediaTypes\n    const allBidders = adUnit.bids.map(bid => bid.bidder);\n    const bidderRegistry = adapterManager.bidderRegistry;\n\n    const bidders = allBidders.filter(bidder => !s2sBidders.has(bidder));\n    adUnit.adUnitId = generateUUID();\n    const tid = adUnit.ortb2Imp?.ext?.tid;\n    if (tid) {\n      if (tids.hasOwnProperty(adUnit.code)) {\n        logWarn(`Multiple distinct ortb2Imp.ext.tid were provided for twin ad units '${adUnit.code}'`)\n      } else {\n        tids[adUnit.code] = tid;\n      }\n    }\n    if (ttlBuffer != null && !adUnit.hasOwnProperty('ttlBuffer')) {\n      adUnit.ttlBuffer = ttlBuffer;\n    }\n    bidders.forEach(bidder => {\n      const adapter = bidderRegistry[bidder];\n      const spec = adapter && adapter.getSpec && adapter.getSpec();\n      // banner is default if not specified in spec\n      const bidderMediaTypes = (spec && spec.supportedMediaTypes) || ['banner'];\n\n      // check if the bidder's mediaTypes are not in the adUnit's mediaTypes\n      const bidderEligible = adUnitMediaTypes.some(type => includes(bidderMediaTypes, type));\n      if (!bidderEligible) {\n        // drop the bidder from the ad unit if it's not compatible\n        logWarn(unsupportedBidderMessage(adUnit, bidder));\n        adUnit.bids = adUnit.bids.filter(bid => bid.bidder !== bidder);\n      }\n    });\n  });\n  if (!adUnits || adUnits.length === 0) {\n    logMessage('No adUnits configured. No bids requested.');\n    auctionDone();\n  } else {\n    adUnits.forEach(au => {\n      const tid = au.ortb2Imp?.ext?.tid || tids[au.code] || generateUUID();\n      if (!tids.hasOwnProperty(au.code)) {\n        tids[au.code] = tid;\n      }\n      au.transactionId = tid;\n      deepSetValue(au, 'ortb2Imp.ext.tid', tid);\n    });\n    const auction = auctionManager.createAuction({\n      adUnits,\n      adUnitCodes,\n      callback: auctionDone,\n      cbTimeout,\n      labels,\n      auctionId,\n      ortb2Fragments,\n      metrics,\n    });\n\n    let adUnitsLen = adUnits.length;\n    if (adUnitsLen > 15) {\n      logInfo(`Current auction ${auction.getAuctionId()} contains ${adUnitsLen} adUnits.`, adUnits);\n    }\n\n    adUnitCodes.forEach(code => targeting.setLatestAuctionForAdUnit(code, auction.getAuctionId()));\n    auction.callBids();\n  }\n}, 'startAuction');\n\nexport function executeCallbacks(fn, reqBidsConfigObj) {\n  runAll(storageCallbacks);\n  runAll(enableAnalyticsCallbacks);\n  fn.call(this, reqBidsConfigObj);\n\n  function runAll(queue) {\n    var queued;\n    while ((queued = queue.shift())) {\n      queued();\n    }\n  }\n}\n\n// This hook will execute all storage callbacks which were registered before gdpr enforcement hook was added. Some bidders, user id modules use storage functions when module is parsed but gdpr enforcement hook is not added at that stage as setConfig callbacks are yet to be called. Hence for such calls we execute all the stored callbacks just before requestBids. At this hook point we will know for sure that tcfControl module is added or not\npbjsInstance.requestBids.before(executeCallbacks, 49);\n\n/**\n *\n * Add adunit(s)\n * @param {Array|Object} adUnitArr Array of adUnits or single adUnit Object.\n * @alias module:pbjs.addAdUnits\n */\npbjsInstance.addAdUnits = function (adUnitArr) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.addAdUnits', arguments);\n  pbjsInstance.adUnits.push.apply(pbjsInstance.adUnits, isArray(adUnitArr) ? adUnitArr : [adUnitArr]);\n  // emit event\n  events.emit(ADD_AD_UNITS);\n};\n\n/**\n * @param {string} event the name of the event\n * @param {Function} handler a callback to set on event\n * @param {string} id an identifier in the context of the event\n * @alias module:pbjs.onEvent\n *\n * This API call allows you to register a callback to handle a Prebid.js event.\n * An optional `id` parameter provides more finely-grained event callback registration.\n * This makes it possible to register callback events for a specific item in the\n * event context. For example, `bidWon` events will accept an `id` for ad unit code.\n * `bidWon` callbacks registered with an ad unit code id will be called when a bid\n * for that ad unit code wins the auction. Without an `id` this method registers the\n * callback for every `bidWon` event.\n *\n * Currently `bidWon` is the only event that accepts an `id` parameter.\n */\npbjsInstance.onEvent = function (event, handler, id) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.onEvent', arguments);\n  if (!isFn(handler)) {\n    logError('The event handler provided is not a function and was not set on event \"' + event + '\".');\n    return;\n  }\n\n  if (id && !eventValidators[event].call(null, id)) {\n    logError('The id provided is not valid for event \"' + event + '\" and no handler was set.');\n    return;\n  }\n\n  events.on(event, handler, id);\n};\n\n/**\n * @param {string} event the name of the event\n * @param {Function} handler a callback to remove from the event\n * @param {string} id an identifier in the context of the event (see `$$PREBID_GLOBAL$$.onEvent`)\n * @alias module:pbjs.offEvent\n */\npbjsInstance.offEvent = function (event, handler, id) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.offEvent', arguments);\n  if (id && !eventValidators[event].call(null, id)) {\n    return;\n  }\n\n  events.off(event, handler, id);\n};\n\n/**\n * Return a copy of all events emitted\n *\n * @alias module:pbjs.getEvents\n */\npbjsInstance.getEvents = function () {\n  logInfo('Invoking $$PREBID_GLOBAL$$.getEvents');\n  return events.getEvents();\n};\n\n/*\n * Wrapper to register bidderAdapter externally (adapterManager.registerBidAdapter())\n * @param  {Function} bidderAdaptor [description]\n * @param  {string} bidderCode [description]\n * @alias module:pbjs.registerBidAdapter\n */\npbjsInstance.registerBidAdapter = function (bidderAdaptor, bidderCode) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.registerBidAdapter', arguments);\n  try {\n    adapterManager.registerBidAdapter(bidderAdaptor(), bidderCode);\n  } catch (e) {\n    logError('Error registering bidder adapter : ' + e.message);\n  }\n};\n\n/**\n * Wrapper to register analyticsAdapter externally (adapterManager.registerAnalyticsAdapter())\n * @param  {Object} options [description]\n * @alias module:pbjs.registerAnalyticsAdapter\n */\npbjsInstance.registerAnalyticsAdapter = function (options) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.registerAnalyticsAdapter', arguments);\n  try {\n    adapterManager.registerAnalyticsAdapter(options);\n  } catch (e) {\n    logError('Error registering analytics adapter : ' + e.message);\n  }\n};\n\n/**\n * Wrapper to bidfactory.createBid()\n * @param  {string} statusCode [description]\n * @alias module:pbjs.createBid\n * @return {Object} bidResponse [description]\n */\npbjsInstance.createBid = function (statusCode) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.createBid', arguments);\n  return createBid(statusCode);\n};\n\n/**\n * Enable sending analytics data to the analytics provider of your\n * choice.\n *\n * For usage, see [Integrate with the Prebid Analytics\n * API](http://prebid.org/dev-docs/integrate-with-the-prebid-analytics-api.html).\n *\n * For a list of analytics adapters, see [Analytics for\n * Prebid](http://prebid.org/overview/analytics.html).\n * @param  {Object} config\n * @param {string} config.provider The name of the provider, e.g., `\"ga\"` for Google Analytics.\n * @param {Object} config.options The options for this particular analytics adapter.  This will likely vary between adapters.\n * @alias module:pbjs.enableAnalytics\n */\n\n// Stores 'enableAnalytics' callbacks for later execution.\nconst enableAnalyticsCallbacks = [];\n\nconst enableAnalyticsCb = hook('async', function (config) {\n  if (config && !isEmpty(config)) {\n    logInfo('Invoking $$PREBID_GLOBAL$$.enableAnalytics for: ', config);\n    adapterManager.enableAnalytics(config);\n  } else {\n    logError('$$PREBID_GLOBAL$$.enableAnalytics should be called with option {}');\n  }\n}, 'enableAnalyticsCb');\n\npbjsInstance.enableAnalytics = function (config) {\n  enableAnalyticsCallbacks.push(enableAnalyticsCb.bind(this, config));\n};\n\n/**\n * @alias module:pbjs.aliasBidder\n */\npbjsInstance.aliasBidder = function (bidderCode, alias, options) {\n  logInfo('Invoking $$PREBID_GLOBAL$$.aliasBidder', arguments);\n  if (bidderCode && alias) {\n    adapterManager.aliasBidAdapter(bidderCode, alias, options);\n  } else {\n    logError('bidderCode and alias must be passed as arguments', '$$PREBID_GLOBAL$$.aliasBidder');\n  }\n};\n\n/**\n * @alias module:pbjs.aliasRegistry\n */\npbjsInstance.aliasRegistry = adapterManager.aliasRegistry;\nconfig.getConfig('aliasRegistry', config => {\n  if (config.aliasRegistry === 'private') delete pbjsInstance.aliasRegistry;\n});\n\n/**\n * The bid response object returned by an external bidder adapter during the auction.\n * @typedef {Object} AdapterBidResponse\n * @property {string} pbAg Auto granularity price bucket; CPM <= 5 ? increment = 0.05 : CPM > 5 && CPM <= 10 ? increment = 0.10 : CPM > 10 && CPM <= 20 ? increment = 0.50 : CPM > 20 ? priceCap = 20.00.  Example: `\"0.80\"`.\n * @property {string} pbCg Custom price bucket.  For example setup, see {@link setPriceGranularity}.  Example: `\"0.84\"`.\n * @property {string} pbDg Dense granularity price bucket; CPM <= 3 ? increment = 0.01 : CPM > 3 && CPM <= 8 ? increment = 0.05 : CPM > 8 && CPM <= 20 ? increment = 0.50 : CPM > 20? priceCap = 20.00.  Example: `\"0.84\"`.\n * @property {string} pbLg Low granularity price bucket; $0.50 increment, capped at $5, floored to two decimal places.  Example: `\"0.50\"`.\n * @property {string} pbMg Medium granularity price bucket; $0.10 increment, capped at $20, floored to two decimal places.  Example: `\"0.80\"`.\n * @property {string} pbHg High granularity price bucket; $0.01 increment, capped at $20, floored to two decimal places.  Example: `\"0.84\"`.\n *\n * @property {string} bidder The string name of the bidder.  This *may* be the same as the `bidderCode`.  For For a list of all bidders and their codes, see [Bidders' Params](http://prebid.org/dev-docs/bidders.html).\n * @property {string} bidderCode The unique string that identifies this bidder.  For a list of all bidders and their codes, see [Bidders' Params](http://prebid.org/dev-docs/bidders.html).\n *\n * @property {string} requestId The [UUID](https://en.wikipedia.org/wiki/Universally_unique_identifier) representing the bid request.\n * @property {number} requestTimestamp The time at which the bid request was sent out, expressed in milliseconds.\n * @property {number} responseTimestamp The time at which the bid response was received, expressed in milliseconds.\n * @property {number} timeToRespond How long it took for the bidder to respond with this bid, expressed in milliseconds.\n *\n * @property {string} size The size of the ad creative, expressed in `\"AxB\"` format, where A and B are numbers of pixels.  Example: `\"320x50\"`.\n * @property {string} width The width of the ad creative in pixels.  Example: `\"320\"`.\n * @property {string} height The height of the ad creative in pixels.  Example: `\"50\"`.\n *\n * @property {string} ad The actual ad creative content, often HTML with CSS, JavaScript, and/or links to additional content.  Example: `\"<div id='beacon_-YQbipJtdxmMCgEPHExLhmqzEm' style='position: absolute; left: 0px; top: 0px; visibility: hidden;'><img src='http://aplus-...'/></div><iframe src=\\\"http://aax-us-east.amazon-adsystem.com/e/is/8dcfcd...\" width=\\\"728\\\" height=\\\"90\\\" frameborder=\\\"0\\\" ...></iframe>\",`.\n * @property {number} ad_id The ad ID of the creative, as understood by the bidder's system.  Used by the line item's [creative in the ad server](http://prebid.org/adops/send-all-bids-adops.html#step-3-add-a-creative).\n * @property {string} adUnitCode The code used to uniquely identify the ad unit on the publisher's page.\n *\n * @property {string} statusMessage The status of the bid.  Allowed values: `\"Bid available\"` or `\"Bid returned empty or error response\"`.\n * @property {number} cpm The exact bid price from the bidder, expressed to the thousandths place.  Example: `\"0.849\"`.\n *\n * @property {Object} adserverTargeting An object whose values represent the ad server's targeting on the bid.\n * @property {string} adserverTargeting.hb_adid The ad ID of the creative, as understood by the ad server.\n * @property {string} adserverTargeting.hb_pb The price paid to show the creative, as logged in the ad server.\n * @property {string} adserverTargeting.hb_bidder The winning bidder whose ad creative will be served by the ad server.\n */\n\n/**\n * Get all of the bids that have been rendered.  Useful for [troubleshooting your integration](http://prebid.org/dev-docs/prebid-troubleshooting-guide.html).\n * @return {Array<AdapterBidResponse>} A list of bids that have been rendered.\n */\npbjsInstance.getAllWinningBids = function () {\n  return auctionManager.getAllWinningBids();\n};\n\n/**\n * Get all of the bids that have won their respective auctions.\n * @return {Array<AdapterBidResponse>} A list of bids that have won their respective auctions.\n */\npbjsInstance.getAllPrebidWinningBids = function () {\n  return auctionManager.getBidsReceived()\n    .filter(bid => bid.status === BID_STATUS.BID_TARGETING_SET);\n};\n\n/**\n * Get array of highest cpm bids for all adUnits, or highest cpm bid\n * object for the given adUnit\n * @param {string} adUnitCode - optional ad unit code\n * @alias module:pbjs.getHighestCpmBids\n * @return {Array} array containing highest cpm bid object(s)\n */\npbjsInstance.getHighestCpmBids = function (adUnitCode) {\n  return targeting.getWinningBids(adUnitCode);\n};\n\npbjsInstance.clearAllAuctions = function () {\n  auctionManager.clearAllAuctions();\n};\n\nif (FEATURES.VIDEO) {\n  /**\n   * Mark the winning bid as used, should only be used in conjunction with video\n   * @typedef {Object} MarkBidRequest\n   * @property {string} adUnitCode The ad unit code\n   * @property {string} adId The id representing the ad we want to mark\n   *\n   * @alias module:pbjs.markWinningBidAsUsed\n   */\n  pbjsInstance.markWinningBidAsUsed = function ({adId, adUnitCode, analytics = false}) {\n    let bids;\n    if (adUnitCode && adId == null) {\n      bids = targeting.getWinningBids(adUnitCode);\n    } else if (adId) {\n      bids = auctionManager.getBidsReceived().filter(bid => bid.adId === adId)\n    } else {\n      logWarn('Improper use of markWinningBidAsUsed. It needs an adUnitCode or an adId to function.');\n    }\n    if (bids.length > 0) {\n      if (analytics) {\n        markWinningBid(bids[0]);\n      } else {\n        auctionManager.addWinningBid(bids[0]);\n      }\n      markBidAsRendered(bids[0])\n    }\n  }\n}\n\n/**\n * Get Prebid config options\n * @param {Object} options\n * @alias module:pbjs.getConfig\n */\npbjsInstance.getConfig = config.getAnyConfig;\npbjsInstance.readConfig = config.readAnyConfig;\npbjsInstance.mergeConfig = config.mergeConfig;\npbjsInstance.mergeBidderConfig = config.mergeBidderConfig;\n\n/**\n * Set Prebid config options.\n * See https://docs.prebid.org/dev-docs/publisher-api-reference/setConfig.html\n *\n * @param {Object} options Global Prebid configuration object. Must be JSON - no JavaScript functions are allowed.\n */\npbjsInstance.setConfig = config.setConfig;\npbjsInstance.setBidderConfig = config.setBidderConfig;\n\npbjsInstance.que.push(() => listenMessagesFromCreative());\n\n/**\n * This queue lets users load Prebid asynchronously, but run functions the same way regardless of whether it gets loaded\n * before or after their script executes. For example, given the code:\n *\n * <script src=\"url/to/Prebid.js\" async></script>\n * <script>\n *   var pbjs = pbjs || {};\n *   pbjs.cmd = pbjs.cmd || [];\n *   pbjs.cmd.push(functionToExecuteOncePrebidLoads);\n * </script>\n *\n * If the page's script runs before prebid loads, then their function gets added to the queue, and executed\n * by prebid once it's done loading. If it runs after prebid loads, then this monkey-patch causes their\n * function to execute immediately.\n *\n * @param  {function} command A function which takes no arguments. This is guaranteed to run exactly once, and only after\n *                            the Prebid script has been fully loaded.\n * @alias module:pbjs.cmd.push\n * @alias module:pbjs.que.push\n */\nfunction quePush(command) {\n  if (typeof command === 'function') {\n    try {\n      command.call();\n    } catch (e) {\n      logError('Error processing command :', e.message, e.stack);\n    }\n  } else {\n    logError('Commands written into $$PREBID_GLOBAL$$.cmd.push must be wrapped in a function');\n  }\n}\n\nfunction processQueue(queue) {\n  queue.forEach(function (cmd) {\n    if (typeof cmd.called === 'undefined') {\n      try {\n        cmd.call();\n        cmd.called = true;\n      } catch (e) {\n        logError('Error processing command :', 'prebid.js', e);\n      }\n    }\n  });\n}\n\n/**\n * @alias module:pbjs.processQueue\n */\npbjsInstance.processQueue = function () {\n  pbjsInstance.que.push = pbjsInstance.cmd.push = quePush;\n  insertLocatorFrame();\n  hook.ready();\n  processQueue(pbjsInstance.que);\n  processQueue(pbjsInstance.cmd);\n};\n\n/**\n * @alias module:pbjs.triggerBilling\n */\npbjsInstance.triggerBilling = ({adId, adUnitCode}) => {\n  auctionManager.getAllWinningBids()\n    .filter((bid) => bid.adId === adId || (adId == null && bid.adUnitCode === adUnitCode))\n    .forEach((bid) => {\n      adapterManager.triggerBilling(bid);\n      renderIfDeferred(bid);\n    });\n};\n\nexport default pbjsInstance;\n","// if $$PREBID_GLOBAL$$ already exists in global document scope, use it, if not, create the object\n// global defination should happen BEFORE imports to avoid global undefined errors.\n/* global $$DEFINE_PREBID_GLOBAL$$ */\nconst scope = !$$DEFINE_PREBID_GLOBAL$$ ? {} : window;\nconst global = scope.$$PREBID_GLOBAL$$ = scope.$$PREBID_GLOBAL$$ || {};\nglobal.cmd = global.cmd || [];\nglobal.que = global.que || [];\n\n// create a pbjs global pointer\nif (scope === window) {\n  scope._pbjsGlobals = scope._pbjsGlobals || [];\n  scope._pbjsGlobals.push('$$PREBID_GLOBAL$$');\n}\n\nexport function getGlobal() {\n  return global;\n}\n\nexport function registerModule(name) {\n  global.installedModules.push(name);\n}\n","/**\n * The referer detection module attempts to gather referer information from the current page that prebid.js resides in.\n * The information that it tries to collect includes:\n * The detected top url in the nav bar,\n * Whether it was able to reach the top most window (if for example it was embedded in several iframes),\n * The number of iframes it was embedded in if applicable (by default max ten iframes),\n * A list of the domains of each embedded window if applicable.\n * Canonical URL which refers to an HTML link element, with the attribute of rel=\"canonical\", found in the <head> element of your webpage\n */\n\nimport { config } from './config.js';\nimport {logWarn} from './utils.js';\n\n/**\n * Prepend a URL with the page's protocol (http/https), if necessary.\n */\nexport function ensureProtocol(url, win = window) {\n  if (!url) return url;\n  if (/\\w+:\\/\\//.exec(url)) {\n    // url already has protocol\n    return url;\n  }\n  let windowProto = win.location.protocol;\n  try {\n    windowProto = win.top.location.protocol;\n  } catch (e) {}\n  if (/^\\/\\//.exec(url)) {\n    // url uses relative protocol (\"//example.com\")\n    return windowProto + url;\n  } else {\n    return `${windowProto}//${url}`;\n  }\n}\n\n/**\n * Extract the domain portion from a URL.\n * @param {string} url - The URL to extract the domain from.\n * @param {Object} options - Options for parsing the domain.\n * @param {boolean} options.noLeadingWww - If true, remove 'www.' appearing at the beginning of the domain.\n * @param {boolean} options.noPort - If true, do not include the ':[port]' portion.\n * @return {string|undefined} - The extracted domain or undefined if the URL is invalid.\n */\nexport function parseDomain(url, {noLeadingWww = false, noPort = false} = {}) {\n  try {\n    url = new URL(ensureProtocol(url));\n  } catch (e) {\n    return;\n  }\n  url = noPort ? url.hostname : url.host;\n  if (noLeadingWww && url.startsWith('www.')) {\n    url = url.substring(4);\n  }\n  return url;\n}\n\n/**\n * This function returns canonical URL which refers to an HTML link element, with the attribute of rel=\"canonical\", found in the <head> element of your webpage\n *\n * @param {Object} doc document\n * @returns {string|null}\n */\nfunction getCanonicalUrl(doc) {\n  try {\n    const element = doc.querySelector(\"link[rel='canonical']\");\n\n    if (element !== null) {\n      return element.href;\n    }\n  } catch (e) {\n    // Ignore error\n  }\n\n  return null;\n}\n\n/**\n * @param {Window} win Window\n * @returns {Function}\n */\nexport function detectReferer(win) {\n  /**\n   * This function would return a read-only array of hostnames for all the parent frames.\n   * win.location.ancestorOrigins is only supported in webkit browsers. For non-webkit browsers it will return undefined.\n   *\n   * @param {Window} win Window object\n   * @returns {(undefined|Array)} Ancestor origins or undefined\n   */\n  function getAncestorOrigins(win) {\n    try {\n      if (!win.location.ancestorOrigins) {\n        return;\n      }\n\n      return win.location.ancestorOrigins;\n    } catch (e) {\n      // Ignore error\n    }\n  }\n\n  // TODO: the meaning of \"reachedTop\" seems to be intentionally ambiguous - best to leave them out of\n  // the typedef for now. (for example, unit tests enforce that \"reachedTop\" should be false in some situations where we\n  // happily provide a location for the top).\n\n  /**\n   * @typedef {Object} refererInfo\n   * @property {string|null} location the browser's location, or null if not available (due to cross-origin restrictions)\n   * @property {string|null} canonicalUrl the site's canonical URL as set by the publisher, through setConfig({pageUrl}) or <link rel=\"canonical\" />\n   * @property {string|null} page the best candidate for the current page URL: `canonicalUrl`, falling back to `location`\n   * @property {string|null} domain the domain portion of `page`\n   * @property {string|null} ref the referrer (document.referrer) to the current page, or null if not available (due to cross-origin restrictions)\n   * @property {string} topmostLocation of the top-most frame for which we could guess the location. Outside of cross-origin scenarios, this is equivalent to `location`.\n   * @property {number} numIframes number of steps between window.self and window.top\n   * @property {Array<string|null>} stack our best guess at the location for each frame, in the direction top -> self.\n   */\n\n  /**\n   * Walk up the windows to get the origin stack and best available referrer, canonical URL, etc.\n   *\n   * @returns {refererInfo} An object containing referer information.\n   */\n  function refererInfo() {\n    const stack = [];\n    const ancestors = getAncestorOrigins(win);\n    const maxNestedIframes = config.getConfig('maxNestedIframes');\n\n    let currentWindow;\n    let bestLocation;\n    let bestCanonicalUrl;\n    let reachedTop = false;\n    let level = 0;\n    let valuesFromAmp = false;\n    let inAmpFrame = false;\n    let hasTopLocation = false;\n\n    do {\n      const previousWindow = currentWindow;\n      const wasInAmpFrame = inAmpFrame;\n      let currentLocation;\n      let crossOrigin = false;\n      let foundLocation = null;\n\n      inAmpFrame = false;\n      currentWindow = currentWindow ? currentWindow.parent : win;\n\n      try {\n        currentLocation = currentWindow.location.href || null;\n      } catch (e) {\n        crossOrigin = true;\n      }\n\n      if (crossOrigin) {\n        if (wasInAmpFrame) {\n          const context = previousWindow.context;\n\n          try {\n            foundLocation = context.sourceUrl;\n            bestLocation = foundLocation;\n            hasTopLocation = true;\n\n            valuesFromAmp = true;\n\n            if (currentWindow === win.top) {\n              reachedTop = true;\n            }\n\n            if (context.canonicalUrl) {\n              bestCanonicalUrl = context.canonicalUrl;\n            }\n          } catch (e) { /* Do nothing */ }\n        } else {\n          logWarn('Trying to access cross domain iframe. Continuing without referrer and location');\n\n          try {\n            // the referrer to an iframe is the parent window\n            const referrer = previousWindow.document.referrer;\n\n            if (referrer) {\n              foundLocation = referrer;\n\n              if (currentWindow === win.top) {\n                reachedTop = true;\n              }\n            }\n          } catch (e) { /* Do nothing */ }\n\n          if (!foundLocation && ancestors && ancestors[level - 1]) {\n            foundLocation = ancestors[level - 1];\n            if (currentWindow === win.top) {\n              hasTopLocation = true;\n            }\n          }\n\n          if (foundLocation && !valuesFromAmp) {\n            bestLocation = foundLocation;\n          }\n        }\n      } else {\n        if (currentLocation) {\n          foundLocation = currentLocation;\n          bestLocation = foundLocation;\n          valuesFromAmp = false;\n\n          if (currentWindow === win.top) {\n            reachedTop = true;\n\n            const canonicalUrl = getCanonicalUrl(currentWindow.document);\n\n            if (canonicalUrl) {\n              bestCanonicalUrl = canonicalUrl;\n            }\n          }\n        }\n\n        if (currentWindow.context && currentWindow.context.sourceUrl) {\n          inAmpFrame = true;\n        }\n      }\n\n      stack.push(foundLocation);\n      level++;\n    } while (currentWindow !== win.top && level < maxNestedIframes);\n\n    stack.reverse();\n\n    let ref;\n    try {\n      ref = win.top.document.referrer;\n    } catch (e) {}\n\n    const location = reachedTop || hasTopLocation ? bestLocation : null;\n    const canonicalUrl = config.getConfig('pageUrl') || bestCanonicalUrl || null;\n    let page = config.getConfig('pageUrl') || location || ensureProtocol(canonicalUrl, win);\n\n    if (location && location.indexOf('?') > -1 && page.indexOf('?') === -1) {\n      page = `${page}${location.substring(location.indexOf('?'))}`;\n    }\n\n    return {\n      reachedTop,\n      isAmp: valuesFromAmp,\n      numIframes: level - 1,\n      stack,\n      topmostLocation: bestLocation || null,\n      location,\n      canonicalUrl,\n      page,\n      domain: parseDomain(page) || null,\n      ref: ref || null,\n      // TODO: the \"legacy\" refererInfo object is provided here, for now, to accomodate\n      // adapters that decided to just send it verbatim to their backend.\n      legacy: {\n        reachedTop,\n        isAmp: valuesFromAmp,\n        numIframes: level - 1,\n        stack,\n        referer: bestLocation || null,\n        canonicalUrl\n      }\n    };\n  }\n\n  return refererInfo;\n}\n\n// cache result of fn (= referer info) as long as:\n// - we are the top window\n// - canonical URL tag and window location have not changed\nexport function cacheWithLocation(fn, win = window) {\n  if (win.top !== win) return fn;\n  let canonical, href, value;\n  return function () {\n    const newCanonical = getCanonicalUrl(win.document);\n    const newHref = win.location.href;\n    if (canonical !== newCanonical || newHref !== href) {\n      canonical = newCanonical;\n      href = newHref;\n      value = fn();\n    }\n    return value;\n  }\n}\n\n/**\n * @type {function(): refererInfo}\n */\nexport const getRefererInfo = cacheWithLocation(detectReferer(window));\n","/* Secure Creatives\n  Provides support for rendering creatives into cross domain iframes such as SafeFrame to prevent\n   access to a publisher page from creative payloads.\n */\n\nimport {getAllAssetsMessage, getAssetMessage} from './native.js';\nimport {BID_STATUS, MESSAGES} from './constants.js';\nimport {isApnGetTagDefined, isGptPubadsDefined, logError, logWarn} from './utils.js';\nimport {find, includes} from './polyfill.js';\nimport {\n  deferRendering,\n  getBidToRender,\n  handleCreativeEvent,\n  handleNativeMessage,\n  handleRender,\n  markWinner\n} from './adRendering.js';\nimport {getCreativeRendererSource} from './creativeRenderers.js';\n\nconst { REQUEST, RESPONSE, NATIVE, EVENT } = MESSAGES;\n\nconst HANDLER_MAP = {\n  [REQUEST]: handleRenderRequest,\n  [EVENT]: handleEventRequest,\n};\n\nif (FEATURES.NATIVE) {\n  Object.assign(HANDLER_MAP, {\n    [NATIVE]: handleNativeRequest,\n  });\n}\n\nexport function listenMessagesFromCreative() {\n  window.addEventListener('message', function (ev) {\n    receiveMessage(ev);\n  }, false);\n}\n\nexport function getReplier(ev) {\n  if (ev.origin == null && ev.ports.length === 0) {\n    return function () {\n      const msg = 'Cannot post message to a frame with null origin. Please update creatives to use MessageChannel, see https://github.com/prebid/Prebid.js/issues/7870';\n      logError(msg);\n      throw new Error(msg);\n    };\n  } else if (ev.ports.length > 0) {\n    return function (message) {\n      ev.ports[0].postMessage(JSON.stringify(message));\n    };\n  } else {\n    return function (message) {\n      ev.source.postMessage(JSON.stringify(message), ev.origin);\n    };\n  }\n}\n\nfunction ensureAdId(adId, reply) {\n  return function (data, ...args) {\n    return reply(Object.assign({}, data, {adId}), ...args);\n  }\n}\n\nexport function receiveMessage(ev) {\n  var key = ev.message ? 'message' : 'data';\n  var data = {};\n  try {\n    data = JSON.parse(ev[key]);\n  } catch (e) {\n    return;\n  }\n\n  if (data && data.adId && data.message && HANDLER_MAP.hasOwnProperty(data.message)) {\n    return getBidToRender(data.adId, data.message === MESSAGES.REQUEST).then(adObject => {\n      HANDLER_MAP[data.message](ensureAdId(data.adId, getReplier(ev)), data, adObject);\n    })\n  }\n}\n\nfunction getResizer(adId, bidResponse) {\n  // in some situations adId !== bidResponse.adId\n  // the first is the one that was requested and is tied to the element\n  // the second is the one that is being rendered (sometimes different, e.g. in some paapi setups)\n  return function (width, height) {\n    resizeRemoteCreative({...bidResponse, width, height, adId});\n  }\n}\nfunction handleRenderRequest(reply, message, bidResponse) {\n  handleRender({\n    renderFn(adData) {\n      reply(Object.assign({\n        message: RESPONSE,\n        renderer: getCreativeRendererSource(bidResponse)\n      }, adData));\n    },\n    resizeFn: getResizer(message.adId, bidResponse),\n    options: message.options,\n    adId: message.adId,\n    bidResponse\n  });\n}\n\nfunction handleNativeRequest(reply, data, adObject) {\n  // handle this script from native template in an ad server\n  // window.parent.postMessage(JSON.stringify({\n  //   message: 'Prebid Native',\n  //   adId: '%%PATTERN:hb_adid%%'\n  // }), '*');\n  if (adObject == null) {\n    logError(`Cannot find ad for x-origin event request: '${data.adId}'`);\n    return;\n  }\n  switch (data.action) {\n    case 'assetRequest':\n      deferRendering(adObject, () => reply(getAssetMessage(data, adObject)));\n      break;\n    case 'allAssetRequest':\n      deferRendering(adObject, () => reply(getAllAssetsMessage(data, adObject)));\n      break;\n    default:\n      handleNativeMessage(data, adObject, {resizeFn: getResizer(data.adId, adObject)});\n      markWinner(adObject);\n  }\n}\n\nfunction handleEventRequest(reply, data, adObject) {\n  if (adObject == null) {\n    logError(`Cannot find ad '${data.adId}' for x-origin event request`);\n    return;\n  }\n  if (adObject.status !== BID_STATUS.RENDERED) {\n    logWarn(`Received x-origin event request without corresponding render request for ad '${adObject.adId}'`);\n    return;\n  }\n  return handleCreativeEvent(data, adObject);\n}\n\nexport function resizeRemoteCreative({adId, adUnitCode, width, height}) {\n  function getDimension(value) {\n    return value ? value + 'px' : '100%';\n  }\n  // resize both container div + iframe\n  ['div', 'iframe'].forEach(elmType => {\n    // not select element that gets removed after dfp render\n    let element = getElementByAdUnit(elmType + ':not([style*=\"display: none\"])');\n    if (element) {\n      let elementStyle = element.style;\n      elementStyle.width = getDimension(width)\n      elementStyle.height = getDimension(height);\n    } else {\n      logError(`Unable to locate matching page element for adUnitCode ${adUnitCode}.  Can't resize it to ad's dimensions.  Please review setup.`);\n    }\n  });\n\n  function getElementByAdUnit(elmType) {\n    let id = getElementIdBasedOnAdServer(adId, adUnitCode);\n    let parentDivEle = document.getElementById(id);\n    return parentDivEle && parentDivEle.querySelector(elmType);\n  }\n\n  function getElementIdBasedOnAdServer(adId, adUnitCode) {\n    if (isGptPubadsDefined()) {\n      return getDfpElementId(adId);\n    } else if (isApnGetTagDefined()) {\n      return getAstElementId(adUnitCode);\n    } else {\n      return adUnitCode;\n    }\n  }\n\n  function getDfpElementId(adId) {\n    const slot = find(window.googletag.pubads().getSlots(), slot => {\n      return find(slot.getTargetingKeys(), key => {\n        return includes(slot.getTargeting(key), adId);\n      });\n    });\n    return slot ? slot.getSlotElementId() : null;\n  }\n\n  function getAstElementId(adUnitCode) {\n    let astTag = window.apntag.getTag(adUnitCode);\n    return astTag && astTag.targetId;\n  }\n}\n","import {checkCookieSupport, hasDeviceAccess, logError} from './utils.js';\nimport {bidderSettings} from './bidderSettings.js';\nimport {MODULE_TYPE_BIDDER, MODULE_TYPE_PREBID} from './activities/modules.js';\nimport {isActivityAllowed, registerActivityControl} from './activities/rules.js';\nimport {\n  ACTIVITY_PARAM_ADAPTER_CODE,\n  ACTIVITY_PARAM_COMPONENT_TYPE,\n  ACTIVITY_PARAM_STORAGE_TYPE\n} from './activities/params.js';\n\nimport {ACTIVITY_ACCESS_DEVICE} from './activities/activities.js';\nimport {config} from './config.js';\nimport adapterManager from './adapterManager.js';\nimport {activityParams} from './activities/activityParams.js';\n\nexport const STORAGE_TYPE_LOCALSTORAGE = 'html5';\nexport const STORAGE_TYPE_COOKIES = 'cookie';\n\nexport let storageCallbacks = [];\n\n/* eslint-disable prebid/no-global */\n\n/*\n *  Storage manager constructor. Consumers should prefer one of `getStorageManager` or `getCoreStorageManager`.\n */\nexport function newStorageManager({moduleName, moduleType} = {}, {isAllowed = isActivityAllowed} = {}) {\n  function isValid(cb, storageType) {\n    let mod = moduleName;\n    const curBidder = config.getCurrentBidder();\n    if (curBidder && moduleType === MODULE_TYPE_BIDDER && adapterManager.aliasRegistry[curBidder] === moduleName) {\n      mod = curBidder;\n    }\n    const result = {\n      valid: isAllowed(ACTIVITY_ACCESS_DEVICE, activityParams(moduleType, mod, {\n        [ACTIVITY_PARAM_STORAGE_TYPE]: storageType\n      }))\n    };\n    return cb(result);\n  }\n\n  function schedule(operation, storageType, done) {\n    if (done && typeof done === 'function') {\n      storageCallbacks.push(function() {\n        let result = isValid(operation, storageType);\n        done(result);\n      });\n    } else {\n      return isValid(operation, storageType);\n    }\n  }\n\n  /**\n   * @param {string} key\n   * @param {string} value\n   * @param {string} [expires='']\n   * @param {string} [sameSite='/']\n   * @param {string} [domain] domain (e.g., 'example.com' or 'subdomain.example.com').\n   * If not specified, defaults to the host portion of the current document location.\n   * If a domain is specified, subdomains are always included.\n   * Domain must match the domain of the JavaScript origin. Setting cookies to foreign domains will be silently ignored.\n   * @param {function} [done]\n   */\n  const setCookie = function (key, value, expires, sameSite, domain, done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        const domainPortion = (domain && domain !== '') ? ` ;domain=${encodeURIComponent(domain)}` : '';\n        const expiresPortion = (expires && expires !== '') ? ` ;expires=${expires}` : '';\n        const isNone = (sameSite != null && sameSite.toLowerCase() == 'none')\n        const secure = (isNone) ? '; Secure' : '';\n        // eslint-disable-next-line prebid/no-member\n        document.cookie = `${key}=${encodeURIComponent(value)}${expiresPortion}; path=/${domainPortion}${sameSite ? `; SameSite=${sameSite}` : ''}${secure}`;\n      }\n    }\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  };\n\n  /**\n   * @param {string} name\n   * @param {function} [done]\n   * @returns {(string|null)}\n   */\n  const getCookie = function(name, done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        let m = window.document.cookie.match('(^|;)\\\\s*' + name + '\\\\s*=\\\\s*([^;]*)\\\\s*(;|$)');\n        return m ? decodeURIComponent(m[2]) : null;\n      }\n      return null;\n    }\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  };\n\n  /**\n   * @param {function} [done]\n   * @returns {boolean}\n   */\n  const cookiesAreEnabled = function (done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        return checkCookieSupport();\n      }\n      return false;\n    }\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  }\n\n  function storageMethods(name) {\n    const capName = name.charAt(0).toUpperCase() + name.substring(1);\n    const backend = () => window[name];\n\n    const hasStorage = function (done) {\n      let cb = function (result) {\n        if (result && result.valid) {\n          try {\n            return !!backend();\n          } catch (e) {\n            logError(`${name} api disabled`);\n          }\n        }\n        return false;\n      }\n      return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n    }\n\n    return {\n      [`has${capName}`]: hasStorage,\n      [`${name}IsEnabled`](done) {\n        let cb = function (result) {\n          if (result && result.valid) {\n            try {\n              backend().setItem('prebid.cookieTest', '1');\n              return backend().getItem('prebid.cookieTest') === '1';\n            } catch (error) {\n            } finally {\n              try {\n                backend().removeItem('prebid.cookieTest');\n              } catch (error) {}\n            }\n          }\n          return false;\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      },\n      [`setDataIn${capName}`](key, value, done) {\n        let cb = function (result) {\n          if (result && result.valid && hasStorage()) {\n            backend().setItem(key, value);\n          }\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      },\n      [`getDataFrom${capName}`](key, done) {\n        let cb = function (result) {\n          if (result && result.valid && hasStorage()) {\n            return backend().getItem(key);\n          }\n          return null;\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      },\n      [`removeDataFrom${capName}`](key, done) {\n        let cb = function (result) {\n          if (result && result.valid && hasStorage()) {\n            backend().removeItem(key);\n          }\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      }\n    }\n  }\n\n  /**\n   * Returns all cookie values from the jar whose names contain the `keyLike`\n   * Needs to exist in `utils.js` as it follows the StorageHandler interface defined in live-connect-js. If that module were to be removed, this function can go as well.\n   * @param {string} keyLike\n   * @param {function} [done]\n   * @returns {string[]}\n   */\n  const findSimilarCookies = function(keyLike, done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        const all = [];\n        if (hasDeviceAccess()) {\n          // eslint-disable-next-line prebid/no-member\n          const cookies = document.cookie.split(';');\n          while (cookies.length) {\n            const cookie = cookies.pop();\n            let separatorIndex = cookie.indexOf('=');\n            separatorIndex = separatorIndex < 0 ? cookie.length : separatorIndex;\n            const cookieName = decodeURIComponent(cookie.slice(0, separatorIndex).replace(/^\\s+/, ''));\n            if (cookieName.indexOf(keyLike) >= 0) {\n              all.push(decodeURIComponent(cookie.slice(separatorIndex + 1)));\n            }\n          }\n        }\n        return all;\n      }\n    }\n\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  }\n\n  return {\n    setCookie,\n    getCookie,\n    cookiesAreEnabled,\n    ...storageMethods('localStorage'),\n    ...storageMethods('sessionStorage'),\n    findSimilarCookies\n  }\n}\n\n/**\n * Get a storage manager for a particular module.\n *\n * Either bidderCode or a combination of moduleType + moduleName must be provided. The former is a shorthand\n *  for `{moduleType: 'bidder', moduleName: bidderCode}`.\n *\n */\nexport function getStorageManager({moduleType, moduleName, bidderCode} = {}) {\n  function err() {\n    throw new Error(`Invalid invocation for getStorageManager: must set either bidderCode, or moduleType + moduleName`)\n  }\n  if (bidderCode) {\n    if ((moduleType && moduleType !== MODULE_TYPE_BIDDER) || moduleName) err()\n    moduleType = MODULE_TYPE_BIDDER;\n    moduleName = bidderCode;\n  } else if (!moduleName || !moduleType) {\n    err()\n  }\n  return newStorageManager({moduleType, moduleName});\n}\n\n/**\n * Get a storage manager for \"core\" (vendorless, or first-party) modules. Shorthand for `getStorageManager({moduleName, moduleType: 'core'})`.\n *\n * @param {string} moduleName Module name\n */\nexport function getCoreStorageManager(moduleName) {\n  return newStorageManager({moduleName: moduleName, moduleType: MODULE_TYPE_PREBID});\n}\n\n/**\n * Block all access to storage when deviceAccess = false\n */\nexport function deviceAccessRule() {\n  if (!hasDeviceAccess()) {\n    return {allow: false}\n  }\n}\nregisterActivityControl(ACTIVITY_ACCESS_DEVICE, 'deviceAccess config', deviceAccessRule);\n\n/**\n * By default, deny bidders accessDevice unless they enable it through bidderSettings\n *\n * // TODO: for backwards compat, the check is done on the adapter - rather than bidder's code.\n */\nexport function storageAllowedRule(params, bs = bidderSettings) {\n  if (params[ACTIVITY_PARAM_COMPONENT_TYPE] !== MODULE_TYPE_BIDDER) return;\n  let allow = bs.get(params[ACTIVITY_PARAM_ADAPTER_CODE], 'storageAllowed');\n  if (!allow || allow === true) {\n    allow = !!allow\n  } else {\n    const storageType = params[ACTIVITY_PARAM_STORAGE_TYPE];\n    allow = Array.isArray(allow) ? allow.some((e) => e === storageType) : allow === storageType;\n  }\n  if (!allow) {\n    return {allow};\n  }\n}\n\nregisterActivityControl(ACTIVITY_ACCESS_DEVICE, 'bidderSettings.*.storageAllowed', storageAllowedRule);\n\nexport function resetData() {\n  storageCallbacks = [];\n}\n","import { auctionManager } from './auctionManager.js';\nimport { getBufferedTTL } from './bidTTL.js';\nimport { bidderSettings } from './bidderSettings.js';\nimport { config } from './config.js';\nimport {\n  BID_STATUS,\n  DEFAULT_TARGETING_KEYS,\n  EVENTS,\n  JSON_MAPPING,\n  NATIVE_KEYS,\n  STATUS,\n  TARGETING_KEYS\n} from './constants.js';\nimport * as events from './events.js';\nimport { hook } from './hook.js';\nimport { ADPOD } from './mediaTypes.js';\nimport { NATIVE_TARGETING_KEYS } from './native.js';\nimport { find, includes } from './polyfill.js';\nimport {\n  deepAccess,\n  deepClone,\n  groupBy,\n  isAdUnitCodeMatchingSlot,\n  isArray,\n  isFn,\n  isGptPubadsDefined,\n  isStr,\n  logError,\n  logInfo,\n  logMessage,\n  logWarn,\n  sortByHighestCpm,\n  timestamp,\n  uniques,\n} from './utils.js';\nimport { getHighestCpm, getOldestHighestCpmBid } from './utils/reducers.js';\n\nvar pbTargetingKeys = [];\n\nconst MAX_DFP_KEYLENGTH = 20;\n\nconst CFG_ALLOW_TARGETING_KEYS = `targetingControls.allowTargetingKeys`;\nconst CFG_ADD_TARGETING_KEYS = `targetingControls.addTargetingKeys`;\nconst TARGETING_KEY_CONFIGURATION_ERROR_MSG = `Only one of \"${CFG_ALLOW_TARGETING_KEYS}\" or \"${CFG_ADD_TARGETING_KEYS}\" can be set`;\n\nexport const TARGETING_KEYS_ARR = Object.keys(TARGETING_KEYS).map(\n  key => TARGETING_KEYS[key]\n);\n\n// return unexpired bids\nconst isBidNotExpired = (bid) => (bid.responseTimestamp + getBufferedTTL(bid) * 1000) > timestamp();\n\n// return bids whose status is not set. Winning bids can only have a status of `rendered`.\nconst isUnusedBid = (bid) => bid && ((bid.status && !includes([BID_STATUS.RENDERED], bid.status)) || !bid.status);\n\nexport let filters = {\n  isActualBid(bid) {\n    return bid.getStatusCode() === STATUS.GOOD\n  },\n  isBidNotExpired,\n  isUnusedBid\n};\n\nexport function isBidUsable(bid) {\n  return !Object.values(filters).some((predicate) => !predicate(bid));\n}\n\n// If two bids are found for same adUnitCode, we will use the highest one to take part in auction\n// This can happen in case of concurrent auctions\n// If adUnitBidLimit is set above 0 return top N number of bids\nexport const getHighestCpmBidsFromBidPool = hook('sync', function(bidsReceived, winReducer, adUnitBidLimit = 0, hasModified = false, winSorter = sortByHighestCpm) {\n  if (!hasModified) {\n    const bids = [];\n    const dealPrioritization = config.getConfig('sendBidsControl.dealPrioritization');\n    // bucket by adUnitcode\n    let buckets = groupBy(bidsReceived, 'adUnitCode');\n    // filter top bid for each bucket by bidder\n    Object.keys(buckets).forEach(bucketKey => {\n      let bucketBids = [];\n      let bidsByBidder = groupBy(buckets[bucketKey], 'bidderCode')\n      Object.keys(bidsByBidder).forEach(key => { bucketBids.push(bidsByBidder[key].reduce(winReducer)) });\n      // if adUnitBidLimit is set, pass top N number bids\n      if (adUnitBidLimit) {\n        bucketBids = dealPrioritization ? bucketBids.sort(sortByDealAndPriceBucketOrCpm(true)) : bucketBids.sort((a, b) => b.cpm - a.cpm);\n        bids.push(...bucketBids.slice(0, adUnitBidLimit));\n      } else {\n        bucketBids = bucketBids.sort(winSorter)\n        bids.push(...bucketBids);\n      }\n    });\n\n    return bids;\n  }\n\n  return bidsReceived;\n});\n\n/**\n * A descending sort function that will sort the list of objects based on the following two dimensions:\n *  - bids with a deal are sorted before bids w/o a deal\n *  - then sort bids in each grouping based on the hb_pb value\n * eg: the following list of bids would be sorted like:\n *  [{\n *    \"hb_adid\": \"vwx\",\n *    \"hb_pb\": \"28\",\n *    \"hb_deal\": \"7747\"\n *  }, {\n *    \"hb_adid\": \"jkl\",\n *    \"hb_pb\": \"10\",\n *    \"hb_deal\": \"9234\"\n *  }, {\n *    \"hb_adid\": \"stu\",\n *    \"hb_pb\": \"50\"\n *  }, {\n *    \"hb_adid\": \"def\",\n *    \"hb_pb\": \"2\"\n *  }]\n */\nexport function sortByDealAndPriceBucketOrCpm(useCpm = false) {\n  return function(a, b) {\n    if (a.adserverTargeting.hb_deal !== undefined && b.adserverTargeting.hb_deal === undefined) {\n      return -1;\n    }\n\n    if ((a.adserverTargeting.hb_deal === undefined && b.adserverTargeting.hb_deal !== undefined)) {\n      return 1;\n    }\n\n    // assuming both values either have a deal or don't have a deal - sort by the hb_pb param\n    if (useCpm) {\n      return b.cpm - a.cpm;\n    }\n\n    return b.adserverTargeting.hb_pb - a.adserverTargeting.hb_pb;\n  }\n}\n\n/**\n * Return a map where each code in `adUnitCodes` maps to a list of GPT slots that match it.\n *\n * @param {Array<String>} adUnitCodes\n * @param customSlotMatching\n * @param getSlots\n * @return {Object.<string,any>}\n */\nexport function getGPTSlotsForAdUnits(adUnitCodes, customSlotMatching, getSlots = () => window.googletag.pubads().getSlots()) {\n  return getSlots().reduce((auToSlots, slot) => {\n    const customMatch = isFn(customSlotMatching) && customSlotMatching(slot);\n    Object.keys(auToSlots).filter(isFn(customMatch) ? customMatch : isAdUnitCodeMatchingSlot(slot)).forEach(au => auToSlots[au].push(slot));\n    return auToSlots;\n  }, Object.fromEntries(adUnitCodes.map(au => [au, []])));\n}\n\n/**\n * Clears targeting for bids\n */\nfunction clearTargeting(slot) {\n  pbTargetingKeys.forEach(key => {\n    if (slot.getTargeting(key)) {\n      slot.clearTargeting(key)\n    }\n  })\n}\n\n/**\n * @typedef {Object.<string,string>} targeting\n * @property {string} targeting_key\n */\n\n/**\n * @typedef {Object.<string,Object.<string,string[]>[]>[]} targetingArray\n */\n\nexport function newTargeting(auctionManager) {\n  let targeting = {};\n  let latestAuctionForAdUnit = {};\n\n  targeting.setLatestAuctionForAdUnit = function(adUnitCode, auctionId) {\n    latestAuctionForAdUnit[adUnitCode] = auctionId;\n  };\n\n  targeting.resetPresetTargeting = function(adUnitCode, customSlotMatching) {\n    if (isGptPubadsDefined()) {\n      const adUnitCodes = getAdUnitCodes(adUnitCode);\n      Object.values(getGPTSlotsForAdUnits(adUnitCodes, customSlotMatching)).forEach((slots) => {\n        slots.forEach(slot => {\n          clearTargeting(slot)\n        })\n      })\n    }\n  };\n\n  targeting.resetPresetTargetingAST = function(adUnitCode) {\n    const adUnitCodes = getAdUnitCodes(adUnitCode);\n    adUnitCodes.forEach(function(unit) {\n      const astTag = window.apntag.getTag(unit);\n      if (astTag && astTag.keywords) {\n        const currentKeywords = Object.keys(astTag.keywords);\n        const newKeywords = {};\n        currentKeywords.forEach((key) => {\n          if (!includes(pbTargetingKeys, key.toLowerCase())) {\n            newKeywords[key] = astTag.keywords[key];\n          }\n        })\n        window.apntag.modifyTag(unit, { keywords: newKeywords })\n      }\n    });\n  };\n\n  function addBidToTargeting(bids, enableSendAllBids = false, deals = false) {\n    const standardKeys = FEATURES.NATIVE ? TARGETING_KEYS_ARR.concat(NATIVE_TARGETING_KEYS) : TARGETING_KEYS_ARR.slice();\n    const allowSendAllBidsTargetingKeys = config.getConfig('targetingControls.allowSendAllBidsTargetingKeys');\n\n    const allowedSendAllBidTargeting = allowSendAllBidsTargetingKeys\n      ? allowSendAllBidsTargetingKeys.map((key) => TARGETING_KEYS[key])\n      : standardKeys;\n\n    return bids.reduce((result, bid) => {\n      if (enableSendAllBids || (deals && bid.dealId)) {\n        const targetingValue = getTargetingMap(bid, standardKeys.filter(\n          key => typeof bid.adserverTargeting[key] !== 'undefined' &&\n          (deals || allowedSendAllBidTargeting.indexOf(key) !== -1)));\n\n        if (targetingValue) {\n          result.push({[bid.adUnitCode]: targetingValue})\n        }\n      }\n      return result;\n    }, []);\n  }\n\n  function getBidderTargeting(bids) {\n    const alwaysIncludeDeals = config.getConfig('targetingControls.alwaysIncludeDeals');\n    const enableSendAllBids = config.getConfig('enableSendAllBids');\n    return addBidToTargeting(bids, enableSendAllBids, alwaysIncludeDeals);\n  }\n\n  /**\n   * Returns filtered ad server targeting for custom and allowed keys.\n   * @param {targetingArray} targeting\n   * @param {string[]} allowedKeys\n   * @return {targetingArray} filtered targeting\n   */\n  function getAllowedTargetingKeyValues(targeting, allowedKeys) {\n    const defaultKeyring = Object.assign({}, TARGETING_KEYS, NATIVE_KEYS);\n    const defaultKeys = Object.keys(defaultKeyring);\n    const keyDispositions = {};\n    logInfo(`allowTargetingKeys - allowed keys [ ${allowedKeys.map(k => defaultKeyring[k]).join(', ')} ]`);\n    targeting.map(adUnit => {\n      const adUnitCode = Object.keys(adUnit)[0];\n      const keyring = adUnit[adUnitCode];\n      const keys = keyring.filter(kvPair => {\n        const key = Object.keys(kvPair)[0];\n        // check if key is in default keys, if not, it's custom, we won't remove it.\n        const isCustom = defaultKeys.filter(defaultKey => key.indexOf(defaultKeyring[defaultKey]) === 0).length === 0;\n        // check if key explicitly allowed, if not, we'll remove it.\n        const found = isCustom || find(allowedKeys, allowedKey => {\n          const allowedKeyName = defaultKeyring[allowedKey];\n          // we're looking to see if the key exactly starts with one of our default keys.\n          // (which hopefully means it's not custom)\n          const found = key.indexOf(allowedKeyName) === 0;\n          return found;\n        });\n        keyDispositions[key] = !found;\n        return found;\n      });\n      adUnit[adUnitCode] = keys;\n    });\n    const removedKeys = Object.keys(keyDispositions).filter(d => keyDispositions[d]);\n    logInfo(`allowTargetingKeys - removed keys [ ${removedKeys.join(', ')} ]`);\n    // remove any empty targeting objects, as they're unnecessary.\n    const filteredTargeting = targeting.filter(adUnit => {\n      const adUnitCode = Object.keys(adUnit)[0];\n      const keyring = adUnit[adUnitCode];\n      return keyring.length > 0;\n    });\n    return filteredTargeting\n  }\n\n  /**\n   * Returns all ad server targeting for all ad units.\n   * @param {string=} adUnitCode\n   * @return {Object.<string,targeting>} targeting\n   */\n  targeting.getAllTargeting = function(adUnitCode, bidLimit, bidsReceived, winReducer = getHighestCpm, winSorter = sortByHighestCpm) {\n    bidsReceived ||= getBidsReceived(winReducer, winSorter);\n    const adUnitCodes = getAdUnitCodes(adUnitCode);\n    const sendAllBids = config.getConfig('enableSendAllBids');\n    const bidLimitConfigValue = config.getConfig('sendBidsControl.bidLimit');\n    const adUnitBidLimit = (sendAllBids && (bidLimit || bidLimitConfigValue)) || 0;\n    const { customKeysByUnit, filteredBids } = getfilteredBidsAndCustomKeys(adUnitCodes, bidsReceived);\n    const bidsSorted = getHighestCpmBidsFromBidPool(filteredBids, winReducer, adUnitBidLimit, undefined, winSorter);\n    let targeting = getTargetingLevels(bidsSorted, customKeysByUnit);\n\n    const defaultKeys = Object.keys(Object.assign({}, DEFAULT_TARGETING_KEYS, NATIVE_KEYS));\n    let allowedKeys = config.getConfig(CFG_ALLOW_TARGETING_KEYS);\n    const addedKeys = config.getConfig(CFG_ADD_TARGETING_KEYS);\n\n    if (addedKeys != null && allowedKeys != null) {\n      throw new Error(TARGETING_KEY_CONFIGURATION_ERROR_MSG);\n    } else if (addedKeys != null) {\n      allowedKeys = defaultKeys.concat(addedKeys);\n    } else {\n      allowedKeys = allowedKeys || defaultKeys;\n    }\n\n    if (Array.isArray(allowedKeys) && allowedKeys.length > 0) {\n      targeting = getAllowedTargetingKeyValues(targeting, allowedKeys);\n    }\n\n    targeting = flattenTargeting(targeting);\n\n    const auctionKeysThreshold = config.getConfig('targetingControls.auctionKeyMaxChars');\n    if (auctionKeysThreshold) {\n      logInfo(`Detected 'targetingControls.auctionKeyMaxChars' was active for this auction; set with a limit of ${auctionKeysThreshold} characters.  Running checks on auction keys...`);\n      targeting = filterTargetingKeys(targeting, auctionKeysThreshold);\n    }\n\n    // make sure at least there is a entry per adUnit code in the targetingSet so receivers of SET_TARGETING call's can know what ad units are being invoked\n    adUnitCodes.forEach(code => {\n      if (!targeting[code]) {\n        targeting[code] = {};\n      }\n    });\n\n    return targeting;\n  };\n\n  function updatePBTargetingKeys(adUnitCode) {\n    (Object.keys(adUnitCode)).forEach(key => {\n      adUnitCode[key].forEach(targetKey => {\n        const targetKeys = Object.keys(targetKey);\n        if (pbTargetingKeys.indexOf(targetKeys[0]) === -1) {\n          pbTargetingKeys = targetKeys.concat(pbTargetingKeys);\n        }\n      });\n    });\n  }\n\n  function getTargetingLevels(bidsSorted, customKeysByUnit) {\n    const targeting = getWinningBidTargeting(bidsSorted)\n      .concat(getCustomBidTargeting(bidsSorted, customKeysByUnit))\n      .concat(getBidderTargeting(bidsSorted))\n      .concat(getAdUnitTargeting());\n\n    targeting.forEach(adUnitCode => {\n      updatePBTargetingKeys(adUnitCode);\n    });\n\n    return targeting;\n  }\n\n  function getfilteredBidsAndCustomKeys(adUnitCodes, bidsReceived) {\n    const filteredBids = [];\n    const customKeysByUnit = {};\n    const alwaysIncludeDeals = config.getConfig('targetingControls.alwaysIncludeDeals');\n\n    bidsReceived.forEach(bid => {\n      const adUnitIsEligible = includes(adUnitCodes, bid.adUnitCode);\n      const cpmAllowed = bidderSettings.get(bid.bidderCode, 'allowZeroCpmBids') === true ? bid.cpm >= 0 : bid.cpm > 0;\n      const isPreferredDeal = alwaysIncludeDeals && bid.dealId;\n\n      if (adUnitIsEligible && (isPreferredDeal || cpmAllowed)) {\n        filteredBids.push(bid);\n        Object.keys(bid.adserverTargeting)\n          .filter(getCustomKeys())\n          .forEach(key => {\n            const truncKey = key.substring(0, MAX_DFP_KEYLENGTH);\n            const data = customKeysByUnit[bid.adUnitCode] || {};\n            const value = [bid.adserverTargeting[key]];\n\n            if (data[truncKey]) {\n              data[truncKey] = data[truncKey].concat(value).filter(uniques);\n            } else {\n              data[truncKey] = value;\n            }\n\n            customKeysByUnit[bid.adUnitCode] = data;\n          })\n      }\n    });\n\n    return {filteredBids, customKeysByUnit};\n  }\n\n  // warn about conflicting configuration\n  config.getConfig('targetingControls', function (config) {\n    if (deepAccess(config, CFG_ALLOW_TARGETING_KEYS) != null && deepAccess(config, CFG_ADD_TARGETING_KEYS) != null) {\n      logError(TARGETING_KEY_CONFIGURATION_ERROR_MSG);\n    }\n  });\n\n  // create an encoded string variant based on the keypairs of the provided object\n  //  - note this will encode the characters between the keys (ie = and &)\n  function convertKeysToQueryForm(keyMap) {\n    return Object.keys(keyMap).reduce(function (queryString, key) {\n      let encodedKeyPair = `${key}%3d${encodeURIComponent(keyMap[key])}%26`;\n      return queryString += encodedKeyPair;\n    }, '');\n  }\n\n  function filterTargetingKeys(targeting, auctionKeysThreshold) {\n    // read each targeting.adUnit object and sort the adUnits into a list of adUnitCodes based on priorization setting (eg CPM)\n    let targetingCopy = deepClone(targeting);\n\n    let targetingMap = Object.keys(targetingCopy).map(adUnitCode => {\n      return {\n        adUnitCode,\n        adserverTargeting: targetingCopy[adUnitCode]\n      };\n    }).sort(sortByDealAndPriceBucketOrCpm());\n\n    // iterate through the targeting based on above list and transform the keys into the query-equivalent and count characters\n    return targetingMap.reduce(function (accMap, currMap, index, arr) {\n      let adUnitQueryString = convertKeysToQueryForm(currMap.adserverTargeting);\n\n      // for the last adUnit - trim last encoded ampersand from the converted query string\n      if ((index + 1) === arr.length) {\n        adUnitQueryString = adUnitQueryString.slice(0, -3);\n      }\n\n      // if under running threshold add to result\n      let code = currMap.adUnitCode;\n      let querySize = adUnitQueryString.length;\n      if (querySize <= auctionKeysThreshold) {\n        auctionKeysThreshold -= querySize;\n        logInfo(`AdUnit '${code}' auction keys comprised of ${querySize} characters.  Deducted from running threshold; new limit is ${auctionKeysThreshold}`, targetingCopy[code]);\n\n        accMap[code] = targetingCopy[code];\n      } else {\n        logWarn(`The following keys for adUnitCode '${code}' exceeded the current limit of the 'auctionKeyMaxChars' setting.\\nThe key-set size was ${querySize}, the current allotted amount was ${auctionKeysThreshold}.\\n`, targetingCopy[code]);\n      }\n\n      if ((index + 1) === arr.length && Object.keys(accMap).length === 0) {\n        logError('No auction targeting keys were permitted due to the setting in setConfig(targetingControls.auctionKeyMaxChars).  Please review setup and consider adjusting.');\n      }\n      return accMap;\n    }, {});\n  }\n\n  /**\n   * Converts targeting array and flattens to make it easily iteratable\n   * e.g: Sample input to this function\n   * ```\n   * [\n   *    {\n   *      \"div-gpt-ad-1460505748561-0\": [{\"hb_bidder\": [\"appnexusAst\"]}]\n   *    },\n   *    {\n   *      \"div-gpt-ad-1460505748561-0\": [{\"hb_bidder_appnexusAs\": [\"appnexusAst\", \"other\"]}]\n   *    }\n   * ]\n   * ```\n   * Resulting array\n   * ```\n   * {\n   *  \"div-gpt-ad-1460505748561-0\": {\n   *    \"hb_bidder\": \"appnexusAst\",\n   *    \"hb_bidder_appnexusAs\": \"appnexusAst,other\"\n   *  }\n   * }\n   * ```\n   *\n   * @param {targetingArray}  targeting\n   * @return {Object.<string,targeting>}  targeting\n   */\n  function flattenTargeting(targeting) {\n    let targetingObj = targeting.map(targeting => {\n      return {\n        [Object.keys(targeting)[0]]: targeting[Object.keys(targeting)[0]]\n          .map(target => {\n            return {\n              [Object.keys(target)[0]]: target[Object.keys(target)[0]].join(',')\n            };\n          }).reduce((p, c) => Object.assign(c, p), {})\n      };\n    })\n\n    targetingObj = targetingObj.reduce(function (accumulator, targeting) {\n      var key = Object.keys(targeting)[0];\n      accumulator[key] = Object.assign({}, accumulator[key], targeting[key]);\n      return accumulator;\n    }, {});\n\n    return targetingObj;\n  }\n\n  targeting.setTargetingForGPT = hook('sync', function (adUnit, customSlotMatching) {\n  // get our ad unit codes\n    let targetingSet = targeting.getAllTargeting(adUnit);\n\n    let resetMap = Object.fromEntries(pbTargetingKeys.map(key => [key, null]));\n\n    Object.entries(getGPTSlotsForAdUnits(Object.keys(targetingSet), customSlotMatching)).forEach(([targetId, slots]) => {\n      slots.forEach(slot => {\n      // now set new targeting keys\n        Object.keys(targetingSet[targetId]).forEach(key => {\n          let value = targetingSet[targetId][key];\n          if (typeof value === 'string' && value.indexOf(',') !== -1) {\n          // due to the check the array will be formed only if string has ',' else plain string will be assigned as value\n            value = value.split(',');\n          }\n          targetingSet[targetId][key] = value;\n        });\n        logMessage(`Attempting to set targeting-map for slot: ${slot.getSlotElementId()} with targeting-map:`, targetingSet[targetId]);\n        slot.updateTargetingFromMap(Object.assign({}, resetMap, targetingSet[targetId]))\n      })\n    })\n\n    Object.keys(targetingSet).forEach((adUnitCode) => {\n      Object.keys(targetingSet[adUnitCode]).forEach((targetingKey) => {\n        if (targetingKey === 'hb_adid') {\n          auctionManager.setStatusForBids(targetingSet[adUnitCode][targetingKey], BID_STATUS.BID_TARGETING_SET);\n        }\n      });\n    });\n\n    targeting.targetingDone(targetingSet);\n\n    // emit event\n    events.emit(EVENTS.SET_TARGETING, targetingSet);\n  }, 'setTargetingForGPT');\n\n  targeting.targetingDone = hook('sync', function (targetingSet) {\n    return targetingSet;\n  }, 'targetingDone');\n\n  /**\n   * normlizes input to a `adUnit.code` array\n   * @param  {(string|string[])} adUnitCode [description]\n   * @return {string[]}     AdUnit code array\n   */\n  function getAdUnitCodes(adUnitCode) {\n    if (typeof adUnitCode === 'string') {\n      return [adUnitCode];\n    } else if (isArray(adUnitCode)) {\n      return adUnitCode;\n    }\n    return auctionManager.getAdUnitCodes() || [];\n  }\n\n  function getBidsReceived(winReducer = getOldestHighestCpmBid, winSorter = undefined) {\n    let bidsReceived = auctionManager.getBidsReceived().reduce((bids, bid) => {\n      const bidCacheEnabled = config.getConfig('useBidCache');\n      const filterFunction = config.getConfig('bidCacheFilterFunction');\n      const isBidFromLastAuction = latestAuctionForAdUnit[bid.adUnitCode] === bid.auctionId;\n      const filterFunctionResult = bidCacheEnabled && !isBidFromLastAuction && typeof filterFunction === 'function' ? !!filterFunction(bid) : true;\n      const cacheFilter = bidCacheEnabled || isBidFromLastAuction;\n      const bidFilter = cacheFilter && filterFunctionResult;\n\n      if (bidFilter && deepAccess(bid, 'video.context') !== ADPOD && isBidUsable(bid)) {\n        bid.latestTargetedAuctionId = latestAuctionForAdUnit[bid.adUnitCode];\n        bids.push(bid)\n      }\n\n      return bids;\n    }, []);\n\n    return getHighestCpmBidsFromBidPool(bidsReceived, winReducer, undefined, undefined, undefined, winSorter);\n  }\n\n  /**\n   * Returns top bids for a given adUnit or set of adUnits.\n   * @param  {(string|string[])} adUnitCode adUnitCode or array of adUnitCodes\n   * @param  {(Array|undefined)} bids - The received bids, defaulting to the result of getBidsReceived().\n   * @param  {function(Array<Object>): Array<Object>} [winReducer = getHighestCpm] - reducer method\n   * @param  {function(Array<Object>): Array<Object>} [winSorter = sortByHighestCpm] - sorter method\n   * @return {Array<Object>} - An array of winning bids.\n   */\n  targeting.getWinningBids = function(adUnitCode, bids, winReducer = getHighestCpm, winSorter = sortByHighestCpm) {\n    const usedCodes = [];\n    const bidsReceived = bids || getBidsReceived(winReducer, winSorter);\n    const adUnitCodes = getAdUnitCodes(adUnitCode);\n\n    return bidsReceived\n      .reduce((result, bid) => {\n        const code = bid.adUnitCode;\n        const cpmEligible = bidderSettings.get(code, 'allowZeroCpmBids') === true ? bid.cpm >= 0 : bid.cpm > 0;\n        const isPreferredDeal = config.getConfig('targetingControls.alwaysIncludeDeals') && bid.dealId;\n        const eligible = includes(adUnitCodes, code) &&\n          !includes(usedCodes, code) &&\n          (isPreferredDeal || cpmEligible)\n        if (eligible) {\n          result.push(bid);\n          usedCodes.push(code);\n        }\n\n        return result;\n      }, []);\n  };\n\n  /**\n   * @param  {(string|string[])} adUnitCodes adUnitCode or array of adUnitCodes\n   * Sets targeting for AST\n   */\n  targeting.setTargetingForAst = function(adUnitCodes) {\n    let astTargeting = targeting.getAllTargeting(adUnitCodes);\n\n    try {\n      targeting.resetPresetTargetingAST(adUnitCodes);\n    } catch (e) {\n      logError('unable to reset targeting for AST' + e)\n    }\n\n    Object.keys(astTargeting).forEach(targetId =>\n      Object.keys(astTargeting[targetId]).forEach(key => {\n        logMessage(`Attempting to set targeting for targetId: ${targetId} key: ${key} value: ${astTargeting[targetId][key]}`);\n        // setKeywords supports string and array as value\n        if (isStr(astTargeting[targetId][key]) || isArray(astTargeting[targetId][key])) {\n          let keywordsObj = {};\n          let regex = /pt[0-9]/;\n          if (key.search(regex) < 0) {\n            keywordsObj[key.toUpperCase()] = astTargeting[targetId][key];\n          } else {\n            // pt${n} keys should not be uppercased\n            keywordsObj[key] = astTargeting[targetId][key];\n          }\n          window.apntag.setKeywords(targetId, keywordsObj, { overrideKeyValue: true });\n        }\n      })\n    );\n  };\n\n  /**\n   * Get targeting key value pairs for winning bid.\n   * @param {Array<Object>} bidsReceived code array\n   * @return {targetingArray} winning bids targeting\n   */\n  function getWinningBidTargeting(bidsReceived) {\n    let usedAdUnitCodes = [];\n    let winners = bidsReceived\n      .reduce((bids, bid) => {\n        if (!includes(usedAdUnitCodes, bid.adUnitCode)) {\n          bids.push(bid);\n          usedAdUnitCodes.push(bid.adUnitCode);\n        }\n        return bids;\n      }, []);\n\n    let standardKeys = getStandardKeys();\n\n    winners = winners.map(winner => {\n      return {\n        [winner.adUnitCode]: Object.keys(winner.adserverTargeting)\n          .filter(key =>\n            typeof winner.sendStandardTargeting === 'undefined' ||\n            winner.sendStandardTargeting ||\n            standardKeys.indexOf(key) === -1)\n          .reduce((acc, key) => {\n            const targetingValue = [winner.adserverTargeting[key]];\n            const targeting = { [key.substring(0, MAX_DFP_KEYLENGTH)]: targetingValue };\n            if (key === TARGETING_KEYS.DEAL) {\n              const bidderCodeTargetingKey = `${key}_${winner.bidderCode}`.substring(0, MAX_DFP_KEYLENGTH);\n              const bidderCodeTargeting = { [bidderCodeTargetingKey]: targetingValue };\n              return [...acc, targeting, bidderCodeTargeting];\n            }\n            return [...acc, targeting];\n          }, [])\n      };\n    });\n\n    return winners;\n  }\n\n  function getStandardKeys() {\n    return auctionManager.getStandardBidderAdServerTargeting() // in case using a custom standard key set\n      .map(targeting => targeting.key)\n      .concat(TARGETING_KEYS_ARR).filter(uniques); // standard keys defined in the library.\n  }\n\n  function getCustomKeys() {\n    let standardKeys = getStandardKeys();\n    if (FEATURES.NATIVE) {\n      standardKeys = standardKeys.concat(NATIVE_TARGETING_KEYS);\n    }\n    return function(key) {\n      return standardKeys.indexOf(key) === -1;\n    }\n  }\n\n  /**\n   * Get custom targeting key value pairs for bids.\n   * @param {Array<Object>} bidsSorted code array\n   * @param {Object} customKeysByUnit code array\n   * @return {targetingArray} bids with custom targeting defined in bidderSettings\n   */\n  function getCustomBidTargeting(bidsSorted, customKeysByUnit) {\n    return bidsSorted\n      .reduce((acc, bid) => {\n        const newBid = Object.assign({}, bid);\n        const customKeysForUnit = customKeysByUnit[newBid.adUnitCode];\n        const targeting = [];\n\n        if (customKeysForUnit) {\n          Object.keys(customKeysForUnit).forEach(key => {\n            if (key && customKeysForUnit[key]) targeting.push({[key]: customKeysForUnit[key]});\n          })\n        }\n\n        acc.push({[newBid.adUnitCode]: targeting});\n\n        return acc;\n      }, []);\n  }\n\n  function getTargetingMap(bid, keys) {\n    return keys.reduce((targeting, key) => {\n      const value = bid.adserverTargeting[key];\n      if (value) {\n        targeting.push({[`${key}_${bid.bidderCode}`.substring(0, MAX_DFP_KEYLENGTH)]: [bid.adserverTargeting[key]]})\n      }\n      return targeting;\n    }, []);\n  }\n\n  function getAdUnitTargeting() {\n    function getTargetingObj(adUnit) {\n      return deepAccess(adUnit, JSON_MAPPING.ADSERVER_TARGETING);\n    }\n\n    function getTargetingValues(adUnit) {\n      const aut = getTargetingObj(adUnit);\n\n      return Object.keys(aut)\n        .map(function(key) {\n          if (isStr(aut[key])) aut[key] = aut[key].split(',').map(s => s.trim());\n          if (!isArray(aut[key])) aut[key] = [ aut[key] ];\n          return { [key]: aut[key] };\n        });\n    }\n\n    return auctionManager.getAdUnits()\n      .filter(adUnit => getTargetingObj(adUnit))\n      .reduce((result, adUnit) => {\n        const targetingValues = getTargetingValues(adUnit);\n\n        if (targetingValues)result.push({[adUnit.code]: targetingValues});\n        return result;\n      }, []);\n  }\n\n  targeting.isApntagDefined = function() {\n    if (window.apntag && isFn(window.apntag.setKeywords)) {\n      return true;\n    }\n  };\n\n  return targeting;\n}\n\nexport const targeting = newTargeting(auctionManager);\n","import {\n  deepClone, isPlainObject, logError, shuffle, logMessage, triggerPixel, insertUserSyncIframe, isArray,\n  logWarn, isStr, isSafariBrowser\n} from './utils.js';\nimport { config } from './config.js';\nimport {includes} from './polyfill.js';\nimport { getCoreStorageManager } from './storageManager.js';\nimport {isActivityAllowed, registerActivityControl} from './activities/rules.js';\nimport {ACTIVITY_SYNC_USER} from './activities/activities.js';\nimport {\n  ACTIVITY_PARAM_COMPONENT_NAME,\n  ACTIVITY_PARAM_COMPONENT_TYPE,\n  ACTIVITY_PARAM_SYNC_TYPE, ACTIVITY_PARAM_SYNC_URL\n} from './activities/params.js';\nimport {MODULE_TYPE_BIDDER} from './activities/modules.js';\nimport {activityParams} from './activities/activityParams.js';\n\nexport const USERSYNC_DEFAULT_CONFIG = {\n  syncEnabled: true,\n  filterSettings: {\n    image: {\n      bidders: '*',\n      filter: 'include'\n    }\n  },\n  syncsPerBidder: 5,\n  syncDelay: 3000,\n  auctionDelay: 500\n};\n\n// Set userSync default values\nconfig.setDefaults({\n  'userSync': deepClone(USERSYNC_DEFAULT_CONFIG)\n});\n\nconst storage = getCoreStorageManager('usersync');\n\n/**\n * Factory function which creates a new UserSyncPool.\n *\n * @param {} deps Configuration options and dependencies which the\n *   UserSync object needs in order to behave properly.\n */\nexport function newUserSync(deps) {\n  let publicApi = {};\n  // A queue of user syncs for each adapter\n  // Let getDefaultQueue() set the defaults\n  let queue = getDefaultQueue();\n\n  // Whether or not user syncs have been trigger on this page load for a specific bidder\n  let hasFiredBidder = new Set();\n  // How many bids for each adapter\n  let numAdapterBids = {};\n\n  // for now - default both to false in case filterSettings config is absent/misconfigured\n  let permittedPixels = {\n    image: true,\n    iframe: false\n  };\n\n  // Use what is in config by default\n  let usConfig = deps.config;\n  // Update if it's (re)set\n  config.getConfig('userSync', (conf) => {\n    // Added this logic for https://github.com/prebid/Prebid.js/issues/4864\n    // if userSync.filterSettings does not contain image/all configs, merge in default image config to ensure image pixels are fired\n    if (conf.userSync) {\n      let fs = conf.userSync.filterSettings;\n      if (isPlainObject(fs)) {\n        if (!fs.image && !fs.all) {\n          conf.userSync.filterSettings.image = {\n            bidders: '*',\n            filter: 'include'\n          };\n        }\n      }\n    }\n\n    usConfig = Object.assign(usConfig, conf.userSync);\n  });\n\n  deps.regRule(ACTIVITY_SYNC_USER, 'userSync config', (params) => {\n    if (!usConfig.syncEnabled) {\n      return {allow: false, reason: 'syncs are disabled'}\n    }\n    if (params[ACTIVITY_PARAM_COMPONENT_TYPE] === MODULE_TYPE_BIDDER) {\n      const syncType = params[ACTIVITY_PARAM_SYNC_TYPE];\n      const bidder = params[ACTIVITY_PARAM_COMPONENT_NAME];\n      if (!publicApi.canBidderRegisterSync(syncType, bidder)) {\n        return {allow: false, reason: `${syncType} syncs are not enabled for ${bidder}`}\n      }\n    }\n  });\n\n  /**\n   * @function getDefaultQueue\n   * @summary Returns the default empty queue\n   * @private\n   * @return {object} A queue with no syncs\n   */\n  function getDefaultQueue() {\n    return {\n      image: [],\n      iframe: []\n    };\n  }\n\n  /**\n   * @function fireSyncs\n   * @summary Trigger all user syncs in the queue\n   * @private\n   */\n  function fireSyncs() {\n    if (!usConfig.syncEnabled || !deps.browserSupportsCookies) {\n      return;\n    }\n\n    try {\n      // Iframe syncs\n      loadIframes();\n      // Image pixels\n      fireImagePixels();\n    } catch (e) {\n      return logError('Error firing user syncs', e);\n    }\n    // Reset the user sync queue\n    queue = getDefaultQueue();\n  }\n\n  function forEachFire(queue, fn) {\n    // Randomize the order of the pixels before firing\n    // This is to avoid giving any bidder who has registered multiple syncs\n    // any preferential treatment and balancing them out\n    shuffle(queue).forEach(fn);\n  }\n\n  /**\n   * @function fireImagePixels\n   * @summary Loops through user sync pixels and fires each one\n   * @private\n   */\n  function fireImagePixels() {\n    if (!permittedPixels.image) {\n      return;\n    }\n    forEachFire(queue.image, (sync) => {\n      let [bidderName, trackingPixelUrl] = sync;\n      logMessage(`Invoking image pixel user sync for bidder: ${bidderName}`);\n      // Create image object and add the src url\n      triggerPixel(trackingPixelUrl);\n    });\n  }\n\n  /**\n   * @function loadIframes\n   * @summary Loops through iframe syncs and loads an iframe element into the page\n   * @private\n   */\n  function loadIframes() {\n    if (!(permittedPixels.iframe)) {\n      return;\n    }\n\n    forEachFire(queue.iframe, (sync) => {\n      let [bidderName, iframeUrl] = sync;\n      logMessage(`Invoking iframe user sync for bidder: ${bidderName}`);\n      // Insert iframe into DOM\n      insertUserSyncIframe(iframeUrl);\n      // for a bidder, if iframe sync is present then remove image pixel\n      removeImagePixelsForBidder(queue, bidderName);\n    });\n  }\n\n  function removeImagePixelsForBidder(queue, iframeSyncBidderName) {\n    queue.image = queue.image.filter(imageSync => {\n      let imageSyncBidderName = imageSync[0];\n      return imageSyncBidderName !== iframeSyncBidderName\n    });\n  }\n\n  /**\n   * @function incrementAdapterBids\n   * @summary Increment the count of user syncs queue for the adapter\n   * @private\n   * @param {object} numAdapterBids The object contain counts for all adapters\n   * @param {string} bidder The name of the bidder adding a sync\n   * @returns {object} The updated version of numAdapterBids\n   */\n  function incrementAdapterBids(numAdapterBids, bidder) {\n    if (!numAdapterBids[bidder]) {\n      numAdapterBids[bidder] = 1;\n    } else {\n      numAdapterBids[bidder] += 1;\n    }\n    return numAdapterBids;\n  }\n\n  /**\n   * @function registerSync\n   * @summary Add sync for this bidder to a queue to be fired later\n   * @public\n   * @param {string} type The type of the sync including image, iframe\n   * @param {string} bidder The name of the adapter. e.g. \"rubicon\"\n   * @param {string} url Either the pixel url or iframe url depending on the type\n   * @example <caption>Using Image Sync</caption>\n   * // registerSync(type, adapter, pixelUrl)\n   * userSync.registerSync('image', 'rubicon', 'http://example.com/pixel')\n   */\n  publicApi.registerSync = (type, bidder, url) => {\n    if (hasFiredBidder.has(bidder)) {\n      return logMessage(`already fired syncs for \"${bidder}\", ignoring registerSync call`);\n    }\n    if (!usConfig.syncEnabled || !isArray(queue[type])) {\n      return logWarn(`User sync type \"${type}\" not supported`);\n    }\n    if (!bidder) {\n      return logWarn(`Bidder is required for registering sync`);\n    }\n    if (usConfig.syncsPerBidder !== 0 && Number(numAdapterBids[bidder]) >= usConfig.syncsPerBidder) {\n      return logWarn(`Number of user syncs exceeded for \"${bidder}\"`);\n    }\n\n    if (deps.isAllowed(ACTIVITY_SYNC_USER, activityParams(MODULE_TYPE_BIDDER, bidder, {\n      [ACTIVITY_PARAM_SYNC_TYPE]: type,\n      [ACTIVITY_PARAM_SYNC_URL]: url\n    }))) {\n      // the bidder's pixel has passed all checks and is allowed to register\n      queue[type].push([bidder, url]);\n      numAdapterBids = incrementAdapterBids(numAdapterBids, bidder);\n    }\n  };\n\n  /**\n   * Mark a bidder as done with its user syncs - no more will be accepted from them in this session.\n   * @param {string} bidderCode\n   */\n  publicApi.bidderDone = hasFiredBidder.add.bind(hasFiredBidder);\n\n  /**\n   * @function shouldBidderBeBlocked\n   * @summary Check filterSettings logic to determine if the bidder should be prevented from registering their userSync tracker\n   * @private\n   * @param {string} type The type of the sync; either image or iframe\n   * @param {string} bidder The name of the adapter. e.g. \"rubicon\"\n   * @returns {boolean} true => bidder is not allowed to register; false => bidder can register\n   */\n  function shouldBidderBeBlocked(type, bidder) {\n    let filterConfig = usConfig.filterSettings;\n\n    // apply the filter check if the config object is there (eg filterSettings.iframe exists) and if the config object is properly setup\n    if (isFilterConfigValid(filterConfig, type)) {\n      permittedPixels[type] = true;\n\n      let activeConfig = (filterConfig.all) ? filterConfig.all : filterConfig[type];\n      let biddersToFilter = (activeConfig.bidders === '*') ? [bidder] : activeConfig.bidders;\n      let filterType = activeConfig.filter || 'include'; // set default if undefined\n\n      // return true if the bidder is either: not part of the include (ie outside the whitelist) or part of the exclude (ie inside the blacklist)\n      const checkForFiltering = {\n        'include': (bidders, bidder) => !includes(bidders, bidder),\n        'exclude': (bidders, bidder) => includes(bidders, bidder)\n      }\n      return checkForFiltering[filterType](biddersToFilter, bidder);\n    }\n    return !permittedPixels[type];\n  }\n\n  /**\n   * @function isFilterConfigValid\n   * @summary Check if the filterSettings object in the userSync config is setup properly\n   * @private\n   * @param {object} filterConfig sub-config object taken from filterSettings\n   * @param {string} type The type of the sync; either image or iframe\n   * @returns {boolean} true => config is setup correctly, false => setup incorrectly or filterConfig[type] is not present\n   */\n  function isFilterConfigValid(filterConfig, type) {\n    if (filterConfig.all && filterConfig[type]) {\n      logWarn(`Detected presence of the \"filterSettings.all\" and \"filterSettings.${type}\" in userSync config.  You cannot mix \"all\" with \"iframe/image\" configs; they are mutually exclusive.`);\n      return false;\n    }\n\n    let activeConfig = (filterConfig.all) ? filterConfig.all : filterConfig[type];\n    let activeConfigName = (filterConfig.all) ? 'all' : type;\n\n    // if current pixel type isn't part of the config's logic, skip rest of the config checks...\n    // we return false to skip subsequent filter checks in shouldBidderBeBlocked() function\n    if (!activeConfig) {\n      return false;\n    }\n\n    let filterField = activeConfig.filter;\n    let biddersField = activeConfig.bidders;\n\n    if (filterField && filterField !== 'include' && filterField !== 'exclude') {\n      logWarn(`UserSync \"filterSettings.${activeConfigName}.filter\" setting '${filterField}' is not a valid option; use either 'include' or 'exclude'.`);\n      return false;\n    }\n\n    if (biddersField !== '*' && !(Array.isArray(biddersField) && biddersField.length > 0 && biddersField.every(bidderInList => isStr(bidderInList) && bidderInList !== '*'))) {\n      logWarn(`Detected an invalid setup in userSync \"filterSettings.${activeConfigName}.bidders\"; use either '*' (to represent all bidders) or an array of bidders.`);\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * @function syncUsers\n   * @summary Trigger all the user syncs based on publisher-defined timeout\n   * @public\n   * @param {number} timeout The delay in ms before syncing data - default 0\n   */\n  publicApi.syncUsers = (timeout = 0) => {\n    if (timeout) {\n      return setTimeout(fireSyncs, Number(timeout));\n    }\n    fireSyncs();\n  };\n\n  /**\n   * @function triggerUserSyncs\n   * @summary A `syncUsers` wrapper for determining if enableOverride has been turned on\n   * @public\n   */\n  publicApi.triggerUserSyncs = () => {\n    if (usConfig.enableOverride) {\n      publicApi.syncUsers();\n    }\n  };\n\n  publicApi.canBidderRegisterSync = (type, bidder) => {\n    if (usConfig.filterSettings) {\n      if (shouldBidderBeBlocked(type, bidder)) {\n        return false;\n      }\n    }\n    return true;\n  };\n  return publicApi;\n}\n\nexport const userSync = newUserSync(Object.defineProperties({\n  config: config.getConfig('userSync'),\n  isAllowed: isActivityAllowed,\n  regRule: registerActivityControl,\n}, {\n  browserSupportsCookies: {\n    get: function() {\n      // call storage lazily to give time for consent data to be available\n      return !isSafariBrowser() && storage.cookiesAreEnabled();\n    }\n  }\n}));\n\n/**\n * @typedef {Object} UserSyncConfig\n *\n * @property {boolean} enableOverride\n * @property {boolean} syncEnabled\n * @property {number} syncsPerBidder\n * @property {string[]} enabledBidders\n * @property {Object} filterSettings\n */\n","import {config} from './config.js';\nimport {klona} from 'klona/json';\nimport {includes} from './polyfill.js';\nimport {EVENTS} from './constants.js';\nimport {GreedyPromise} from './utils/promise.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport { default as deepAccess } from 'dlv/index.js';\n\nexport { deepAccess };\nexport { dset as deepSetValue } from 'dset';\n\nvar tStr = 'String';\nvar tFn = 'Function';\nvar tNumb = 'Number';\nvar tObject = 'Object';\nvar tBoolean = 'Boolean';\nvar toString = Object.prototype.toString;\nlet consoleExists = Boolean(window.console);\nlet consoleLogExists = Boolean(consoleExists && window.console.log);\nlet consoleInfoExists = Boolean(consoleExists && window.console.info);\nlet consoleWarnExists = Boolean(consoleExists && window.console.warn);\nlet consoleErrorExists = Boolean(consoleExists && window.console.error);\n\nlet eventEmitter;\n\nconst pbjsInstance = getGlobal();\n\nexport function _setEventEmitter(emitFn) {\n  // called from events.js - this hoop is to avoid circular imports\n  eventEmitter = emitFn;\n}\n\nfunction emitEvent(...args) {\n  if (eventEmitter != null) {\n    eventEmitter(...args);\n  }\n}\n\n// this allows stubbing of utility functions that are used internally by other utility functions\nexport const internal = {\n  checkCookieSupport,\n  createTrackPixelIframeHtml,\n  getWindowSelf,\n  getWindowTop,\n  canAccessWindowTop,\n  getWindowLocation,\n  insertUserSyncIframe,\n  insertElement,\n  isFn,\n  triggerPixel,\n  logError,\n  logWarn,\n  logMessage,\n  logInfo,\n  parseQS,\n  formatQS,\n  deepEqual\n};\n\nlet prebidInternal = {};\n/**\n * Returns object that is used as internal prebid namespace\n */\nexport function getPrebidInternal() {\n  return prebidInternal;\n}\n\n/* utility method to get incremental integer starting from 1 */\nvar getIncrementalInteger = (function () {\n  var count = 0;\n  return function () {\n    count++;\n    return count;\n  };\n})();\n\n// generate a random string (to be used as a dynamic JSONP callback)\nexport function getUniqueIdentifierStr() {\n  return getIncrementalInteger() + Math.random().toString(16).substr(2);\n}\n\n/**\n * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,\n * where each x is replaced with a random hexadecimal digit from 0 to f,\n * and y is replaced with a random hexadecimal digit from 8 to b.\n * https://gist.github.com/jed/982883 via node-uuid\n */\nexport function generateUUID(placeholder) {\n  return placeholder\n    ? (placeholder ^ _getRandomData() >> placeholder / 4).toString(16)\n    : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, generateUUID);\n}\n\n/**\n * Returns random data using the Crypto API if available and Math.random if not\n * Method is from https://gist.github.com/jed/982883 like generateUUID, direct link https://gist.github.com/jed/982883#gistcomment-45104\n */\nfunction _getRandomData() {\n  if (window && window.crypto && window.crypto.getRandomValues) {\n    return crypto.getRandomValues(new Uint8Array(1))[0] % 16;\n  } else {\n    return Math.random() * 16;\n  }\n}\n\nexport function getBidIdParameter(key, paramsObj) {\n  return paramsObj?.[key] || '';\n}\n\n// parse a query string object passed in bid params\n// bid params should be an object such as {key: \"value\", key1 : \"value1\"}\n// aliases to formatQS\nexport function parseQueryStringParameters(queryObj) {\n  let result = '';\n  for (var k in queryObj) {\n    if (queryObj.hasOwnProperty(k)) { result += k + '=' + encodeURIComponent(queryObj[k]) + '&'; }\n  }\n  result = result.replace(/&$/, '');\n  return result;\n}\n\n// transform an AdServer targeting bids into a query string to send to the adserver\nexport function transformAdServerTargetingObj(targeting) {\n  // we expect to receive targeting for a single slot at a time\n  if (targeting && Object.getOwnPropertyNames(targeting).length > 0) {\n    return Object.keys(targeting)\n      .map(key => `${key}=${encodeURIComponent(targeting[key])}`).join('&');\n  } else {\n    return '';\n  }\n}\n\n/**\n * Parse a GPT-Style general size Array like `[[300, 250]]` or `\"300x250,970x90\"` into an array of width, height tuples `[[300, 250]]` or '[[300,250], [970,90]]'\n */\nexport function sizesToSizeTuples(sizes) {\n  if (typeof sizes === 'string') {\n    // multiple sizes will be comma-separated\n    return sizes\n      .split(/\\s*,\\s*/)\n      .map(sz => sz.match(/^(\\d+)x(\\d+)$/i))\n      .filter(match => match)\n      .map(([_, w, h]) => [parseInt(w, 10), parseInt(h, 10)])\n  } else if (Array.isArray(sizes)) {\n    if (isValidGPTSingleSize(sizes)) {\n      return [sizes]\n    }\n    return sizes.filter(isValidGPTSingleSize);\n  }\n  return [];\n}\n\n/**\n * Parse a GPT-Style general size Array like `[[300, 250]]` or `\"300x250,970x90\"` into an array of sizes `[\"300x250\"]` or '['300x250', '970x90']'\n * @param  {(Array.<number[]>|Array.<number>)} sizeObj Input array or double array [300,250] or [[300,250], [728,90]]\n * @return {Array.<string>}  Array of strings like `[\"300x250\"]` or `[\"300x250\", \"728x90\"]`\n */\nexport function parseSizesInput(sizeObj) {\n  return sizesToSizeTuples(sizeObj).map(sizeTupleToSizeString);\n}\n\nexport function sizeTupleToSizeString(size) {\n  return size[0] + 'x' + size[1]\n}\n\n// Parse a GPT style single size array, (i.e [300, 250])\n// into an AppNexus style string, (i.e. 300x250)\nexport function parseGPTSingleSizeArray(singleSize) {\n  if (isValidGPTSingleSize(singleSize)) {\n    return sizeTupleToSizeString(singleSize);\n  }\n}\n\nexport function sizeTupleToRtbSize(size) {\n  return {w: size[0], h: size[1]};\n}\n\n// Parse a GPT style single size array, (i.e [300, 250])\n// into OpenRTB-compatible (imp.banner.w/h, imp.banner.format.w/h, imp.video.w/h) object(i.e. {w:300, h:250})\nexport function parseGPTSingleSizeArrayToRtbSize(singleSize) {\n  if (isValidGPTSingleSize(singleSize)) {\n    return sizeTupleToRtbSize(singleSize)\n  }\n}\n\nfunction isValidGPTSingleSize(singleSize) {\n  // if we aren't exactly 2 items in this array, it is invalid\n  return isArray(singleSize) && singleSize.length === 2 && (!isNaN(singleSize[0]) && !isNaN(singleSize[1]));\n}\n\nexport function getWindowTop() {\n  return window.top;\n}\n\nexport function getWindowSelf() {\n  return window.self;\n}\n\nexport function getWindowLocation() {\n  return window.location;\n}\n\nexport function canAccessWindowTop() {\n  try {\n    if (internal.getWindowTop().location.href) {\n      return true;\n    }\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Wrappers to console.(log | info | warn | error). Takes N arguments, the same as the native methods\n */\nexport function logMessage() {\n  if (debugTurnedOn() && consoleLogExists) {\n    // eslint-disable-next-line no-console\n    console.log.apply(console, decorateLog(arguments, 'MESSAGE:'));\n  }\n}\n\nexport function logInfo() {\n  if (debugTurnedOn() && consoleInfoExists) {\n    // eslint-disable-next-line no-console\n    console.info.apply(console, decorateLog(arguments, 'INFO:'));\n  }\n}\n\nexport function logWarn() {\n  if (debugTurnedOn() && consoleWarnExists) {\n    // eslint-disable-next-line no-console\n    console.warn.apply(console, decorateLog(arguments, 'WARNING:'));\n  }\n  emitEvent(EVENTS.AUCTION_DEBUG, { type: 'WARNING', arguments: arguments });\n}\n\nexport function logError() {\n  if (debugTurnedOn() && consoleErrorExists) {\n    // eslint-disable-next-line no-console\n    console.error.apply(console, decorateLog(arguments, 'ERROR:'));\n  }\n  emitEvent(EVENTS.AUCTION_DEBUG, { type: 'ERROR', arguments: arguments });\n}\n\nexport function prefixLog(prefix) {\n  function decorate(fn) {\n    return function (...args) {\n      fn(prefix, ...args);\n    }\n  }\n  return {\n    logError: decorate(logError),\n    logWarn: decorate(logWarn),\n    logMessage: decorate(logMessage),\n    logInfo: decorate(logInfo),\n  }\n}\n\nfunction decorateLog(args, prefix) {\n  args = [].slice.call(args);\n  let bidder = config.getCurrentBidder();\n\n  prefix && args.unshift(prefix);\n  if (bidder) {\n    args.unshift(label('#aaa'));\n  }\n  args.unshift(label('#3b88c3'));\n  args.unshift('%cPrebid' + (bidder ? `%c${bidder}` : ''));\n  return args;\n\n  function label(color) {\n    return `display: inline-block; color: #fff; background: ${color}; padding: 1px 4px; border-radius: 3px;`\n  }\n}\n\nexport function hasConsoleLogger() {\n  return consoleLogExists;\n}\n\nexport function debugTurnedOn() {\n  return !!config.getConfig('debug');\n}\n\nexport const createIframe = (() => {\n  const DEFAULTS = {\n    border: '0px',\n    hspace: '0',\n    vspace: '0',\n    marginWidth: '0',\n    marginHeight: '0',\n    scrolling: 'no',\n    frameBorder: '0',\n    allowtransparency: 'true'\n  }\n  return (doc, attrs, style = {}) => {\n    const f = doc.createElement('iframe');\n    Object.assign(f, Object.assign({}, DEFAULTS, attrs));\n    Object.assign(f.style, style);\n    return f;\n  }\n})();\n\nexport function createInvisibleIframe() {\n  return createIframe(document, {\n    id: getUniqueIdentifierStr(),\n    width: 0,\n    height: 0,\n    src: 'about:blank'\n  }, {\n    display: 'none',\n    height: '0px',\n    width: '0px',\n    border: '0px'\n  });\n}\n\n/*\n *   Check if a given parameter name exists in query string\n *   and if it does return the value\n */\nexport function getParameterByName(name) {\n  return parseQS(getWindowLocation().search)[name] || '';\n}\n\n/**\n * Return if the object is of the\n * given type.\n * @param {*} object to test\n * @param {String} _t type string (e.g., Array)\n * @return {Boolean} if object is of type _t\n */\nexport function isA(object, _t) {\n  return toString.call(object) === '[object ' + _t + ']';\n}\n\nexport function isFn(object) {\n  return isA(object, tFn);\n}\n\nexport function isStr(object) {\n  return isA(object, tStr);\n}\n\nexport const isArray = Array.isArray.bind(Array);\n\nexport function isNumber(object) {\n  return isA(object, tNumb);\n}\n\nexport function isPlainObject(object) {\n  return isA(object, tObject);\n}\n\nexport function isBoolean(object) {\n  return isA(object, tBoolean);\n}\n\n/**\n * Return if the object is \"empty\";\n * this includes falsey, no keys, or no items at indices\n * @param {*} object object to test\n * @return {Boolean} if object is empty\n */\nexport function isEmpty(object) {\n  if (!object) return true;\n  if (isArray(object) || isStr(object)) {\n    return !(object.length > 0);\n  }\n  return Object.keys(object).length <= 0;\n}\n\n/**\n * Return if string is empty, null, or undefined\n * @param str string to test\n * @returns {boolean} if string is empty\n */\nexport function isEmptyStr(str) {\n  return isStr(str) && (!str || str.length === 0);\n}\n\n/**\n * Iterate object with the function\n * falls back to es5 `forEach`\n * @param {Array|Object} object\n * @param {Function} fn - The function to execute for each element. It receives three arguments: value, key, and the original object.\n * @returns {void}\n */\nexport function _each(object, fn) {\n  if (isFn(object?.forEach)) return object.forEach(fn, this);\n  Object.entries(object || {}).forEach(([k, v]) => fn.call(this, v, k));\n}\n\nexport function contains(a, obj) {\n  return isFn(a?.includes) && a.includes(obj);\n}\n\n/**\n * Map an array or object into another array\n * given a function\n * @param {Array|Object} object\n * @param {Function} callback - The function to execute for each element. It receives three arguments: value, key, and the original object.\n * @return {Array}\n */\nexport function _map(object, callback) {\n  if (isFn(object?.map)) return object.map(callback);\n  return Object.entries(object || {}).map(([k, v]) => callback(v, k, object))\n}\n\n/*\n* Inserts an element(elm) as targets child, by default as first child\n* @param {HTMLElement} elm\n* @param {HTMLElement} [doc]\n* @param {HTMLElement} [target]\n* @param {Boolean} [asLastChildChild]\n* @return {HTML Element}\n*/\nexport function insertElement(elm, doc, target, asLastChildChild) {\n  doc = doc || document;\n  let parentEl;\n  if (target) {\n    parentEl = doc.getElementsByTagName(target);\n  } else {\n    parentEl = doc.getElementsByTagName('head');\n  }\n  try {\n    parentEl = parentEl.length ? parentEl : doc.getElementsByTagName('body');\n    if (parentEl.length) {\n      parentEl = parentEl[0];\n      let insertBeforeEl = asLastChildChild ? null : parentEl.firstChild;\n      return parentEl.insertBefore(elm, insertBeforeEl);\n    }\n  } catch (e) {}\n}\n\n/**\n * Returns a promise that completes when the given element triggers a 'load' or 'error' DOM event, or when\n * `timeout` milliseconds have elapsed.\n *\n * @param {HTMLElement} element\n * @param {Number} [timeout]\n * @returns {Promise}\n */\nexport function waitForElementToLoad(element, timeout) {\n  let timer = null;\n  return new GreedyPromise((resolve) => {\n    const onLoad = function() {\n      element.removeEventListener('load', onLoad);\n      element.removeEventListener('error', onLoad);\n      if (timer != null) {\n        window.clearTimeout(timer);\n      }\n      resolve();\n    };\n    element.addEventListener('load', onLoad);\n    element.addEventListener('error', onLoad);\n    if (timeout != null) {\n      timer = window.setTimeout(onLoad, timeout);\n    }\n  });\n}\n\n/**\n * Inserts an image pixel with the specified `url` for cookie sync\n * @param {string} url URL string of the image pixel to load\n * @param  {function} [done] an optional exit callback, used when this usersync pixel is added during an async process\n * @param  {Number} [timeout] an optional timeout in milliseconds for the image to load before calling `done`\n */\nexport function triggerPixel(url, done, timeout) {\n  const img = new Image();\n  if (done && internal.isFn(done)) {\n    waitForElementToLoad(img, timeout).then(done);\n  }\n  img.src = url;\n}\n\n/**\n * Inserts an empty iframe with the specified `html`, primarily used for tracking purposes\n * (though could be for other purposes)\n * @param {string} htmlCode snippet of HTML code used for tracking purposes\n */\nexport function insertHtmlIntoIframe(htmlCode) {\n  if (!htmlCode) {\n    return;\n  }\n  const iframe = createInvisibleIframe();\n  internal.insertElement(iframe, document, 'body');\n\n  ((doc) => {\n    doc.open();\n    doc.write(htmlCode);\n    doc.close();\n  })(iframe.contentWindow.document);\n}\n\n/**\n * Inserts empty iframe with the specified `url` for cookie sync\n * @param  {string} url URL to be requested\n * @param  {function} [done] an optional exit callback, used when this usersync pixel is added during an async process\n * @param  {Number} [timeout] an optional timeout in milliseconds for the iframe to load before calling `done`\n */\nexport function insertUserSyncIframe(url, done, timeout) {\n  let iframeHtml = internal.createTrackPixelIframeHtml(url, false, 'allow-scripts allow-same-origin');\n  let div = document.createElement('div');\n  div.innerHTML = iframeHtml;\n  let iframe = div.firstChild;\n  if (done && internal.isFn(done)) {\n    waitForElementToLoad(iframe, timeout).then(done);\n  }\n  internal.insertElement(iframe, document, 'html', true);\n}\n\n/**\n * Creates a snippet of HTML that retrieves the specified `url`\n * @param  {string} url URL to be requested\n * @param encode\n * @return {string}     HTML snippet that contains the img src = set to `url`\n */\nexport function createTrackPixelHtml(url, encode = encodeURI) {\n  if (!url) {\n    return '';\n  }\n\n  let escapedUrl = encode(url);\n  let img = '<div style=\"position:absolute;left:0px;top:0px;visibility:hidden;\">';\n  img += '<img src=\"' + escapedUrl + '\"></div>';\n  return img;\n};\n\n/**\n * encodeURI, but preserves macros of the form '${MACRO}' (e.g. '${AUCTION_PRICE}')\n * @param url\n * @return {string}\n */\nexport function encodeMacroURI(url) {\n  const macros = Array.from(url.matchAll(/\\$({[^}]+})/g)).map(match => match[1]);\n  return macros.reduce((str, macro) => {\n    return str.replace('$' + encodeURIComponent(macro), '$' + macro)\n  }, encodeURI(url))\n}\n\n/**\n * Creates a snippet of Iframe HTML that retrieves the specified `url`\n * @param  {string} url plain URL to be requested\n * @param  {string} encodeUri boolean if URL should be encoded before inserted. Defaults to true\n * @param  {string} sandbox string if provided the sandbox attribute will be included with the given value\n * @return {string}     HTML snippet that contains the iframe src = set to `url`\n */\nexport function createTrackPixelIframeHtml(url, encodeUri = true, sandbox = '') {\n  if (!url) {\n    return '';\n  }\n  if (encodeUri) {\n    url = encodeURI(url);\n  }\n  if (sandbox) {\n    sandbox = `sandbox=\"${sandbox}\"`;\n  }\n\n  return `<iframe ${sandbox} id=\"${getUniqueIdentifierStr()}\"\n      frameborder=\"0\"\n      allowtransparency=\"true\"\n      marginheight=\"0\" marginwidth=\"0\"\n      width=\"0\" hspace=\"0\" vspace=\"0\" height=\"0\"\n      style=\"height:0px;width:0px;display:none;\"\n      scrolling=\"no\"\n      src=\"${url}\">\n    </iframe>`;\n}\n\nexport function uniques(value, index, arry) {\n  return arry.indexOf(value) === index;\n}\n\nexport function flatten(a, b) {\n  return a.concat(b);\n}\n\nexport function getBidRequest(id, bidderRequests) {\n  if (!id) {\n    return;\n  }\n  return bidderRequests.flatMap(br => br.bids)\n    .find(bid => ['bidId', 'adId', 'bid_id'].some(prop => bid[prop] === id))\n}\n\nexport function getValue(obj, key) {\n  return obj[key];\n}\n\nexport function getBidderCodes(adUnits = pbjsInstance.adUnits) {\n  // this could memoize adUnits\n  return adUnits.map(unit => unit.bids.map(bid => bid.bidder)\n    .reduce(flatten, [])).reduce(flatten, []).filter((bidder) => typeof bidder !== 'undefined').filter(uniques);\n}\n\nexport function isGptPubadsDefined() {\n  if (window.googletag && isFn(window.googletag.pubads) && isFn(window.googletag.pubads().getSlots)) {\n    return true;\n  }\n}\n\nexport function isApnGetTagDefined() {\n  if (window.apntag && isFn(window.apntag.getTag)) {\n    return true;\n  }\n}\n\nexport const sortByHighestCpm = (a, b) => {\n  return b.cpm - a.cpm;\n}\n\n/**\n * Fisher–Yates shuffle\n * http://stackoverflow.com/a/6274398\n * https://bost.ocks.org/mike/shuffle/\n * istanbul ignore next\n */\nexport function shuffle(array) {\n  let counter = array.length;\n\n  // while there are elements in the array\n  while (counter > 0) {\n    // pick a random index\n    let index = Math.floor(Math.random() * counter);\n\n    // decrease counter by 1\n    counter--;\n\n    // and swap the last element with it\n    let temp = array[counter];\n    array[counter] = array[index];\n    array[index] = temp;\n  }\n\n  return array;\n}\n\nexport function deepClone(obj) {\n  return klona(obj) || {};\n}\n\nexport function inIframe() {\n  try {\n    return internal.getWindowSelf() !== internal.getWindowTop();\n  } catch (e) {\n    return true;\n  }\n}\n\n/**\n * https://iabtechlab.com/wp-content/uploads/2016/03/SafeFrames_v1.1_final.pdf\n */\nexport function isSafeFrameWindow() {\n  if (!inIframe()) {\n    return false;\n  }\n\n  const ws = internal.getWindowSelf();\n  return !!(ws.$sf && ws.$sf.ext);\n}\n\n/**\n * Returns the result of calling the function $sf.ext.geom() if it exists\n * @see https://iabtechlab.com/wp-content/uploads/2016/03/SafeFrames_v1.1_final.pdf — 5.4 Function $sf.ext.geom\n * @returns {Object | undefined} geometric information about the container\n */\nexport function getSafeframeGeometry() {\n  try {\n    const ws = getWindowSelf();\n    return (typeof ws.$sf.ext.geom === 'function') ? ws.$sf.ext.geom() : undefined;\n  } catch (e) {\n    logError('Error getting SafeFrame geometry', e);\n    return undefined;\n  }\n}\n\nexport function isSafariBrowser() {\n  return /^((?!chrome|android|crios|fxios).)*safari/i.test(navigator.userAgent);\n}\n\nexport function replaceMacros(str, subs) {\n  if (!str) return;\n  return Object.entries(subs).reduce((str, [key, val]) => {\n    return str.replace(new RegExp('\\\\$\\\\{' + key + '\\\\}', 'g'), val || '');\n  }, str);\n}\n\nexport function replaceAuctionPrice(str, cpm) {\n  return replaceMacros(str, {AUCTION_PRICE: cpm})\n}\n\nexport function replaceClickThrough(str, clicktag) {\n  if (!str || !clicktag || typeof clicktag !== 'string') return;\n  return str.replace(/\\${CLICKTHROUGH}/g, clicktag);\n}\n\nexport function timestamp() {\n  return new Date().getTime();\n}\n\n/**\n * The returned value represents the time elapsed since the time origin. @see https://developer.mozilla.org/en-US/docs/Web/API/Performance/now\n * @returns {number}\n */\nexport function getPerformanceNow() {\n  return (window.performance && window.performance.now && window.performance.now()) || 0;\n}\n\n/**\n * Retuns the difference between `timing.domLoading` and `timing.navigationStart`.\n * This function uses the deprecated `Performance.timing` API and should be removed in future.\n * It has not been updated yet because it is still used in some modules.\n * @deprecated\n * @param {Window} w The window object used to perform the api call. default to window.self\n * @returns {number}\n */\nexport function getDomLoadingDuration(w) {\n  let domLoadingDuration = -1;\n\n  w = w || getWindowSelf();\n\n  const performance = w.performance;\n\n  if (w.performance?.timing) {\n    if (w.performance.timing.navigationStart > 0) {\n      const val = performance.timing.domLoading - performance.timing.navigationStart;\n      if (val > 0) {\n        domLoadingDuration = val;\n      }\n    }\n  }\n\n  return domLoadingDuration;\n}\n\n/**\n * When the deviceAccess flag config option is false, no cookies should be read or set\n * @returns {boolean}\n */\nexport function hasDeviceAccess() {\n  return config.getConfig('deviceAccess') !== false;\n}\n\n/**\n * @returns {(boolean|undefined)}\n */\nexport function checkCookieSupport() {\n  // eslint-disable-next-line prebid/no-member\n  if (window.navigator.cookieEnabled || !!document.cookie.length) {\n    return true;\n  }\n}\n\n/**\n * Given a function, return a function which only executes the original after\n * it's been called numRequiredCalls times.\n *\n * Note that the arguments from the previous calls will *not* be forwarded to the original function.\n * Only the final call's arguments matter.\n *\n * @param {function} func The function which should be executed, once the returned function has been executed\n *   numRequiredCalls times.\n * @param {number} numRequiredCalls The number of times which the returned function needs to be called before\n *   func is.\n */\nexport function delayExecution(func, numRequiredCalls) {\n  if (numRequiredCalls < 1) {\n    throw new Error(`numRequiredCalls must be a positive number. Got ${numRequiredCalls}`);\n  }\n  let numCalls = 0;\n  return function () {\n    numCalls++;\n    if (numCalls === numRequiredCalls) {\n      func.apply(this, arguments);\n    }\n  }\n}\n\n/**\n * https://stackoverflow.com/a/34890276/428704\n * @param {Array} xs\n * @param {string} key\n * @returns {Object} {${key_value}: ${groupByArray}, key_value: {groupByArray}}\n */\nexport function groupBy(xs, key) {\n  return xs.reduce(function(rv, x) {\n    (rv[x[key]] = rv[x[key]] || []).push(x);\n    return rv;\n  }, {});\n}\n\n/**\n * Build an object consisting of only defined parameters to avoid creating an\n * object with defined keys and undefined values.\n * @param {Object} object The object to pick defined params out of\n * @param {string[]} params An array of strings representing properties to look for in the object\n * @returns {Object} An object containing all the specified values that are defined\n */\nexport function getDefinedParams(object, params) {\n  return params\n    .filter(param => object[param])\n    .reduce((bid, param) => Object.assign(bid, { [param]: object[param] }), {});\n}\n\n/**\n * @typedef {Object} MediaTypes\n * @property {Object} banner banner configuration\n * @property {Object} native native configuration\n * @property {Object} video video configuration\n */\n\n/**\n * Validates an adunit's `mediaTypes` parameter\n * @param {MediaTypes} mediaTypes mediaTypes parameter to validate\n * @return {boolean} If object is valid\n */\nexport function isValidMediaTypes(mediaTypes) {\n  const SUPPORTED_MEDIA_TYPES = ['banner', 'native', 'video'];\n  const SUPPORTED_STREAM_TYPES = ['instream', 'outstream', 'adpod'];\n\n  const types = Object.keys(mediaTypes);\n\n  if (!types.every(type => includes(SUPPORTED_MEDIA_TYPES, type))) {\n    return false;\n  }\n\n  if (FEATURES.VIDEO && mediaTypes.video && mediaTypes.video.context) {\n    return includes(SUPPORTED_STREAM_TYPES, mediaTypes.video.context);\n  }\n\n  return true;\n}\n\n/**\n * Returns user configured bidder params from adunit\n * @param {Object} adUnits\n * @param {string} adUnitCode code\n * @param {string} bidder code\n * @return {Array} user configured param for the given bidder adunit configuration\n */\nexport function getUserConfiguredParams(adUnits, adUnitCode, bidder) {\n  return adUnits\n    .filter(adUnit => adUnit.code === adUnitCode)\n    .flatMap((adUnit) => adUnit.bids)\n    .filter((bidderData) => bidderData.bidder === bidder)\n    .map((bidderData) => bidderData.params || {});\n}\n\n/**\n * Returns Do Not Track state\n */\nexport function getDNT() {\n  return navigator.doNotTrack === '1' || window.doNotTrack === '1' || navigator.msDoNotTrack === '1' || navigator.doNotTrack === 'yes';\n}\n\nexport const compareCodeAndSlot = (slot, adUnitCode) => slot.getAdUnitPath() === adUnitCode || slot.getSlotElementId() === adUnitCode;\n\n/**\n * Returns filter function to match adUnitCode in slot\n * @param {Object} slot GoogleTag slot\n * @return {function} filter function\n */\nexport function isAdUnitCodeMatchingSlot(slot) {\n  return (adUnitCode) => compareCodeAndSlot(slot, adUnitCode);\n}\n\n/**\n * Constructs warning message for when unsupported bidders are dropped from an adunit\n * @param {Object} adUnit ad unit from which the bidder is being dropped\n * @param {string} bidder bidder code that is not compatible with the adUnit\n * @return {string} warning message to display when condition is met\n */\nexport function unsupportedBidderMessage(adUnit, bidder) {\n  const mediaType = Object.keys(adUnit.mediaTypes || {'banner': 'banner'}).join(', ');\n\n  return `\n    ${adUnit.code} is a ${mediaType} ad unit\n    containing bidders that don't support ${mediaType}: ${bidder}.\n    This bidder won't fetch demand.\n  `;\n}\n\n/**\n * Checks input is integer or not\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\n * @param {*} value\n */\nexport const isInteger = Number.isInteger.bind(Number);\n\n/**\n * Returns a new object with undefined properties removed from given object\n * @param obj the object to clean\n */\nexport function cleanObj(obj) {\n  return Object.fromEntries(Object.entries(obj).filter(([_, v]) => typeof v !== 'undefined'))\n}\n\n/**\n * Create a new object with selected properties.  Also allows property renaming and transform functions.\n * @param obj the original object\n * @param properties An array of desired properties\n */\nexport function pick(obj, properties) {\n  if (typeof obj !== 'object') {\n    return {};\n  }\n  return properties.reduce((newObj, prop, i) => {\n    if (typeof prop === 'function') {\n      return newObj;\n    }\n\n    let newProp = prop;\n    let match = prop.match(/^(.+?)\\sas\\s(.+?)$/i);\n\n    if (match) {\n      prop = match[1];\n      newProp = match[2];\n    }\n\n    let value = obj[prop];\n    if (typeof properties[i + 1] === 'function') {\n      value = properties[i + 1](value, newObj);\n    }\n    if (typeof value !== 'undefined') {\n      newObj[newProp] = value;\n    }\n\n    return newObj;\n  }, {});\n}\n\nexport function isArrayOfNums(val, size) {\n  return (isArray(val)) && ((size) ? val.length === size : true) && (val.every(v => isInteger(v)));\n}\n\nexport function parseQS(query) {\n  return !query ? {} : query\n    .replace(/^\\?/, '')\n    .split('&')\n    .reduce((acc, criteria) => {\n      let [k, v] = criteria.split('=');\n      if (/\\[\\]$/.test(k)) {\n        k = k.replace('[]', '');\n        acc[k] = acc[k] || [];\n        acc[k].push(v);\n      } else {\n        acc[k] = v || '';\n      }\n      return acc;\n    }, {});\n}\n\nexport function formatQS(query) {\n  return Object\n    .keys(query)\n    .map(k => Array.isArray(query[k])\n      ? query[k].map(v => `${k}[]=${v}`).join('&')\n      : `${k}=${query[k]}`)\n    .join('&');\n}\n\nexport function parseUrl(url, options) {\n  let parsed = document.createElement('a');\n  if (options && 'noDecodeWholeURL' in options && options.noDecodeWholeURL) {\n    parsed.href = url;\n  } else {\n    parsed.href = decodeURIComponent(url);\n  }\n  // in window.location 'search' is string, not object\n  let qsAsString = (options && 'decodeSearchAsString' in options && options.decodeSearchAsString);\n  return {\n    href: parsed.href,\n    protocol: (parsed.protocol || '').replace(/:$/, ''),\n    hostname: parsed.hostname,\n    port: +parsed.port,\n    pathname: parsed.pathname.replace(/^(?!\\/)/, '/'),\n    search: (qsAsString) ? parsed.search : internal.parseQS(parsed.search || ''),\n    hash: (parsed.hash || '').replace(/^#/, ''),\n    host: parsed.host || window.location.host\n  };\n}\n\nexport function buildUrl(obj) {\n  return (obj.protocol || 'http') + '://' +\n    (obj.host ||\n      obj.hostname + (obj.port ? `:${obj.port}` : '')) +\n    (obj.pathname || '') +\n    (obj.search ? `?${internal.formatQS(obj.search || '')}` : '') +\n    (obj.hash ? `#${obj.hash}` : '');\n}\n\n/**\n * This function deeply compares two objects checking for their equivalence.\n * @param {Object} obj1\n * @param {Object} obj2\n * @param {Object} [options] - Options for comparison.\n * @param {boolean} [options.checkTypes=false] - If set, two objects with identical properties but different constructors will *not* be considered equivalent.\n * @returns {boolean} - Returns `true` if the objects are equivalent, `false` otherwise.\n */\nexport function deepEqual(obj1, obj2, {checkTypes = false} = {}) {\n  if (obj1 === obj2) return true;\n  else if (\n    (typeof obj1 === 'object' && obj1 !== null) &&\n    (typeof obj2 === 'object' && obj2 !== null) &&\n    (!checkTypes || (obj1.constructor === obj2.constructor))\n  ) {\n    const props1 = Object.keys(obj1);\n    if (props1.length !== Object.keys(obj2).length) return false;\n    for (let prop of props1) {\n      if (obj2.hasOwnProperty(prop)) {\n        if (!deepEqual(obj1[prop], obj2[prop], {checkTypes})) {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function mergeDeep(target, ...sources) {\n  if (!sources.length) return target;\n  const source = sources.shift();\n\n  if (isPlainObject(target) && isPlainObject(source)) {\n    for (const key in source) {\n      if (isPlainObject(source[key])) {\n        if (!target[key]) Object.assign(target, { [key]: {} });\n        mergeDeep(target[key], source[key]);\n      } else if (isArray(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: [...source[key]] });\n        } else if (isArray(target[key])) {\n          source[key].forEach(obj => {\n            let addItFlag = 1;\n            for (let i = 0; i < target[key].length; i++) {\n              if (deepEqual(target[key][i], obj)) {\n                addItFlag = 0;\n                break;\n              }\n            }\n            if (addItFlag) {\n              target[key].push(obj);\n            }\n          });\n        }\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return mergeDeep(target, ...sources);\n}\n\n/**\n * returns a hash of a string using a fast algorithm\n * source: https://stackoverflow.com/a/52171480/845390\n * @param str\n * @param seed (optional)\n * @returns {string}\n */\nexport function cyrb53Hash(str, seed = 0) {\n  // IE doesn't support imul\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/imul#Polyfill\n  let imul = function(opA, opB) {\n    if (isFn(Math.imul)) {\n      return Math.imul(opA, opB);\n    } else {\n      opB |= 0; // ensure that opB is an integer. opA will automatically be coerced.\n      // floating points give us 53 bits of precision to work with plus 1 sign bit\n      // automatically handled for our convienence:\n      // 1. 0x003fffff /*opA & 0x000fffff*/ * 0x7fffffff /*opB*/ = 0x1fffff7fc00001\n      //    0x1fffff7fc00001 < Number.MAX_SAFE_INTEGER /*0x1fffffffffffff*/\n      var result = (opA & 0x003fffff) * opB;\n      // 2. We can remove an integer coersion from the statement above because:\n      //    0x1fffff7fc00001 + 0xffc00000 = 0x1fffffff800001\n      //    0x1fffffff800001 < Number.MAX_SAFE_INTEGER /*0x1fffffffffffff*/\n      if (opA & 0xffc00000) result += (opA & 0xffc00000) * opB | 0;\n      return result | 0;\n    }\n  };\n\n  let h1 = 0xdeadbeef ^ seed;\n  let h2 = 0x41c6ce57 ^ seed;\n  for (let i = 0, ch; i < str.length; i++) {\n    ch = str.charCodeAt(i);\n    h1 = imul(h1 ^ ch, 2654435761);\n    h2 = imul(h2 ^ ch, 1597334677);\n  }\n  h1 = imul(h1 ^ (h1 >>> 16), 2246822507) ^ imul(h2 ^ (h2 >>> 13), 3266489909);\n  h2 = imul(h2 ^ (h2 >>> 16), 2246822507) ^ imul(h1 ^ (h1 >>> 13), 3266489909);\n  return (4294967296 * (2097151 & h2) + (h1 >>> 0)).toString();\n}\n\n/**\n * returns the result of `JSON.parse(data)`, or undefined if that throws an error.\n * @param data\n * @returns {any}\n */\nexport function safeJSONParse(data) {\n  try {\n    return JSON.parse(data);\n  } catch (e) {}\n}\n\nexport function safeJSONEncode(data) {\n  try {\n    return JSON.stringify(data);\n  } catch (e) {\n    return '';\n  }\n}\n\n/**\n * Returns a memoized version of `fn`.\n *\n * @param fn\n * @param key cache key generator, invoked with the same arguments passed to `fn`.\n *        By default, the first argument is used as key.\n * @return {function(): any}\n */\nexport function memoize(fn, key = function (arg) { return arg; }) {\n  const cache = new Map();\n  const memoized = function () {\n    const cacheKey = key.apply(this, arguments);\n    if (!cache.has(cacheKey)) {\n      cache.set(cacheKey, fn.apply(this, arguments));\n    }\n    return cache.get(cacheKey);\n  }\n  memoized.clear = cache.clear.bind(cache);\n  return memoized;\n}\n\n/**\n * Returns a Unix timestamp for given time value and unit.\n * @param {number} timeValue numeric value, defaults to 0 (which means now)\n * @param {string} timeUnit defaults to days (or 'd'), use 'm' for minutes. Any parameter that isn't 'd' or 'm' will return Date.now().\n * @returns {number}\n */\nexport function getUnixTimestampFromNow(timeValue = 0, timeUnit = 'd') {\n  const acceptableUnits = ['m', 'd'];\n  if (acceptableUnits.indexOf(timeUnit) < 0) {\n    return Date.now();\n  }\n  const multiplication = timeValue / (timeUnit === 'm' ? 1440 : 1);\n  return Date.now() + (timeValue && timeValue > 0 ? (1000 * 60 * 60 * 24 * multiplication) : 0);\n}\n\n/**\n * Converts given object into an array, so {key: 1, anotherKey: 'fred', third: ['fred']} is turned\n * into [{key: 1}, {anotherKey: 'fred'}, {third: ['fred']}]\n * @param {Object} obj the object\n * @returns {Array}\n */\nexport function convertObjectToArray(obj) {\n  return Object.keys(obj).map(key => {\n    return {[key]: obj[key]};\n  });\n}\n\n/**\n * Sets dataset attributes on a script\n * @param {HTMLScriptElement} script\n * @param {object} attributes\n */\nexport function setScriptAttributes(script, attributes) {\n  Object.entries(attributes).forEach(([k, v]) => script.setAttribute(k, v))\n}\n\n/**\n * Perform a binary search for `el` on an ordered array `arr`.\n *\n * @returns the lowest nonnegative integer I that satisfies:\n *   key(arr[i]) >= key(el) for each i between I and arr.length\n *\n *   (if one or more matches are found for `el`, returns the index of the first;\n *   if the element is not found, return the index of the first element that's greater;\n *   if no greater element exists, return `arr.length`)\n */\nexport function binarySearch(arr, el, key = (el) => el) {\n  let left = 0;\n  let right = arr.length && arr.length - 1;\n  const target = key(el);\n  while (right - left > 1) {\n    const middle = left + Math.round((right - left) / 2);\n    if (target > key(arr[middle])) {\n      left = middle;\n    } else {\n      right = middle;\n    }\n  }\n  while (arr.length > left && target > key(arr[left])) {\n    left++;\n  }\n  return left;\n}\n\n/**\n * Checks if an object has non-serializable properties.\n * Non-serializable properties are functions and RegExp objects.\n *\n * @param {Object} obj - The object to check.\n * @param {Set} checkedObjects - A set of properties that have already been checked.\n * @returns {boolean} - Returns true if the object has non-serializable properties, false otherwise.\n */\nexport function hasNonSerializableProperty(obj, checkedObjects = new Set()) {\n  for (const key in obj) {\n    const value = obj[key];\n    const type = typeof value;\n\n    if (\n      value === undefined ||\n      type === 'function' ||\n      type === 'symbol' ||\n      value instanceof RegExp ||\n      value instanceof Map ||\n      value instanceof Set ||\n      value instanceof Date ||\n      (value !== null && type === 'object' && value.hasOwnProperty('toJSON'))\n    ) {\n      return true;\n    }\n    if (value !== null && type === 'object' && value.constructor === Object) {\n      if (checkedObjects.has(value)) {\n        // circular reference, means we have a non-serializable property\n        return true;\n      }\n      checkedObjects.add(value);\n      if (hasNonSerializableProperty(value, checkedObjects)) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n/**\n * Returns the value of a nested property in an array of objects.\n *\n * @param {Array} collection - Array of objects.\n * @param {String} key - Key of nested property.\n * @returns {any, undefined} - Value of nested property.\n */\nexport function setOnAny(collection, key) {\n  for (let i = 0, result; i < collection.length; i++) {\n    result = deepAccess(collection[i], key);\n    if (result) {\n      return result;\n    }\n  }\n  return undefined;\n}\n\nexport function extractDomainFromHost(pageHost) {\n  let domain = null;\n  try {\n    let domains = /[-\\w]+\\.([-\\w]+|[-\\w]{3,}|[-\\w]{1,3}\\.[-\\w]{2})$/i.exec(pageHost);\n    if (domains != null && domains.length > 0) {\n      domain = domains[0];\n      for (let i = 1; i < domains.length; i++) {\n        if (domains[i].length > domain.length) {\n          domain = domains[i];\n        }\n      }\n    }\n  } catch (e) {\n    domain = null;\n  }\n  return domain;\n}\n\nexport function triggerNurlWithCpm(bid, cpm) {\n  if (isStr(bid.nurl) && bid.nurl !== '') {\n    bid.nurl = bid.nurl.replace(\n      /\\${AUCTION_PRICE}/,\n      cpm\n    );\n    triggerPixel(bid.nurl);\n  }\n}\n","import {auctionManager} from '../auctionManager.js';\nimport {bidderSettings} from '../bidderSettings.js';\nimport {logError} from '../utils.js';\n\nexport function adjustCpm(cpm, bidResponse, bidRequest, {index = auctionManager.index, bs = bidderSettings} = {}) {\n  bidRequest = bidRequest || index.getBidRequest(bidResponse);\n  const adapterCode = bidResponse?.adapterCode;\n  const bidderCode = bidResponse?.bidderCode || bidRequest?.bidder;\n  const adjustAlternateBids = bs.get(bidResponse?.adapterCode, 'adjustAlternateBids');\n  const bidCpmAdjustment = bs.getOwn(bidderCode, 'bidCpmAdjustment') || bs.get(adjustAlternateBids ? adapterCode : bidderCode, 'bidCpmAdjustment');\n\n  if (bidCpmAdjustment && typeof bidCpmAdjustment === 'function') {\n    try {\n      return bidCpmAdjustment(cpm, Object.assign({}, bidResponse), bidRequest);\n    } catch (e) {\n      logError('Error during bid adjustment', e);\n    }\n  }\n  return cpm;\n}\n","let outOfFocusStart = null; // enforce null otherwise it could be undefined and the callback wouldn't execute\nlet timeOutOfFocus = 0;\nlet suspendedTimeouts = [];\n\nfunction trackTimeOutOfFocus() {\n  if (document.hidden) {\n    outOfFocusStart = Date.now()\n  } else {\n    timeOutOfFocus += Date.now() - (outOfFocusStart ?? 0); // when the page is loaded in hidden state outOfFocusStart is undefined, which results in timeoutOffset being NaN\n    outOfFocusStart = null;\n    suspendedTimeouts.forEach(({ callback, startTime, setTimerId }) => setTimerId(setFocusTimeout(callback, timeOutOfFocus - startTime)()));\n    suspendedTimeouts = [];\n  }\n}\n\ndocument.addEventListener('visibilitychange', trackTimeOutOfFocus);\n\nexport function reset() {\n  outOfFocusStart = null;\n  timeOutOfFocus = 0;\n  suspendedTimeouts = [];\n  document.removeEventListener('visibilitychange', trackTimeOutOfFocus);\n  document.addEventListener('visibilitychange', trackTimeOutOfFocus);\n}\n\n/**\n * Wraps native setTimeout function in order to count time only when page is focused\n *\n * @param {function(*): ()} [callback] - A function that will be invoked after passed time\n * @param {number} [milliseconds] - Minimum duration (in milliseconds) that the callback will be executed after\n * @returns {function(*): (number)} - Getter function for current timer id\n */\nexport function setFocusTimeout(callback, milliseconds) {\n  const startTime = timeOutOfFocus;\n  let timerId = setTimeout(() => {\n    if (timeOutOfFocus === startTime && outOfFocusStart == null) {\n      callback();\n    } else if (outOfFocusStart != null) {\n      // case when timeout ended during page is out of focus\n      suspendedTimeouts.push({\n        callback,\n        startTime,\n        setTimerId(newId) {\n          timerId = newId;\n        }\n      })\n    } else {\n      timerId = setFocusTimeout(callback, timeOutOfFocus - startTime)();\n    }\n  }, milliseconds);\n  return () => timerId;\n}\n","export function scrubIPv4(ip) {\n  if (!ip) {\n    return null;\n  }\n\n  const ones = 24;\n\n  let ipParts = ip.split('.').map(Number)\n\n  if (ipParts.length != 4) {\n    return null;\n  }\n\n  let mask = [];\n  for (let i = 0; i < 4; i++) {\n    let n = Math.max(0, Math.min(8, ones - (i * 8)));\n    mask.push((0xff << (8 - n)) & 0xff);\n  }\n\n  let maskedIP = ipParts.map((part, i) => part & mask[i]);\n\n  return maskedIP.join('.');\n}\n\nexport function scrubIPv6(ip) {\n  if (!ip) {\n    return null;\n  }\n\n  const ones = 64;\n\n  let ipParts = ip.split(':').map(part => parseInt(part, 16));\n\n  ipParts = ipParts.map(part => isNaN(part) ? 0 : part);\n  while (ipParts.length < 8) {\n    ipParts.push(0);\n  }\n\n  if (ipParts.length != 8) {\n    return null;\n  }\n\n  let mask = [];\n  for (let i = 0; i < 8; i++) {\n    let n = Math.max(0, Math.min(16, ones - (i * 16)));\n    mask.push((0xffff << (16 - n)) & 0xffff);\n  }\n\n  let maskedIP = ipParts.map((part, i) => part & mask[i]);\n\n  return maskedIP.map(part => part.toString(16)).join(':');\n}\n","import {config} from '../config.js';\nexport const CONFIG_TOGGLE = 'performanceMetrics';\nconst getTime = window.performance && window.performance.now ? () => window.performance.now() : () => Date.now();\nconst NODES = new WeakMap();\n\nexport function metricsFactory({now = getTime, mkNode = makeNode, mkTimer = makeTimer, mkRenamer = (rename) => rename, nodes = NODES} = {}) {\n  return function newMetrics() {\n    function makeMetrics(self, rename = (n) => ({forEach(fn) { fn(n); }})) {\n      rename = mkRenamer(rename);\n\n      function accessor(slot) {\n        return function (name) {\n          return self.dfWalk({\n            visit(edge, node) {\n              const obj = node[slot];\n              if (obj.hasOwnProperty(name)) {\n                return obj[name];\n              }\n            }\n          });\n        };\n      }\n\n      const getTimestamp = accessor('timestamps');\n\n      /**\n       * Register a metric.\n       *\n       * @param name metric name\n       * @param value metric valiue\n       */\n      function setMetric(name, value) {\n        const names = rename(name);\n        self.dfWalk({\n          follow(inEdge, outEdge) {\n            return outEdge.propagate && (!inEdge || !inEdge.stopPropagation)\n          },\n          visit(edge, node) {\n            names.forEach(name => {\n              if (edge == null) {\n                node.metrics[name] = value;\n              } else {\n                if (!node.groups.hasOwnProperty(name)) {\n                  node.groups[name] = [];\n                }\n                node.groups[name].push(value);\n              }\n            })\n          }\n        });\n      }\n\n      /**\n       * Mark the current time as a checkpoint with the given name, to be referenced later\n       * by `timeSince` or `timeBetween`.\n       *\n       * @param name checkpoint name\n       */\n      function checkpoint(name) {\n        self.timestamps[name] = now();\n      }\n\n      /**\n       * Get the tame passed since `checkpoint`, and optionally save it as a metric.\n       *\n       * @param {string} checkpoint checkpoint name\n       * @param {string} [metric] - The name of the metric to save. Optional.\n       * @returns {number|null} - The time in milliseconds between now and the checkpoint, or `null` if the checkpoint is not found.\n       */\n      function timeSince(checkpoint, metric) {\n        const ts = getTimestamp(checkpoint);\n        const elapsed = ts != null ? now() - ts : null;\n        if (metric != null) {\n          setMetric(metric, elapsed);\n        }\n        return elapsed;\n      }\n\n      /**\n       * Get the time passed between `startCheckpoint` and `endCheckpoint`, optionally saving it as a metric.\n       *\n       * @param {string} startCheckpoint - The name of the starting checkpoint.\n       * @param {string} endCheckpoint - The name of the ending checkpoint.\n       * @param {string} [metric] - The name of the metric to save. Optional.\n       * @returns {number|null} - The time in milliseconds between `startCheckpoint` and `endCheckpoint`, or `null` if either checkpoint is not found.\n       */\n      function timeBetween(startCheckpoint, endCheckpoint, metric) {\n        const start = getTimestamp(startCheckpoint);\n        const end = getTimestamp(endCheckpoint);\n        const elapsed = start != null && end != null ? end - start : null;\n        if (metric != null) {\n          setMetric(metric, elapsed);\n        }\n        return elapsed;\n      }\n\n      /**\n       * A function that, when called, stops a time measure and saves it as a metric.\n       *\n       * @typedef {function(): void} MetricsTimer\n       * @template {function} F\n       * @property {function(F): F} stopBefore returns a wrapper around the given function that begins by\n       *   stopping this time measure.\n       * @property {function(F): F} stopAfter returns a wrapper around the given function that ends by\n       *   stopping this time measure.\n       */\n\n      /**\n       * Start measuring a time metric with the given name.\n       *\n       * @param name metric name\n       * @return {MetricsTimer}\n       */\n      function startTiming(name) {\n        return mkTimer(now, (val) => setMetric(name, val))\n      }\n\n      /**\n       * Run fn and measure the time spent in it.\n       *\n       * @template T\n       * @param name the name to use for the measured time metric\n       * @param {function(): T} fn\n       * @return {T} the return value of `fn`\n       */\n      function measureTime(name, fn) {\n        return startTiming(name).stopAfter(fn)();\n      }\n\n      /**\n       * @typedef {Function} HookFn\n       * @property {Function(T): void} bail\n       *\n       * @template T\n       * @typedef {HookFn} TimedHookFn\n       * @property {Function(): void} stopTiming\n       * @property {T} untimed\n       */\n\n      /**\n       * Convenience method for measuring time spent in a `.before` or `.after` hook.\n       *\n       * @template T\n       * @param {string} name - The metric name.\n       * @param {HookFn} next - The hook's `next` (first) argument.\n       * @param {function(TimedHookFn): T} fn - A function that will be run immediately; it takes `next`,\n       *    where both `next` and `next.bail` automatically\n       *    call `stopTiming` before continuing with the original hook.\n       * @return {T} - The return value of `fn`.\n       */\n      function measureHookTime(name, next, fn) {\n        const stopTiming = startTiming(name);\n        return fn((function (orig) {\n          const next = stopTiming.stopBefore(orig);\n          next.bail = orig.bail && stopTiming.stopBefore(orig.bail);\n          next.stopTiming = stopTiming;\n          next.untimed = orig;\n          return next;\n        })(next));\n      }\n\n      /**\n       * Get all registered metrics.\n       * @return {{}}\n       */\n      function getMetrics() {\n        let result = {}\n        self.dfWalk({\n          visit(edge, node) {\n            result = Object.assign({}, !edge || edge.includeGroups ? node.groups : null, node.metrics, result);\n          }\n        });\n        return result;\n      }\n\n      /**\n       * Create and return a new metrics object that starts as a view on all metrics registered here,\n       * and - by default - also propagates all new metrics here.\n       *\n       * Propagated metrics are grouped together, and intended for repeated operations. For example, with the following:\n       *\n       * ```\n       * const metrics = newMetrics();\n       * const requests = metrics.measureTime('buildRequests', buildRequests)\n       * requests.forEach((req) => {\n       *   const requestMetrics = metrics.fork();\n       *   requestMetrics.measureTime('processRequest', () => processRequest(req);\n       * })\n       * ```\n       *\n       * if `buildRequests` takes 10ms and returns 3 objects, which respectively take 100, 200, and 300ms in `processRequest`, then\n       * the final `metrics.getMetrics()` would be:\n       *\n       * ```\n       * {\n       *    buildRequests: 10,\n       *    processRequest: [100, 200, 300]\n       * }\n       * ```\n       *\n       * while the inner `requestMetrics.getMetrics()` would be:\n       *\n       * ```\n       * {\n       *   buildRequests: 10,\n       *   processRequest: 100 // or 200 for the 2nd loop, etc\n       * }\n       * ```\n       *\n       *\n       * @param {Object} [options={}] - Options for forking the metrics.\n       * @param {boolean} [options.propagate=true] - If false, the forked metrics will not be propagated here.\n       * @param {boolean} [options.stopPropagation=false] - If true, propagation from the new metrics is stopped here, instead of\n       *   continuing up the chain (if for example these metrics were themselves created through `.fork()`).\n       * @param {boolean} [options.includeGroups=false] - If true, the forked metrics will also replicate metrics that were propagated\n       *   here from elsewhere. For example:\n       *   ```\n       *   const metrics = newMetrics();\n       *   const op1 = metrics.fork();\n       *   const withoutGroups = metrics.fork();\n       *   const withGroups = metrics.fork({includeGroups: true});\n       *   op1.setMetric('foo', 'bar');\n       *   withoutGroups.getMetrics() // {}\n       *   withGroups.getMetrics() // {foo: ['bar']}\n       *   ```\n       * @returns {Object} - The new metrics object.\n       */\n      function fork({propagate = true, stopPropagation = false, includeGroups = false} = {}) {\n        return makeMetrics(mkNode([[self, {propagate, stopPropagation, includeGroups}]]), rename);\n      }\n\n      /**\n       * Join `otherMetrics` with these; all metrics from `otherMetrics` will (by default) be propagated here,\n       * and all metrics from here will be included in `otherMetrics`.\n       *\n       * `propagate`, `stopPropagation` and `includeGroups` have the same semantics as in `.fork()`.\n       */\n      function join(otherMetrics, {propagate = true, stopPropagation = false, includeGroups = false} = {}) {\n        const other = nodes.get(otherMetrics);\n        if (other != null) {\n          other.addParent(self, {propagate, stopPropagation, includeGroups});\n        }\n      }\n\n      /**\n       * return a version of these metrics where all new metrics are renamed according to `renameFn`.\n       *\n       * @param {function(String): Array[String]} renameFn\n       */\n      function renameWith(renameFn) {\n        return makeMetrics(self, renameFn);\n      }\n\n      /**\n       * Create a new metrics object that uses the same propagation and renaming rules as this one.\n       */\n      function newMetrics() {\n        return makeMetrics(self.newSibling(), rename);\n      }\n\n      const metrics = {\n        startTiming,\n        measureTime,\n        measureHookTime,\n        checkpoint,\n        timeSince,\n        timeBetween,\n        setMetric,\n        getMetrics,\n        fork,\n        join,\n        newMetrics,\n        renameWith,\n        toJSON() {\n          return getMetrics();\n        }\n      };\n      nodes.set(metrics, self);\n      return metrics;\n    }\n\n    return makeMetrics(mkNode([]));\n  }\n}\n\nfunction wrapFn(fn, before, after) {\n  return function () {\n    before && before();\n    try {\n      return fn.apply(this, arguments);\n    } finally {\n      after && after();\n    }\n  };\n}\n\nfunction makeTimer(now, cb) {\n  const start = now();\n  let done = false;\n  function stopTiming() {\n    if (!done) {\n      // eslint-disable-next-line standard/no-callback-literal\n      cb(now() - start);\n      done = true;\n    }\n  }\n  stopTiming.stopBefore = (fn) => wrapFn(fn, stopTiming);\n  stopTiming.stopAfter = (fn) => wrapFn(fn, null, stopTiming);\n  return stopTiming;\n}\n\nfunction makeNode(parents) {\n  return {\n    metrics: {},\n    timestamps: {},\n    groups: {},\n    addParent(node, edge) {\n      parents.push([node, edge]);\n    },\n    newSibling() {\n      return makeNode(parents.slice());\n    },\n    dfWalk({visit, follow = () => true, visited = new Set(), inEdge} = {}) {\n      let res;\n      if (!visited.has(this)) {\n        visited.add(this);\n        res = visit(inEdge, this);\n        if (res != null) return res;\n        for (const [parent, outEdge] of parents) {\n          if (follow(inEdge, outEdge)) {\n            res = parent.dfWalk({visit, follow, visited, inEdge: outEdge});\n            if (res != null) return res;\n          }\n        }\n      }\n    }\n  };\n}\n\nconst nullMetrics = (() => {\n  const nop = function () {};\n  const empty = () => ({});\n  const none = {forEach: nop};\n  const nullTimer = () => null;\n  nullTimer.stopBefore = (fn) => fn;\n  nullTimer.stopAfter = (fn) => fn;\n  const nullNode = Object.defineProperties(\n    {dfWalk: nop, newSibling: () => nullNode, addParent: nop},\n    Object.fromEntries(['metrics', 'timestamps', 'groups'].map(prop => [prop, {get: empty}])));\n  return metricsFactory({\n    now: () => 0,\n    mkNode: () => nullNode,\n    mkRenamer: () => () => none,\n    mkTimer: () => nullTimer,\n    nodes: {get: nop, set: nop}\n  })();\n})();\n\nlet enabled = true;\nconfig.getConfig(CONFIG_TOGGLE, (cfg) => { enabled = !!cfg[CONFIG_TOGGLE] });\n\n/**\n * convenience fallback function for metrics that may be undefined, especially during tests.\n */\nexport function useMetrics(metrics) {\n  return (enabled && metrics) || nullMetrics;\n}\n\nexport const newMetrics = (() => {\n  const makeMetrics = metricsFactory();\n  return function () {\n    return enabled ? makeMetrics() : nullMetrics;\n  }\n})();\n\nexport function hookTimer(prefix, getMetrics) {\n  return function(name, hookFn) {\n    return function (next, ...args) {\n      const that = this;\n      return useMetrics(getMetrics.apply(that, args)).measureHookTime(prefix + name, next, function (next) {\n        return hookFn.call(that, next, ...args);\n      });\n    }\n  }\n}\n\nexport const timedAuctionHook = hookTimer('requestBids.', (req) => req.metrics);\nexport const timedBidResponseHook = hookTimer('addBidResponse.', (_, bid) => bid.metrics)\n","const SUCCESS = 0;\nconst FAIL = 1;\n\n/**\n * A version of Promise that runs callbacks synchronously when it can (i.e. after it's been fulfilled or rejected).\n */\nexport class GreedyPromise {\n  #result;\n  #callbacks;\n\n  /**\n   * Convenience wrapper for setTimeout; takes care of returning an already fulfilled GreedyPromise when the delay is zero.\n   *\n   * @param {Number} delayMs delay in milliseconds\n   * @returns {GreedyPromise} a promise that resolves (to undefined) in `delayMs` milliseconds\n   */\n  static timeout(delayMs = 0) {\n    return new GreedyPromise((resolve) => {\n      delayMs === 0 ? resolve() : setTimeout(resolve, delayMs);\n    });\n  }\n\n  constructor(resolver) {\n    if (typeof resolver !== 'function') {\n      throw new Error('resolver not a function');\n    }\n    const result = [];\n    const callbacks = [];\n    let [resolve, reject] = [SUCCESS, FAIL].map((type) => {\n      return function (value) {\n        if (type === SUCCESS && typeof value?.then === 'function') {\n          value.then(resolve, reject);\n        } else if (!result.length) {\n          result.push(type, value);\n          while (callbacks.length) callbacks.shift()();\n        }\n      }\n    });\n    try {\n      resolver(resolve, reject);\n    } catch (e) {\n      reject(e);\n    }\n    this.#result = result;\n    this.#callbacks = callbacks;\n  }\n\n  then(onSuccess, onError) {\n    const result = this.#result;\n    return new this.constructor((resolve, reject) => {\n      const continuation = () => {\n        let value = result[1];\n        let [handler, resolveFn] = result[0] === SUCCESS ? [onSuccess, resolve] : [onError, reject];\n        if (typeof handler === 'function') {\n          try {\n            value = handler(value);\n          } catch (e) {\n            reject(e);\n            return;\n          }\n          resolveFn = resolve;\n        }\n        resolveFn(value);\n      }\n      result.length ? continuation() : this.#callbacks.push(continuation);\n    });\n  }\n\n  catch(onError) {\n    return this.then(null, onError);\n  }\n\n  finally(onFinally) {\n    let val;\n    return this.then(\n      (v) => { val = v; return onFinally(); },\n      (e) => { val = this.constructor.reject(e); return onFinally() }\n    ).then(() => val);\n  }\n\n  static #collect(promises, collector, done) {\n    let cnt = promises.length;\n    function clt() {\n      collector.apply(this, arguments);\n      if (--cnt <= 0 && done) done();\n    }\n    promises.length === 0 && done ? done() : promises.forEach((p, i) => this.resolve(p).then(\n      (val) => clt(true, val, i),\n      (err) => clt(false, err, i)\n    ));\n  }\n\n  static race(promises) {\n    return new this((resolve, reject) => {\n      this.#collect(promises, (success, result) => success ? resolve(result) : reject(result));\n    })\n  }\n\n  static all(promises) {\n    return new this((resolve, reject) => {\n      let res = [];\n      this.#collect(promises, (success, val, i) => success ? res[i] = val : reject(val), () => resolve(res));\n    })\n  }\n\n  static allSettled(promises) {\n    return new this((resolve) => {\n      let res = [];\n      this.#collect(promises, (success, val, i) => res[i] = success ? {status: 'fulfilled', value: val} : {status: 'rejected', reason: val}, () => resolve(res))\n    })\n  }\n\n  static resolve(value) {\n    return new this(resolve => resolve(value))\n  }\n\n  static reject(error) {\n    return new this((resolve, reject) => reject(error))\n  }\n}\n\n/**\n * @returns a {promise, resolve, reject} trio where `promise` is resolved by calling `resolve` or `reject`.\n */\nexport function defer({promiseFactory = (resolver) => new GreedyPromise(resolver)} = {}) {\n  function invoker(delegate) {\n    return (val) => delegate(val);\n  }\n\n  let resolveFn, rejectFn;\n\n  return {\n    promise: promiseFactory((resolve, reject) => {\n      resolveFn = resolve;\n      rejectFn = reject;\n    }),\n    resolve: invoker(resolveFn),\n    reject: invoker(rejectFn)\n  }\n}\n","export function simpleCompare(a, b) {\n  if (a === b) return 0;\n  return a < b ? -1 : 1;\n}\n\nexport function keyCompare(key = (item) => item) {\n  return (a, b) => simpleCompare(key(a), key(b))\n}\n\nexport function reverseCompare(compare = simpleCompare) {\n  return (a, b) => -compare(a, b) || 0;\n}\n\nexport function tiebreakCompare(...compares) {\n  return function (a, b) {\n    for (const cmp of compares) {\n      const val = cmp(a, b);\n      if (val !== 0) return val;\n    }\n    return 0;\n  }\n}\n\nexport function minimum(compare = simpleCompare) {\n  return (min, item) => compare(item, min) < 0 ? item : min;\n}\n\nexport function maximum(compare = simpleCompare) {\n  return minimum(reverseCompare(compare));\n}\n\nconst cpmCompare = keyCompare((bid) => bid.cpm);\nconst timestampCompare = keyCompare((bid) => bid.responseTimestamp);\n\n// This function will get highest cpm value bid, in case of tie it will return the bid with lowest timeToRespond\nexport const getHighestCpm = maximum(tiebreakCompare(cpmCompare, reverseCompare(keyCompare((bid) => bid.timeToRespond))))\n\n// This function will get the oldest hightest cpm value bid, in case of tie it will return the bid which came in first\n// Use case for tie: https://github.com/prebid/Prebid.js/issues/2448\nexport const getOldestHighestCpmBid = maximum(tiebreakCompare(cpmCompare, reverseCompare(timestampCompare)))\n\n// This function will get the latest hightest cpm value bid, in case of tie it will return the bid which came in last\n// Use case for tie: https://github.com/prebid/Prebid.js/issues/2539\nexport const getLatestHighestCpmBid = maximum(tiebreakCompare(cpmCompare, timestampCompare))\n","import {GreedyPromise} from './promise.js';\nimport {binarySearch, logError, timestamp} from '../utils.js';\nimport {setFocusTimeout} from './focusTimeout.js';\n\n/**\n * Create a set-like collection that automatically forgets items after a certain time.\n *\n * @param {function(*): (number|Promise<number>)} [startTime=timestamp] - A function taking an item added to this collection,\n *   and returning (a promise to) a timestamp to be used as the starting time for the item\n *   (the item will be dropped after `ttl(item)` milliseconds have elapsed since this timestamp).\n *   Defaults to the time the item was added to the collection.\n * @param {function(*): (number|void|Promise<number|void>)} [ttl=() => null] - A function taking an item added to this collection,\n *   and returning (a promise to) the duration (in milliseconds) the item should be kept in it.\n *   May return null to indicate that the item should be persisted indefinitely.\n * @param {boolean} [monotonic=false] - Set to true for better performance, but only if, given any two items A and B in this collection:\n *   if A was added before B, then:\n *     - startTime(A) + ttl(A) <= startTime(B) + ttl(B)\n *     - Promise.all([startTime(A), ttl(A)]) never resolves later than Promise.all([startTime(B), ttl(B)])\n * @param {number} [slack=5000] - Maximum duration (in milliseconds) that an item is allowed to persist\n *   once past its TTL. This is also roughly the interval between \"garbage collection\" sweeps.\n * @returns {Object} A set-like collection with automatic TTL expiration.\n * @returns {function(*): void} return.add - Add an item to the collection.\n * @returns {function(): void} return.clear - Clear the collection.\n * @returns {function(): Array<*>} return.toArray - Get all the items in the collection, in insertion order.\n * @returns {function(): void} return.refresh - Refresh the TTL for each item in the collection.\n * @returns {function(function(*)): function(): void} return.onExpiry - Register a callback to be run when an item has expired and is about to be\n *   removed from the collection. Returns an un-registration function\n */\nexport function ttlCollection(\n  {\n    startTime = timestamp,\n    ttl = () => null,\n    monotonic = false,\n    slack = 5000\n  } = {}\n) {\n  const items = new Map();\n  const callbacks = [];\n  const pendingPurge = [];\n  const markForPurge = monotonic\n    ? (entry) => pendingPurge.push(entry)\n    : (entry) => pendingPurge.splice(binarySearch(pendingPurge, entry, (el) => el.expiry), 0, entry)\n  let nextPurge, task;\n\n  function reschedulePurge() {\n    task && clearTimeout(task);\n    if (pendingPurge.length > 0) {\n      const now = timestamp();\n      nextPurge = Math.max(now, pendingPurge[0].expiry + slack);\n      task = setFocusTimeout(() => {\n        const now = timestamp();\n        let cnt = 0;\n        for (const entry of pendingPurge) {\n          if (entry.expiry > now) break;\n          callbacks.forEach(cb => {\n            try {\n              cb(entry.item)\n            } catch (e) {\n              logError(e);\n            }\n          });\n          items.delete(entry.item)\n          cnt++;\n        }\n        pendingPurge.splice(0, cnt);\n        task = null;\n        reschedulePurge();\n      }, nextPurge - now);\n    } else {\n      task = null;\n    }\n  }\n\n  function mkEntry(item) {\n    const values = {};\n    const thisCohort = currentCohort;\n    let expiry;\n\n    function update() {\n      if (thisCohort === currentCohort && values.start != null && values.delta != null) {\n        expiry = values.start + values.delta;\n        markForPurge(entry);\n        if (task == null || nextPurge > expiry + slack) {\n          reschedulePurge();\n        }\n      }\n    }\n\n    const [init, refresh] = Object.entries({\n      start: startTime,\n      delta: ttl\n    }).map(([field, getter]) => {\n      let currentCall;\n      return function() {\n        const thisCall = currentCall = {};\n        GreedyPromise.resolve(getter(item)).then((val) => {\n          if (thisCall === currentCall) {\n            values[field] = val;\n            update();\n          }\n        });\n      }\n    })\n\n    const entry = {\n      item,\n      refresh,\n      get expiry() {\n        return expiry;\n      },\n    };\n\n    init();\n    refresh();\n    return entry;\n  }\n\n  let currentCohort = {};\n\n  return {\n    [Symbol.iterator]: () => items.keys(),\n    /**\n     * Add an item to this collection.\n     * @param item\n     */\n    add(item) {\n      !items.has(item) && items.set(item, mkEntry(item));\n    },\n    /**\n     * Clear this collection.\n     */\n    clear() {\n      pendingPurge.length = 0;\n      reschedulePurge();\n      items.clear();\n      currentCohort = {};\n    },\n    /**\n     * @returns {[]} all the items in this collection, in insertion order.\n     */\n    toArray() {\n      return Array.from(items.keys());\n    },\n    /**\n     * Refresh the TTL for each item in this collection.\n     */\n    refresh() {\n      pendingPurge.length = 0;\n      reschedulePurge();\n      for (const entry of items.values()) {\n        entry.refresh();\n      }\n    },\n    /**\n     * Register a callback to be run when an item has expired and is about to be\n     * removed the from the collection.\n     * @param cb a callback that takes the expired item as argument\n     * @return an unregistration function.\n     */\n    onExpiry(cb) {\n      callbacks.push(cb);\n      return () => {\n        const idx = callbacks.indexOf(cb);\n        if (idx >= 0) {\n          callbacks.splice(idx, 1);\n        }\n      }\n    }\n  };\n}\n","import {isArrayOfNums, isInteger, isNumber, isPlainObject, isStr, logError, logWarn} from './utils.js';\nimport {config} from '../src/config.js';\nimport {hook} from './hook.js';\nimport {auctionManager} from './auctionManager.js';\n\nexport const OUTSTREAM = 'outstream';\nexport const INSTREAM = 'instream';\n\n/**\n * List of OpenRTB 2.x video object properties with simple validators.\n * Not included: `companionad`, `durfloors`, `ext`\n * reference: https://github.com/InteractiveAdvertisingBureau/openrtb2.x/blob/main/2.6.md\n */\nexport const ORTB_VIDEO_PARAMS = new Map([\n  [ 'mimes', value => Array.isArray(value) && value.length > 0 && value.every(v => typeof v === 'string') ],\n  [ 'minduration', isInteger ],\n  [ 'maxduration', isInteger ],\n  [ 'startdelay', isInteger ],\n  [ 'maxseq', isInteger ],\n  [ 'poddur', isInteger ],\n  [ 'protocols', isArrayOfNums ],\n  [ 'w', isInteger ],\n  [ 'h', isInteger ],\n  [ 'podid', isStr ],\n  [ 'podseq', isInteger ],\n  [ 'rqddurs', isArrayOfNums ],\n  [ 'placement', isInteger ], // deprecated, see plcmt\n  [ 'plcmt', isInteger ],\n  [ 'linearity', isInteger ],\n  [ 'skip', value => [1, 0].includes(value) ],\n  [ 'skipmin', isInteger ],\n  [ 'skipafter', isInteger ],\n  [ 'sequence', isInteger ], // deprecated\n  [ 'slotinpod', isInteger ],\n  [ 'mincpmpersec', isNumber ],\n  [ 'battr', isArrayOfNums ],\n  [ 'maxextended', isInteger ],\n  [ 'minbitrate', isInteger ],\n  [ 'maxbitrate', isInteger ],\n  [ 'boxingallowed', isInteger ],\n  [ 'playbackmethod', isArrayOfNums ],\n  [ 'playbackend', isInteger ],\n  [ 'delivery', isArrayOfNums ],\n  [ 'pos', isInteger ],\n  [ 'api', isArrayOfNums ],\n  [ 'companiontype', isArrayOfNums ],\n  [ 'poddedupe', isArrayOfNums ]\n]);\n\nexport function fillVideoDefaults(adUnit) {\n  const video = adUnit?.mediaTypes?.video;\n  if (video != null && video.plcmt == null) {\n    if (video.context === OUTSTREAM || [2, 3, 4].includes(video.placement)) {\n      video.plcmt = 4;\n    } else if (video.context !== OUTSTREAM && [2, 6].includes(video.playbackmethod)) {\n      video.plcmt = 2;\n    }\n  }\n}\n\n/**\n * validateOrtbVideoFields mutates the `adUnit.mediaTypes.video` object by removing invalid ortb properties (default).\n * The onInvalidParam callback can be used to handle invalid properties differently.\n * Other properties are ignored and kept as is.\n *\n * @param {Object} adUnit - The adUnit object.\n * @param {Function} onInvalidParam - The callback function to be called with key, value, and adUnit.\n * @returns {void}\n */\nexport function validateOrtbVideoFields(adUnit, onInvalidParam) {\n  const videoParams = adUnit?.mediaTypes?.video;\n\n  if (!isPlainObject(videoParams)) {\n    logWarn(`validateOrtbVideoFields: videoParams must be an object.`);\n    return;\n  }\n\n  if (videoParams != null) {\n    Object.entries(videoParams)\n      .forEach(([key, value]) => {\n        if (!ORTB_VIDEO_PARAMS.has(key)) {\n          return\n        }\n        const isValid = ORTB_VIDEO_PARAMS.get(key)(value);\n        if (!isValid) {\n          if (typeof onInvalidParam === 'function') {\n            onInvalidParam(key, value, adUnit);\n          } else {\n            delete videoParams[key];\n            logWarn(`Invalid prop in adUnit \"${adUnit.code}\": Invalid value for mediaTypes.video.${key} ORTB property. The property has been removed.`);\n          }\n        }\n      });\n  }\n}\n\n/**\n * @typedef {object} VideoBid\n * @property {string} adId id of the bid\n */\n\n/**\n * Validate that the assets required for video context are present on the bid\n * @param {VideoBid} bid Video bid to validate\n * @param {Object} [options] - Options object\n * @param {Object} [options.index=auctionManager.index] - Index object, defaulting to `auctionManager.index`\n * @return {Boolean} If object is valid\n */\nexport function isValidVideoBid(bid, {index = auctionManager.index} = {}) {\n  const videoMediaType = index.getMediaTypes(bid)?.video;\n  const context = videoMediaType && videoMediaType?.context;\n  const useCacheKey = videoMediaType && videoMediaType?.useCacheKey;\n  const adUnit = index.getAdUnit(bid);\n\n  // if context not defined assume default 'instream' for video bids\n  // instream bids require a vast url or vast xml content\n  return checkVideoBidSetup(bid, adUnit, videoMediaType, context, useCacheKey);\n}\n\nexport const checkVideoBidSetup = hook('sync', function(bid, adUnit, videoMediaType, context, useCacheKey) {\n  if (videoMediaType && (useCacheKey || context !== OUTSTREAM)) {\n    // xml-only video bids require a prebid cache url\n    if (!config.getConfig('cache.url') && bid.vastXml && !bid.vastUrl) {\n      logError(`\n        This bid contains only vastXml and will not work when a prebid cache url is not specified.\n        Try enabling prebid cache with $$PREBID_GLOBAL$$.setConfig({ cache: {url: \"...\"} });\n      `);\n      return false;\n    }\n\n    return !!(bid.vastUrl || bid.vastXml);\n  }\n\n  // outstream bids require a renderer on the bid or pub-defined on adunit\n  if (context === OUTSTREAM && !useCacheKey) {\n    return !!(bid.renderer || (adUnit && adUnit.renderer) || videoMediaType.renderer);\n  }\n\n  return true;\n}, 'checkVideoBidSetup');\n","/**\n * This module interacts with the server used to cache video ad content to be restored later.\n * At a high level, the expected workflow goes like this:\n *\n *   - Request video ads from Bidders\n *   - Generate IDs for each valid bid, and cache the key/value pair on the server.\n *   - Return these IDs so that publishers can use them to fetch the bids later.\n *\n * This trickery helps integrate with ad servers, which set character limits on request params.\n */\n\nimport {ajaxBuilder} from './ajax.js';\nimport {config} from './config.js';\nimport {auctionManager} from './auctionManager.js';\nimport {logError, logWarn} from './utils.js';\nimport {addBidToAuction} from './auction.js';\n\n/**\n * Might be useful to be configurable in the future\n * Depending on publisher needs\n */\nconst ttlBufferInSeconds = 15;\n\n/**\n * @typedef {object} CacheableUrlBid\n * @property {string} vastUrl A URL which loads some valid VAST XML.\n */\n\n/**\n * @typedef {object} CacheablePayloadBid\n * @property {string} vastXml Some VAST XML which loads an ad in a video player.\n */\n\n/**\n * A CacheableBid describes the types which the videoCache can store.\n *\n * @typedef {CacheableUrlBid|CacheablePayloadBid} CacheableBid\n */\n\n/**\n * Function which wraps a URI that serves VAST XML, so that it can be loaded.\n *\n * @param {string} uri The URI where the VAST content can be found.\n * @param {(string|string[])} impTrackerURLs An impression tracker URL for the delivery of the video ad\n * @return A VAST URL which loads XML from the given URI.\n */\nfunction wrapURI(uri, impTrackerURLs) {\n  impTrackerURLs = impTrackerURLs && (Array.isArray(impTrackerURLs) ? impTrackerURLs : [impTrackerURLs]);\n  // Technically, this is vulnerable to cross-script injection by sketchy vastUrl bids.\n  // We could make sure it's a valid URI... but since we're loading VAST XML from the\n  // URL they provide anyway, that's probably not a big deal.\n  let impressions = impTrackerURLs ? impTrackerURLs.map(trk => `<Impression><![CDATA[${trk}]]></Impression>`).join('') : '';\n  return `<VAST version=\"3.0\">\n    <Ad>\n      <Wrapper>\n        <AdSystem>prebid.org wrapper</AdSystem>\n        <VASTAdTagURI><![CDATA[${uri}]]></VASTAdTagURI>\n        ${impressions}\n        <Creatives></Creatives>\n      </Wrapper>\n    </Ad>\n  </VAST>`;\n}\n\n/**\n * Wraps a bid in the format expected by the prebid-server endpoints, or returns null if\n * the bid can't be converted cleanly.\n *\n * @param {CacheableBid} bid\n * @param {Object} [options] - Options object.\n * @param {Object} [options.index=auctionManager.index] - Index object, defaulting to `auctionManager.index`.\n * @return {Object|null} - The payload to be sent to the prebid-server endpoints, or null if the bid can't be converted cleanly.\n */\nfunction toStorageRequest(bid, {index = auctionManager.index} = {}) {\n  const vastValue = bid.vastXml ? bid.vastXml : wrapURI(bid.vastUrl, bid.vastImpUrl);\n  const auction = index.getAuction(bid);\n  const ttlWithBuffer = Number(bid.ttl) + ttlBufferInSeconds;\n  let payload = {\n    type: 'xml',\n    value: vastValue,\n    ttlseconds: ttlWithBuffer\n  };\n\n  if (config.getConfig('cache.vasttrack')) {\n    payload.bidder = bid.bidder;\n    payload.bidid = bid.requestId;\n    payload.aid = bid.auctionId;\n  }\n\n  if (auction != null) {\n    payload.timestamp = auction.getAuctionStart();\n  }\n\n  if (typeof bid.customCacheKey === 'string' && bid.customCacheKey !== '') {\n    payload.key = bid.customCacheKey;\n  }\n\n  return payload;\n}\n\n/**\n * A function which should be called with the results of the storage operation.\n *\n * @callback videoCacheStoreCallback\n *\n * @param {Error} [error] The error, if one occurred.\n * @param {?string[]} uuids An array of unique IDs. The array will have one element for each bid we were asked\n *   to store. It may include null elements if some of the bids were malformed, or an error occurred.\n *   Each non-null element in this array is a valid input into the retrieve function, which will fetch\n *   some VAST XML which can be used to render this bid's ad.\n */\n\n/**\n * A function which bridges the APIs between the videoCacheStoreCallback and our ajax function's API.\n *\n * @param {videoCacheStoreCallback} done A callback to the \"store\" function.\n * @return {Function} A callback which interprets the cache server's responses, and makes up the right\n *   arguments for our callback.\n */\nfunction shimStorageCallback(done) {\n  return {\n    success: function (responseBody) {\n      let ids;\n      try {\n        ids = JSON.parse(responseBody).responses\n      } catch (e) {\n        done(e, []);\n        return;\n      }\n\n      if (ids) {\n        done(null, ids);\n      } else {\n        done(new Error(\"The cache server didn't respond with a responses property.\"), []);\n      }\n    },\n    error: function (statusText, responseBody) {\n      done(new Error(`Error storing video ad in the cache: ${statusText}: ${JSON.stringify(responseBody)}`), []);\n    }\n  }\n}\n\n/**\n * If the given bid is for a Video ad, generate a unique ID and cache it somewhere server-side.\n *\n * @param {CacheableBid[]} bids A list of bid objects which should be cached.\n * @param {videoCacheStoreCallback} [done] An optional callback which should be executed after\n * the data has been stored in the cache.\n */\nexport function store(bids, done, getAjax = ajaxBuilder) {\n  const requestData = {\n    puts: bids.map(toStorageRequest)\n  };\n  const ajax = getAjax(config.getConfig('cache.timeout'));\n  ajax(config.getConfig('cache.url'), shimStorageCallback(done), JSON.stringify(requestData), {\n    contentType: 'text/plain',\n    withCredentials: true\n  });\n}\n\nexport function getCacheUrl(id) {\n  return `${config.getConfig('cache.url')}?uuid=${id}`;\n}\n\nexport const _internal = {\n  store\n}\n\nexport function storeBatch(batch) {\n  const bids = batch.map(entry => entry.bidResponse)\n  function err(msg) {\n    logError(`Failed to save to the video cache: ${msg}. Video bids will be discarded:`, bids)\n  }\n  _internal.store(bids, function (error, cacheIds) {\n    if (error) {\n      err(error)\n    } else if (batch.length !== cacheIds.length) {\n      logError(`expected ${batch.length} cache IDs, got ${cacheIds.length} instead`)\n    } else {\n      cacheIds.forEach((cacheId, i) => {\n        const {auctionInstance, bidResponse, afterBidAdded} = batch[i];\n        if (cacheId.uuid === '') {\n          logWarn(`Supplied video cache key was already in use by Prebid Cache; caching attempt was rejected. Video bid must be discarded.`);\n        } else {\n          bidResponse.videoCacheKey = cacheId.uuid;\n          if (!bidResponse.vastUrl) {\n            bidResponse.vastUrl = getCacheUrl(bidResponse.videoCacheKey);\n          }\n          addBidToAuction(auctionInstance, bidResponse);\n          afterBidAdded();\n        }\n      });\n    }\n  });\n};\n\nlet batchSize, batchTimeout;\nif (FEATURES.VIDEO) {\n  config.getConfig('cache', (cacheConfig) => {\n    batchSize = typeof cacheConfig.cache.batchSize === 'number' && cacheConfig.cache.batchSize > 0\n      ? cacheConfig.cache.batchSize\n      : 1;\n    batchTimeout = typeof cacheConfig.cache.batchTimeout === 'number' && cacheConfig.cache.batchTimeout > 0\n      ? cacheConfig.cache.batchTimeout\n      : 0;\n  });\n}\n\nexport const batchingCache = (timeout = setTimeout, cache = storeBatch) => {\n  let batches = [[]];\n  let debouncing = false;\n  const noTimeout = cb => cb();\n\n  return function (auctionInstance, bidResponse, afterBidAdded) {\n    const batchFunc = batchTimeout > 0 ? timeout : noTimeout;\n    if (batches[batches.length - 1].length >= batchSize) {\n      batches.push([]);\n    }\n\n    batches[batches.length - 1].push({auctionInstance, bidResponse, afterBidAdded});\n\n    if (!debouncing) {\n      debouncing = true;\n      batchFunc(() => {\n        batches.forEach(cache);\n        batches = [[]];\n        debouncing = false;\n      }, batchTimeout);\n    }\n  };\n};\n\nexport const batchAndStore = batchingCache();\n"],"names":["loadExternalScript","logError","logWarn","logMessage","find","getGlobal","MODULE_TYPE_PREBID","pbjsInstance","moduleCode","Renderer","options","url","config","id","callback","loaded","adUnitCode","renderNow","handlers","cmd","push","func","call","process","render","renderArgs","arguments","runRender","_render","apply","isRendererPreferredFromAdUnit","unshift","documentContext","bind","install","_ref","prototype","getConfig","setRender","fn","setEventHandlers","handleVideoEvent","_ref2","eventName","length","shift","error","isRendererRequired","renderer","executeRenderer","bid","doc","docContext","documentResolver","document","adUnits","adUnit","code","adUnitRenderer","hasValidAdUnitRenderer","mediaTypeRenderer","mediaTypes","video","hasValidMediaTypeRenderer","backupOnly","ACTIVITY_ACCESS_DEVICE","ACTIVITY_SYNC_USER","ACTIVITY_ENRICH_UFPD","ACTIVITY_ENRICH_EIDS","ACTIVITY_FETCH_BIDS","ACTIVITY_REPORT_ANALYTICS","ACTIVITY_TRANSMIT_EIDS","ACTIVITY_TRANSMIT_UFPD","ACTIVITY_TRANSMIT_PRECISE_GEO","ACTIVITY_TRANSMIT_TID","LOAD_EXTERNAL_SCRIPT","adapterManager","activityParamsBuilder","activityParams","alias","resolveAlias","MODULE_TYPE_BIDDER","MODULE_TYPE_UID","MODULE_TYPE_RTD","MODULE_TYPE_ANALYTICS","hook","ACTIVITY_PARAM_COMPONENT","ACTIVITY_PARAM_COMPONENT_TYPE","ACTIVITY_PARAM_COMPONENT_NAME","ACTIVITY_PARAM_ADAPTER_CODE","ACTIVITY_PARAM_STORAGE_TYPE","ACTIVITY_PARAM_S2S_NAME","ACTIVITY_PARAM_SYNC_TYPE","ACTIVITY_PARAM_SYNC_URL","ACTIVITY_PARAM_ANL_CONFIG","moduleType","moduleName","params","defaults","buildActivityParams","Object","assign","deepAccess","isActivityAllowed","registerActivityControl","scrubIPv4","scrubIPv6","ORTB_UFPD_PATHS","map","f","concat","ORTB_EIDS_PATHS","ORTB_GEO_PATHS","ORTB_IPV4_PATHS","ORTB_IPV6_PATHS","redactRule","ruleDef","get","run","root","path","object","property","applies","val","isData","repl","undefined","objectTransformer","rules","forEach","rule","paths","parts","split","tail","pop","join","applyTransform","session","obj","result","_len","args","Array","_key","sessionedApplies","name","head","parent","filter","el","_len2","_key2","hasOwnProperty","keys","appliesWhenActivityDenied","activity","isAllowed","bidRequestTransmitRules","ortb2TransmitRules","Math","round","Number","EPSILON","redactorFactory","redactOrtb2","redactBidRequest","redactor","ortb2","bidRequest","allow","reason","prefixLog","ruleRegistry","logger","registry","getRules","runRule","res","e","component","dupes","DEDUPE_INTERVAL","logResult","msg","deduping","clearTimeout","setTimeout","logInfo","ruleName","priority","pos","findIndex","itemPriority","entry","splice","idx","indexOf","lastPriority","foundAllow","ruleResult","createIframe","createInvisibleIframe","inIframe","insertElement","replaceMacros","events","AD_RENDER_FAILED_REASON","BID_STATUS","EVENTS","MESSAGES","PB_LOCATOR","VIDEO","auctionManager","getCreativeRenderer","fireNativeTrackers","GreedyPromise","useMetrics","filters","AD_RENDER_FAILED","AD_RENDER_SUCCEEDED","STALE_RENDER","BID_WON","EXPIRED_RENDER","EXCEPTION","getBidToRender","adId","forRender","override","resolve","then","findBidByAdId","catch","markWinningBid","emit","addWinningBid","emitAdRenderFail","message","data","emitAdRenderSucceeded","callAdRenderSucceededBidder","adapterCode","bidder","handleCreativeEvent","bidResponse","event","info","handleNativeMessage","_ref3","resizeFn","fireTrackers","action","width","height","HANDLERS","EVENT","NATIVE","creativeMessageHandler","deps","type","getRenderingData","ad","adUrl","cpm","originalCpm","AUCTION_PRICE","CLICKTHROUGH","clickUrl","doRender","_ref4","renderFn","isMainDocument","videoBid","mediaType","PREVENT_WRITING_ON_MAIN_DOCUMENT","before","next","bail","handleRender","_ref5","deferRendering","CANNOT_FIND_AD","status","RENDERED","suppressStaleRender","isBidNotExpired","suppressExpiredRender","markBidAsRendered","metrics","checkpoint","timeBetween","DEFERRED_RENDER","WeakMap","WINNERS","WeakSet","set","renderIfDeferred","markWinner","has","add","delete","renderAdDirect","fail","defaultView","frameElement","messageHandler","adData","write","close","sendMessage","mkFrame","stack","creativeComment","createComment","creativeId","MISSING_DOC_OR_ADID","clickThrough","insertLocatorFrame","window","frames","body","requestAnimationFrame","frame","appendChild","reset","ensureAdUnit","adunit","bidderCode","bidders","incrementAdUnitCount","counter","incrementRequestsCounter","incrementBidderRequestsCounter","incrementBidderWinsCounter","incrementAuctionsCounter","getRequestsCounter","requestsCounter","getBidderRequestsCounter","getBidderWinsCounter","winsCounter","getAuctionsCounter","auctionsCounter","Adapter","setBidderCode","getBidderCode","callBids","deepClone","flatten","generateUUID","getBidderCodes","getDefinedParams","getUniqueIdentifierStr","getUserConfiguredParams","groupBy","internal","isArray","isPlainObject","isValidMediaTypes","mergeDeep","shuffle","timestamp","uniques","decorateAdUnitsWithNativeParams","nativeAdapters","newBidder","ajaxBuilder","RANDOM","includes","getRefererInfo","GDPR_GVLIDS","gdprDataHandler","gppDataHandler","uspDataHandler","S2S","coppaDataHandler","PBS_ADAPTER_NAME","PARTITIONS","CLIENT","SERVER","dep","redact","_bidderRegistry","bidderRegistry","_aliasRegistry","aliasRegistry","_s2sConfigs","s2sConfig","_analyticsRegistry","s2sActivityParams","configName","getBids","auctionId","bidderRequestId","src","reduce","bids","s2sBid","ortb2Imp","transactionId","adUnitId","sizes","banner","playerSize","bidId","bid_id","auctionsCount","bidRequestsCount","bidderRequestsCount","bidderWinsCount","deferBilling","hookedGetBids","_filterBidsForAdUnit","getS2SBidders","getS2SBidderSet","serverBidders","filterBidsForAdUnit","getAdUnitCopyForPrebidServer","adUnitsCopy","hasModuleBids","s2sBids","b","module","getAdUnitCopyForClientAdapters","adUnitsClientCopy","setupAdUnitMediaTypes","labels","s2sConfigs","Set","s2s","enabled","flatMap","_partitionBidders","memo","partition","partitionBidders","makeBidRequests","auctionStart","cbTimeout","ortb2Fragments","auctionMetrics","BEFORE_REQUEST_BIDS","au","clientBidders","refererInfo","bidRequests","global","bidderOrtb2","addOrtb2","bidderRequest","fpd","freeze","source","tid","s2sParams","adUnitsS2SCopy","uniquePbsTid","fork","SRC","timeout","adUnitCopy","validBids","adUnitBid","request","reqBid","adapter","getConsentData","addBidResponse","doneCb","requestCallbacks","requestBidsTimeout","onTimelyResponse","clientBidderRequests","serverBidderRequests","partitions","uniqueServerBidRequests","serverBidRequest","index","i","s2sAjax","done","adaptersServerSide","s2sAdapter","uniqueServerRequests","s2sBidRequest","ad_units","doneCbs","start","timedOut","BID_REQUESTED","runWithBidder","ajax","adapterDone","callbackWithBidder","getSupportedMediaTypes","supportedMediaTypes","videoAdapters","registerBidAdapter","bidAdapter","register","getSpec","gvlid","aliasBidAdapter","existingAlias","nonS2SAlias","s2sBidders","newAdapter","constructor","useBaseGvlid","spec","skipPbsAliasing","visited","registerAnalyticsAdapter","enableAnalytics","adapterConfig","provider","getBidAdapter","getAnalyticsAdapter","getBidderMethod","method","invokeBidderMethod","tryCallBidderMethod","param","target","callTimedOutBidders","timedOutBidders","timedOutBidder","callBidWonBidder","triggerBilling","BILLED","burl","triggerPixel","callSetTargetingBidder","callBidViewableBidder","callBidderError","seen","callDataDeletionRequest","bidderRequests","getBidsRequested","br","entries","createBid","userSync","nativeBidIsValid","isValidVideoBid","STATUS","REJECTION_REASON","delayExecution","memoize","parseQueryStringParameters","parseSizesInput","pick","bidderSettings","COMMON_BID_RESPONSE_KEYS","TIDS","registerBidder","putBidder","aliases","aliasCode","guardTids","prop","receiver","Reflect","privateAccessProxy","handler","proxy","Proxy","_","v","arg","registerSyncs","configEnabledCallback","tidGuard","adUnitCodesHandled","addBidWithCode","measureTime","isValid","reject","INVALID","responses","afterAllResponses","BIDDER_DONE","gdprConsent","uspConsent","gppConsent","validBidRequests","adapterMetrics","filterAndWarn","bidRequestMap","placementCode","processBidderRequests","onRequest","requestObject","BEFORE_BIDDER_HTTP","onResponse","resp","onPaapi","paapiConfig","addPaapiConfig","onError","errorMessage","BIDDER_ERROR","onBid","requestId","isInvalidAlternateBidder","BIDDER_DISALLOWED","originalCurrency","currency","meta","onBidBillable","prebidBid","GOOD","INVALID_REQUEST_ID","onCompletion","responseBidder","requestBidder","allowAlternateBidderCodes","alternateBiddersList","trim","toLowerCase","registerSyncInner","isBidRequestValid","JSON","stringify","RESPONSE_PROPS","wrapCallback","startTiming","stopBefore","requests","buildRequests","requestDone","requestMetrics","addBid","renameWith","onSuccess","response","responseObj","networkDone","parse","headers","headerParser","interpretResponse","err","paapiConfigs","some","key","paapi","xmlHttpResponse","getResponseHeader","onFailure","getOptions","ro","browsingTopics","formatGetParameters","success","withCredentials","contentType","aliasSyncEnabled","getUserSyncs","filterConfig","syncs","iframeEnabled","iframe","all","pixelEnabled","image","sync","registerSync","bidderDone","validBidSize","parseInt","getBidRequest","getMediaTypes","parsedSizes","hasValidKeys","bidKeys","every","n","setScriptAttributes","_requestCache","_approvedLoadExternalJSList","attributes","storedCachedObject","getCacheObject","callbacks","tag","cachedDocObj","cacheObject","requestResource","tagSrc","jptScript","createElement","async","readyState","onreadystatechange","onload","buildUrl","parseUrl","fetch","makeRequest","r","o","Request","resource","ctl","AbortController","cancelTimer","abort","signal","GET","POST","CTYPE","toFetchRequest","urlInfo","search","Headers","customHeaders","rqOpts","credentials","isSecureContext","opt","keepalive","fetcherFactory","fetcher","to","pm","finally","origin","URL","location","req","toXHR","responseText","statusText","xml","getXML","DOMParser","parseFromString","XMLHttpRequest","DONE","responseType","responseURL","responseXML","header","toJSON","attachCallbacks","fetchPm","x","text","xhr","ok","sendBeacon","navigator","isEmpty","isEmptyStr","isFn","getPriceBucketString","getNativeTargeting","isNativeResponse","setNativeResponseProperties","batchAndStore","OUTSTREAM","GRANULARITY_OPTIONS","JSON_MAPPING","TARGETING_KEYS","defer","adjustCpm","ttlCollection","getMinBidCacheTTL","onMinBidCacheTTLChange","syncUsers","AUCTION_STARTED","AUCTION_IN_PROGRESS","AUCTION_COMPLETED","on","BID_ADJUSTMENT","adjustBids","MAX_REQUESTS_PER_ORIGIN","outstandingRequests","sourceInfo","queuedCalls","resetAuctionState","ob","k","newAuction","adUnitCodes","_adUnits","_labels","_adUnitCodes","_auctionId","_timeout","_timelyRequests","requestsDone","_bidsRejected","_callback","_bidderRequests","_bidsReceived","startTime","responseTimestamp","ttl","max","_noBids","_winningBids","_auctionStart","_auctionEnd","_timeoutTimer","_auctionStatus","_nonBids","refresh","addBidRequests","addBidReceived","addBidRejected","bidsRejected","addNoBid","noBid","addNonBids","seatnonbids","getProperties","auctionEnd","auctionStatus","noBids","bidsReceived","toArray","winningBids","seatNonBids","startAuctionTimer","executeCallback","AUCTION_TIMEOUT","timedOutRequests","rq","BID_TIMEOUT","Date","now","AUCTION_END","bidsBackCallback","groupByPlacement","userSyncConfig","enableOverride","syncDelay","auctionDone","resetBidder","addBidderRequests","dispatch","addBidderRequestsCallback","context","AUCTION_INIT","auctionCallbacks","increment","SRA","runIfOriginHasCapacity","hasCapacity","maxRequests","min","winningBid","setBidTargeting","SEAT_NON_BID","seatnonbid","getWinningBids","getAuctionStart","getAuctionEnd","getTimeout","getAuctionId","getAuctionStatus","getAdUnits","getAdUnitCodes","getBidRequests","getBidsReceived","getNoBids","getNonBids","getFPD","getMetrics","end","promise","isValidPrice","PRICE_TOO_HIGH","responsesReady","ready","auctionInstance","outstandingBidsAdded","allAdapterCalledDone","bidderRequestsDone","bidResponseMap","afterBidAdded","handleBidResponse","addCommonResponseProperties","acceptBidResponse","getPreparedBidForAuction","BID_ACCEPTED","tryAddVideoBid","getAdUnit","addBidToAuction","rejectBidResponse","rejectionReason","BID_REJECTED","auctionOptionsConfig","secondaryBidders","NO_BID","rejected","setupBidTargeting","timeSince","BID_RESPONSE","videoMediaType","originalRequestId","useCacheKey","videoCacheKey","callPrebidCache","vastUrl","getBidderRequest","requestTimestamp","parseFloat","ttlBuffer","timeToRespond","bidRenderer","bidObjectMediaType","bidMediaType","mediaTypeGranularity","getMediaTypeGranularity","priceStringsObj","pbLg","low","pbMg","med","pbHg","high","pbAg","auto","pbDg","dense","pbCg","custom","bidObject","keyValues","cpmCheck","dealId","getKeyValueTargetingPairs","adserverTargeting","mediaTypePriceGranularity","getPriceGranularity","granularity","getPriceByGranularity","bidGranularity","AUTO","DENSE","LOW","MEDIUM","HIGH","CUSTOM","getCreativeId","getAdvertiserDomain","advertiserDomains","flat","getDSP","networkId","networkName","getPrimaryCatId","primaryCatId","createKeyVal","value","bidReq","defaultAdserverTargeting","BIDDER","AD_ID","PRICE_BUCKET","SIZE","DEAL","SOURCE","FORMAT","ADOMAIN","ACAT","DSP","CRID","getStandardBidderSettings","standardSettings","settingsFor","ADSERVER_TARGETING","slice","UUID","CACHE_ID","targetingKeyVal","kvPair","CACHE_HOST","hostname","custBidObj","setKeys","getOwn","ownSettingsFor","sendStandardTargeting","targeting","size","getSize","suppressEmptyKeys","bidPriceAdjusted","bidsByPlacement","maxBidValue","AuctionIndex","getAuctions","getAuction","auction","a","bers","ber","getOrtb2","newAuctionManager","_auctions","onExpiry","getAllWinningBids","pre","post","mgrMethod","mapper","items","allBidsReceived","getAllBidsForAdUnitCode","createAuction","opts","_addAuction","getStandardBidderAdServerTargeting","setStatusForBids","BID_TARGETING_SET","getLastAuctionId","auctions","clearAllAuctions","clear","isArrayOfNums","isInteger","isStr","ORTB_BANNER_PARAMS","Map","CACHE_TTL_SETTING","TTL_BUFFER","minCacheTTL","listeners","cfg","getBufferedTTL","prev","l","listener","ScopedSettings","getSettings","defaultScope","scope","resolveScope","getScopes","#resolveScope","BD_SETTING_STANDARD","Bid","statusCode","_bidSrc","_statusCode","statusMessage","_getStatus","getStatusCode","getIdentifiers","identifiers","isValidPriceConfig","arrayFrom","from","getParameterByName","isBoolean","DEBUG_MODE","DEFAULT_DEBUG","toUpperCase","DEFAULT_BIDDER_TIMEOUT","DEFAULT_ENABLE_SEND_ALL_BIDS","DEFAULT_DISABLE_AJAX_TIMEOUT","DEFAULT_BID_CACHE","DEFAULT_DEVICE_ACCESS","DEFAULT_MAX_NESTED_IFRAMES","DEFAULT_MAXBID_VALUE","DEFAULT_IFRAMES_CONFIG","FIXED","VALID_ORDERS","DEFAULT_BIDDER_SEQUENCE","ALL_TOPICS","attachProperties","useDefaultValues","values","priceGranularity","customPriceBucket","bidderSequence","auctionOptions","getProp","setProp","defineProperty","enumerable","props","publisherDomain","validatePriceGranularity","hasGranularity","aggregate","item","validateauctionOptions","defineProperties","fromEntries","def","configurable","option","newConfig","bidderConfig","currBidder","resetConfig","debug","bidderTimeout","enableSendAllBids","useBidCache","deviceAccess","disableAjaxTimeout","maxNestedIframes","maxBid","topics","callSubscribers","topic","_getConfig","currBidderConfig","configTopicSet","_getRestrictedConfig","conf","Error","getAnyConfig","accessor","subscribe","readConfig","readAnyConfig","wrapee","getBidderConfig","setConfig","topicalConfig","setDefaults","nl","init","unsubscribe","TOPICS","setBidderConfig","mergeFlag","check","currentConfig","mergeConfig","mergedConfig","mergeBidderConfig","cb","getCurrentBidder","cyrb53Hash","VENDORLESS_GVLID","ConsentHandler","dirty","hash","generatedTime","hashFields","#resolve","enable","setConsentData","time","UspConsentHandler","getConsentMeta","consentData","generatedAt","GdprConsentHandler","vendorData","gdprApplies","consentStringSize","tcString","apiVersion","GppConsentHandler","gvlidRegistry","none","modules","getCoppa","ALL_HANDLERS","gdpr","usp","gpp","coppa","multiHandler","collector","allConsent","PL_CODE","PL_SIZE","PL_BIDS","BD_BIDDER","BD_ID","BD_PL_ID","SET_TARGETING","REQUEST_BIDS","ADD_AD_UNITS","TCF2_ENFORCEMENT","AUCTION_DEBUG","BID_VIEWABLE","BILLABLE_EVENT","RUN_PAAPI_AUCTION","PBS_ANALYTICS","PAAPI_BID","PAAPI_NO_BID","PAAPI_ERROR","NO_AD","EVENT_ID_PATHS","bidWon","DEFAULT_TARGETING_KEYS","NATIVE_KEYS","title","body2","privacyLink","privacyIcon","sponsoredBy","icon","displayUrl","cta","rating","address","downloads","likes","phone","price","salePrice","rendererUrl","adTemplate","DEFAULT_ENDPOINT","SYNCED_BIDDERS_KEY","FLOOR_NOT_MET","CANNOT_CONVERT_CURRENCY","DSA_REQUIRED","DSA_MISMATCH","PREBID_NATIVE_DATA_KEYS_TO_ORTB","NATIVE_ASSET_TYPES","sponsored","desc","saleprice","desc2","displayurl","ctatext","NATIVE_IMAGE_TYPES","ICON","MAIN","NATIVE_KEYS_THAT_ARE_NOT_ASSETS","REQUEST","RESPONSE","_defaultPrecision","_lgPriceConfig","_mgPriceConfig","_hgPriceConfig","_densePriceConfig","_autoPriceConfig","customConfig","granularityMultiplier","cpmFloat","isNaN","getCpmStringValue","cpmStr","cap","buckets","curr","bucketFloor","bucket","precision","toFixed","getCpmTarget","bucketMin","roundingFunction","floor","customRoundingFunction","pow","cpmToRound","cpmTarget","invalidRounding","RENDERER","getCreativeRendererSource","renderers","srcdoc","contentWindow","getHook","DEBUG_KEY","isDebuggingInstalled","installedModules","loadScript","debuggingModuleLoader","alreadyInstalled","script","loading","_installDebugging","debuggingControls","load","waitForDebugging","disable","getHooks","remove","loadSession","storage","sessionStorage","debugging","getItem","utils","TTL_CONFIG","eventTTL","eventsFired","monotonic","previous","allEvents","idPaths","_public","_handlers","_dispatch","eventString","eventPayload","idPath","que","eventKeys","eventType","elapsedTime","getPerformanceNow","_checkAvailableEvent","off","_handler","addEvents","getEvents","_setEventEmitter","clearEvents","parseDomain","findRootDomain","deepSetValue","getDNT","getWindowSelf","getWindowTop","getHighEntropySUA","getLowEntropySUA","CLIENT_SECTIONS","clientSectionChecker","hasSection","oneClient","enrichFPD","promArr","getSUA","tryToGetCdepLabel","sua","cdep","ri","ENRICHMENTS","section","getEnrichments","device","ext","clientEnrichment","winFallback","hints","removeUndef","cookieDeprecationLabel","getValue","site","p","page","ref","win","w","screen","h","vpw","innerWidth","documentElement","clientWidth","vph","innerHeight","clientHeight","dnt","ua","userAgent","language","webdriver","regs","globalPrivacyControl","domain","noLeadingWww","keywords","querySelector","content","replace","publisher","logPrefix","onlyOneClientSection","found","getCoreStorageManager","coreStorage","fullDomain","host","cookiesAreEnabled","domainParts","rootDomain","continueSearching","startIndex","TEST_COOKIE_NAME","TEST_COOKIE_VALUE","expirationDate","toUTCString","setCookie","getCookie","abs","SUA_SOURCE_UNKNOWN","SUA_SOURCE_LOW_ENTROPY","SUA_SOURCE_HIGH_ENTROPY","SUA_SOURCE_UA_HEADER","HIGH_ENTROPY_HINTS","LOW_ENTROPY_HINTS","lowEntropySUAAccessor","highEntropySUAAccessor","uaData","userAgentData","uaDataToSUA","cache","sorted","sort","getHighEntropyValues","toBrandVersion","brand","version","bv","platform","platformVersion","fullVersionList","brands","browsers","mobile","funHooks","SYNC","ASYNC","QUEUE","readyCtl","setupBeforeHookFnOnce","baseFn","hookFn","submoduleInstallMap","postInstallAllowed","submodules","submodule","wrapHook","wrapper","m","BANNER","ADPOD","insertHtmlIntoIframe","isNumber","NATIVE_TARGETING_KEYS","IMAGE","ortb","ver","assets","required","img","wmin","hmin","len","SUPPORTED_TYPES","PREBID_NATIVE_DATA_KEYS_TO_ORTB_INVERSE","inverse","NATIVE_ASSET_TYPES_INVERSE","TRACKER_METHODS","js","TRACKER_EVENTS","impression","native","processNativeAdUnitParams","typeIsSupported","isOpenRTBBidRequestValid","nativeParams","nativeOrtbRequest","toOrtbNativeRequest","ids","asset","eventtrackers","isOpenRTBAssetValid","mimes","protocols","minduration","maxduration","nativeAdUnit","nativeBidder","hasNonNativeBidder","ortbRequest","ortbResponse","toOrtbNativeResponse","isNativeOpenRTBBidValid","bidORTB","bidRequestORTB","link","requiredAssetIds","returnedAssetIds","match","assetId","nativeResponse","legacyPropertiesToOrtbNative","fireClickTrackers","fireImpressionTrackers","runMarkup","mkup","fetchURL","impTrackers","tracker","tally","imptrackers","jstracker","clicktrackers","assetIdLinkMap","masterClickTrackers","assetLink","clickTrackers","nativeOrtbResponse","legacyResponse","toLegacyResponse","getAssetValue","globalSendTargetingKeys","sendTargetingKeys","nativeKeys","getNativeKeys","flatBidNativeKeys","sendPlaceholder","sendId","placeholder","assetSendTargetingKeys","sendTargeting","getNativeAssets","nativeProps","getNativeRenderingData","assetsMessage","adObject","renderData","NATIVE_KEYS_INVERTED","getAssetMessage","getAllAssetsMessage","extraNativeKeys","extKey","legacyNativeAssets","privacy","ortbAsset","aspect_ratios","min_width","minWidth","min_height","minHeight","aspectRatios","ar","ratio_width","ratio_height","ratio","aspectratios","gcd","fromOrtbNativeRequest","openRTBRequest","oldNativeObject","Boolean","scale","assetType","prebidAssetName","convertOrtbRequestToProprietaryNative","bidRequestsCopy","legacyNative","useRequestAsset","predicate","titleAsset","imageType","imageAsset","dataAsset","requestAssets","requestAsset","reqAsset","impressionTrackers","jsTrackers","eventTracker","javascriptTrackers","retobj","PROCESSOR_TYPES","PROCESSOR_DIALECTS","IMP","DEFAULT","PBS","types","processorRegistry","processors","registerOrtbProcessor","dialects","dialect","getProcessors","elem","arr","pred","thisArg","isGptPubadsDefined","transformAdServerTargetingObj","unsupportedBidderMessage","listenMessagesFromCreative","isBidUsable","storageCallbacks","default","newMetrics","getHighestCpm","ORTB_VIDEO_PARAMS","fillVideoDefaults","validateOrtbVideoFields","triggerUserSyncs","eventValidators","checkDefinedPlacement","libLoaded","bidSet","validateSizes","targLength","cleanSizes","sz","syncOrtb2","fields","validator","mediaTypesFieldValue","ortbFieldValue","validateBannerMediaType","validatedAdUnit","bannerSizes","validateVideoMediaType","tarPlayerSizeLen","videoSizes","validateNativeMediaType","checkDeprecated","onDeprecated","legacyNativeKeys","intersection","nativeKey","legacyKey","validateAdUnitPos","isFinite","warning","validateAdUnit","adUnitSetupChecks","checkAdUnitSetup","validatedAdUnits","validatedBanner","validatedVideo","validatedNative","fillAdUnitDefaults","getAdserverTargetingForAdUnitCodeStr","adunitCode","getAdserverTargetingForAdUnitCode","getHighestUnusedBidResponseForAdUnitCode","getAdserverTargeting","getAllTargeting","getConsentMetadata","currentAuctionId","getNoBidsForAdUnitCode","getBidResponses","getBidResponsesForAdUnitCode","setTargetingForGPTAsync","customSlotMatching","setTargetingForGPT","setTargetingForAst","isApntagDefined","renderAd","removeAdUnit","requestBids","delegate","bidsBackHandler","unit","startAuction","promiseFactory","Promise","tids","adUnitMediaTypes","allBidders","bidderMediaTypes","bidderEligible","adUnitsLen","setLatestAuctionForAdUnit","executeCallbacks","reqBidsConfigObj","runAll","enableAnalyticsCallbacks","queue","queued","addAdUnits","adUnitArr","onEvent","offEvent","bidderAdaptor","enableAnalyticsCb","aliasBidder","getAllPrebidWinningBids","getHighestCpmBids","markWinningBidAsUsed","analytics","quePush","command","processQueue","called","true","pbjs","_pbjsGlobals","registerModule","ensureProtocol","exec","windowProto","protocol","top","noPort","startsWith","substring","getCanonicalUrl","element","href","detectReferer","getAncestorOrigins","ancestorOrigins","ancestors","currentWindow","bestLocation","bestCanonicalUrl","reachedTop","level","valuesFromAmp","inAmpFrame","hasTopLocation","previousWindow","wasInAmpFrame","currentLocation","crossOrigin","foundLocation","sourceUrl","canonicalUrl","referrer","reverse","isAmp","numIframes","topmostLocation","legacy","referer","cacheWithLocation","canonical","newCanonical","newHref","isApnGetTagDefined","HANDLER_MAP","handleRenderRequest","handleEventRequest","handleNativeRequest","addEventListener","ev","receiveMessage","getReplier","ports","postMessage","ensureAdId","reply","getResizer","resizeRemoteCreative","getDimension","elmType","getElementByAdUnit","elementStyle","style","getElementIdBasedOnAdServer","parentDivEle","getElementById","getDfpElementId","getAstElementId","slot","googletag","pubads","getSlots","getTargetingKeys","getTargeting","getSlotElementId","astTag","apntag","getTag","targetId","checkCookieSupport","hasDeviceAccess","STORAGE_TYPE_LOCALSTORAGE","STORAGE_TYPE_COOKIES","newStorageManager","storageType","mod","curBidder","valid","schedule","operation","expires","sameSite","domainPortion","encodeURIComponent","expiresPortion","isNone","secure","cookie","decodeURIComponent","storageMethods","capName","charAt","backend","hasStorage","setItem","removeItem","findSimilarCookies","keyLike","cookies","separatorIndex","cookieName","getStorageManager","deviceAccessRule","storageAllowedRule","bs","resetData","isAdUnitCodeMatchingSlot","sortByHighestCpm","getOldestHighestCpmBid","pbTargetingKeys","MAX_DFP_KEYLENGTH","CFG_ALLOW_TARGETING_KEYS","CFG_ADD_TARGETING_KEYS","TARGETING_KEY_CONFIGURATION_ERROR_MSG","TARGETING_KEYS_ARR","isUnusedBid","isActualBid","getHighestCpmBidsFromBidPool","winReducer","adUnitBidLimit","hasModified","winSorter","dealPrioritization","bucketKey","bucketBids","bidsByBidder","sortByDealAndPriceBucketOrCpm","useCpm","hb_deal","hb_pb","getGPTSlotsForAdUnits","auToSlots","customMatch","clearTargeting","newTargeting","latestAuctionForAdUnit","resetPresetTargeting","slots","resetPresetTargetingAST","currentKeywords","newKeywords","modifyTag","addBidToTargeting","deals","standardKeys","allowSendAllBidsTargetingKeys","allowedSendAllBidTargeting","targetingValue","getTargetingMap","getBidderTargeting","alwaysIncludeDeals","getAllowedTargetingKeyValues","allowedKeys","defaultKeyring","defaultKeys","keyDispositions","keyring","isCustom","defaultKey","allowedKey","allowedKeyName","removedKeys","d","filteredTargeting","bidLimit","sendAllBids","bidLimitConfigValue","customKeysByUnit","filteredBids","getfilteredBidsAndCustomKeys","bidsSorted","getTargetingLevels","addedKeys","flattenTargeting","auctionKeysThreshold","filterTargetingKeys","updatePBTargetingKeys","targetKey","targetKeys","getWinningBidTargeting","getCustomBidTargeting","getAdUnitTargeting","adUnitIsEligible","cpmAllowed","isPreferredDeal","getCustomKeys","truncKey","convertKeysToQueryForm","keyMap","queryString","encodedKeyPair","targetingCopy","targetingMap","accMap","currMap","adUnitQueryString","querySize","targetingObj","c","accumulator","targetingSet","resetMap","updateTargetingFromMap","targetingKey","targetingDone","bidCacheEnabled","filterFunction","isBidFromLastAuction","filterFunctionResult","cacheFilter","bidFilter","latestTargetedAuctionId","usedCodes","cpmEligible","eligible","astTargeting","keywordsObj","regex","setKeywords","overrideKeyValue","usedAdUnitCodes","winners","getStandardKeys","winner","acc","bidderCodeTargetingKey","bidderCodeTargeting","newBid","customKeysForUnit","getTargetingObj","getTargetingValues","aut","s","targetingValues","insertUserSyncIframe","isSafariBrowser","USERSYNC_DEFAULT_CONFIG","syncEnabled","filterSettings","syncsPerBidder","auctionDelay","newUserSync","publicApi","getDefaultQueue","hasFiredBidder","numAdapterBids","permittedPixels","usConfig","fs","regRule","syncType","canBidderRegisterSync","fireSyncs","browserSupportsCookies","loadIframes","fireImagePixels","forEachFire","bidderName","trackingPixelUrl","iframeUrl","removeImagePixelsForBidder","iframeSyncBidderName","imageSync","imageSyncBidderName","incrementAdapterBids","shouldBidderBeBlocked","isFilterConfigValid","activeConfig","biddersToFilter","filterType","checkForFiltering","include","exclude","activeConfigName","filterField","biddersField","bidderInList","klona","dset","tStr","tFn","tNumb","tObject","tBoolean","toString","consoleExists","console","consoleLogExists","log","consoleInfoExists","consoleWarnExists","warn","consoleErrorExists","eventEmitter","emitFn","emitEvent","createTrackPixelIframeHtml","canAccessWindowTop","getWindowLocation","parseQS","formatQS","deepEqual","prebidInternal","getPrebidInternal","getIncrementalInteger","count","random","substr","_getRandomData","crypto","getRandomValues","Uint8Array","getBidIdParameter","paramsObj","queryObj","getOwnPropertyNames","sizesToSizeTuples","isValidGPTSingleSize","sizeObj","sizeTupleToSizeString","parseGPTSingleSizeArray","singleSize","sizeTupleToRtbSize","parseGPTSingleSizeArrayToRtbSize","self","debugTurnedOn","decorateLog","prefix","decorate","label","color","hasConsoleLogger","DEFAULTS","border","hspace","vspace","marginWidth","marginHeight","scrolling","frameBorder","allowtransparency","attrs","display","isA","_t","str","_each","contains","_map","elm","asLastChildChild","parentEl","getElementsByTagName","insertBeforeEl","firstChild","insertBefore","waitForElementToLoad","timer","onLoad","removeEventListener","Image","htmlCode","open","iframeHtml","div","innerHTML","createTrackPixelHtml","encode","encodeURI","escapedUrl","encodeMacroURI","macros","matchAll","macro","encodeUri","sandbox","arry","array","temp","isSafeFrameWindow","ws","$sf","getSafeframeGeometry","geom","test","subs","RegExp","replaceAuctionPrice","replaceClickThrough","clicktag","getTime","performance","getDomLoadingDuration","domLoadingDuration","timing","navigationStart","domLoading","cookieEnabled","numRequiredCalls","numCalls","xs","rv","SUPPORTED_MEDIA_TYPES","SUPPORTED_STREAM_TYPES","bidderData","doNotTrack","msDoNotTrack","compareCodeAndSlot","getAdUnitPath","cleanObj","properties","newObj","newProp","query","criteria","parsed","noDecodeWholeURL","qsAsString","decodeSearchAsString","port","pathname","obj1","obj2","checkTypes","props1","sources","addItFlag","seed","imul","opA","opB","h1","h2","ch","charCodeAt","safeJSONParse","safeJSONEncode","memoized","cacheKey","getUnixTimestampFromNow","timeValue","timeUnit","acceptableUnits","multiplication","convertObjectToArray","_ref6","setAttribute","binarySearch","left","right","middle","hasNonSerializableProperty","checkedObjects","setOnAny","collection","extractDomainFromHost","pageHost","domains","triggerNurlWithCpm","nurl","adjustAlternateBids","bidCpmAdjustment","outOfFocusStart","timeOutOfFocus","suspendedTimeouts","trackTimeOutOfFocus","hidden","setTimerId","setFocusTimeout","milliseconds","timerId","newId","ip","ones","ipParts","mask","maskedIP","part","CONFIG_TOGGLE","NODES","metricsFactory","mkNode","makeNode","mkTimer","makeTimer","mkRenamer","rename","nodes","makeMetrics","dfWalk","visit","edge","node","getTimestamp","setMetric","names","follow","inEdge","outEdge","propagate","stopPropagation","groups","timestamps","metric","ts","elapsed","startCheckpoint","endCheckpoint","stopAfter","measureHookTime","stopTiming","orig","untimed","includeGroups","otherMetrics","other","addParent","renameFn","newSibling","wrapFn","after","parents","nullMetrics","nop","empty","nullTimer","nullNode","hookTimer","that","timedAuctionHook","timedBidResponseHook","SUCCESS","FAIL","delayMs","resolver","continuation","resolveFn","onFinally","collect","#collect","promises","cnt","clt","race","allSettled","invoker","rejectFn","simpleCompare","keyCompare","reverseCompare","compare","tiebreakCompare","compares","cmp","minimum","maximum","cpmCompare","timestampCompare","getLatestHighestCpmBid","slack","pendingPurge","markForPurge","expiry","nextPurge","task","reschedulePurge","mkEntry","thisCohort","currentCohort","update","delta","field","getter","currentCall","thisCall","Symbol","iterator","INSTREAM","plcmt","placement","playbackmethod","onInvalidParam","videoParams","checkVideoBidSetup","vastXml","ttlBufferInSeconds","wrapURI","uri","impTrackerURLs","impressions","trk","toStorageRequest","vastValue","vastImpUrl","ttlWithBuffer","payload","ttlseconds","bidid","aid","customCacheKey","shimStorageCallback","responseBody","store","getAjax","requestData","puts","getCacheUrl","_internal","storeBatch","batch","cacheIds","cacheId","uuid","batchSize","batchTimeout","cacheConfig","batchingCache","batches","debouncing","noTimeout","batchFunc"],"sourceRoot":""}